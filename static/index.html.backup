<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure CloudOps Intelligence Agent | AI-Powered FinOps & InfraOps</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0078d4 0%, #00bcf2 50%, #00d4ff 100%);
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* Main Layout */
        .app-container {
            display: flex;
            width: 100%;
            height: 100vh;
            gap: 0;
        }

        /* Left Sidebar - Marketing & Features */
        .sidebar-left {
            width: 300px;
            background: linear-gradient(180deg, #1e3a8a 0%, #1e40af 50%, #2563eb 100%);
            color: white;
            padding: 30px 25px;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.2);
        }

        .sidebar-left::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar-left::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
        }

        .sidebar-left::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
        }

        .logo-section {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .logo-section h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .logo-section .tagline {
            font-size: 12px;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .value-section {
            margin-bottom: 25px;
        }

        .value-section h3 {
            font-size: 16px;
            margin-bottom: 12px;
            font-weight: 600;
            color: #60a5fa;
        }

        .value-section p {
            font-size: 13px;
            line-height: 1.6;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .feature-list {
            list-style: none;
            margin-top: 10px;
        }

        .feature-list li {
            padding: 8px 0;
            font-size: 13px;
            display: flex;
            align-items: flex-start;
            opacity: 0.9;
        }

        .feature-list li:before {
            content: "‚úì";
            color: #60a5fa;
            font-weight: bold;
            margin-right: 10px;
        }

        .persona-badge {
            display: inline-block;
            background: rgba(96, 165, 250, 0.2);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            margin: 3px;
            border: 1px solid rgba(96, 165, 250, 0.4);
        }

        /* Center Chat Area */
        .chat-section {
            flex: 1;
            background: white;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #0078d4 0%, #00a0e3 50%, #00d4ff 100%);
            color: white;
            padding: 25px 30px;
            box-shadow: 0 4px 20px rgba(0, 120, 212, 0.3);
        }

        .header h1 {
            font-size: 26px;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header p {
            font-size: 13px;
            opacity: 0.95;
            line-height: 1.5;
            font-weight: 500;
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
            background: #f8f9fa;
        }

        .chat-container::-webkit-scrollbar {
            width: 8px;
        }

        .chat-container::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        .welcome-message {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .welcome-message h2 {
            color: #0078d4;
            margin-bottom: 15px;
            font-size: 28px;
        }

        .welcome-message p {
            margin-bottom: 30px;
            font-size: 16px;
        }

        .message {
            margin-bottom: 20px;
            display: flex;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 75%;
            padding: 15px 20px;
            border-radius: 18px;
            line-height: 1.6;
            word-wrap: break-word;
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #0078d4 0%, #00bcf2 100%);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.assistant .message-content {
            background: white;
            color: #333;
            border: 1px solid #e0e0e0;
            border-bottom-left-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* Table wrapper for horizontal scrolling */
        .message.assistant .message-content .table-wrapper {
            overflow-x: auto;
            overflow-y: visible;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .message.assistant .message-content table {
            border-collapse: collapse;
            width: 100%;
            margin: 0;
            font-size: 13px;
            min-width: 600px; /* Minimum width to maintain readability */
        }

        .message.assistant .message-content th,
        .message.assistant .message-content td {
            border: 1px solid #ddd;
            padding: 10px 12px;
            text-align: left;
            word-wrap: break-word;
            word-break: break-word;
            max-width: 250px; /* Limit column width */
            overflow-wrap: break-word;
        }

        .message.assistant .message-content th {
            background-color: #0078d4;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
            white-space: nowrap;
        }

        /* Responsive columns - specific column widths */
        .message.assistant .message-content td:first-child,
        .message.assistant .message-content th:first-child {
            min-width: 150px;
            max-width: 200px;
        }

        /* Tags column - allow wrapping */
        .message.assistant .message-content td:last-child,
        .message.assistant .message-content th:last-child {
            min-width: 180px;
            max-width: 300px;
            white-space: normal;
        }

        /* Cost column - keep narrow */
        .message.assistant .message-content td:nth-child(5),
        .message.assistant .message-content th:nth-child(5) {
            min-width: 80px;
            max-width: 100px;
            text-align: right;
        }

        /* Alternating row colors for better readability */
        .message.assistant .message-content tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .message.assistant .message-content tr:hover {
            background-color: #e7f3ff;
        }

        /* Scrollbar styling for table wrapper */
        .message.assistant .message-content .table-wrapper::-webkit-scrollbar {
            height: 8px;
        }

        .message.assistant .message-content .table-wrapper::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .message.assistant .message-content .table-wrapper::-webkit-scrollbar-thumb {
            background: #0078d4;
            border-radius: 4px;
        }

        .message.assistant .message-content .table-wrapper::-webkit-scrollbar-thumb:hover {
            background: #005a9e;
        }

        .message.assistant .message-content tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .input-container {
            padding: 20px 30px;
            background: white;
            border-top: 1px solid #e0e0e0;
        }

        .input-wrapper {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        #userInput {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 15px;
            outline: none;
            transition: all 0.3s ease;
        }

        #userInput:focus {
            border-color: #0078d4;
            box-shadow: 0 0 0 3px rgba(0, 120, 212, 0.1);
        }

        #sendBtn {
            padding: 15px 30px;
            background: linear-gradient(135deg, #0078d4 0%, #00a0e3 50%, #00d4ff 100%);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 120, 212, 0.2);
        }

        #sendBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 120, 212, 0.4);
            background: linear-gradient(135deg, #0086e6 0%, #00b0f5 50%, #00e0ff 100%);
        }

        #sendBtn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .loading {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #0078d4;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* Right Sidebar - Sample Prompts */
        .sidebar-right {
            width: 340px;
            background: #f8f9fa;
            padding: 30px 25px;
            overflow-y: auto;
            border-left: 1px solid #e0e0e0;
        }

        .sidebar-right::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar-right::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .sidebar-right::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 3px;
        }

        .sidebar-right h3 {
            color: #0078d4;
            font-size: 18px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .prompt-category {
            margin-bottom: 25px;
        }

        .prompt-category h4 {
            color: #333;
            font-size: 14px;
            margin-bottom: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sample-prompt {
            background: white;
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 13px;
            color: #555;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .sample-prompt:hover {
            border-color: #0078d4;
            background: linear-gradient(135deg, #e6f3ff 0%, #d4efff 100%);
            transform: translateX(-5px);
            box-shadow: 0 4px 12px rgba(0, 120, 212, 0.25);
        }

        .sample-prompt:before {
            content: "‚Üí";
            margin-right: 8px;
            color: #0078d4;
            font-weight: bold;
        }

        .stats-box {
            background: linear-gradient(135deg, #0078d4 0%, #00a0e3 50%, #00d4ff 100%);
            padding: 20px;
            border-radius: 12px;
            color: white;
            margin-top: 25px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 120, 212, 0.3);
        }

        .stats-box h4 {
            font-size: 14px;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .stats-box .stat-number {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stats-box .stat-label {
            font-size: 12px;
            opacity: 0.8;
        }

        /* Responsive Design */
        @media (max-width: 1400px) {
            .sidebar-left,
            .sidebar-right {
                width: 280px;
            }
        }

        @media (max-width: 1200px) {
            .sidebar-left {
                display: none;
            }
        }

        @media (max-width: 900px) {
            .sidebar-right {
                display: none;
            }
        }

        @media (max-width: 600px) {
            .header h1 {
                font-size: 20px;
            }
            
            .input-container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Left Sidebar - Marketing & Value Proposition -->
        <aside class="sidebar-left">
            <div class="logo-section">
                <h1>‚ö° Azure CloudOps</h1>
                <h1 style="font-size: 20px; margin-top: 5px;">Intelligence Agent</h1>
                <p class="tagline">AI-Powered FinOps & InfraOps</p>
            </div>

            <div class="value-section">
                <h3>üéØ Who Is This For?</h3>
                <div>
                    <span class="persona-badge">üíº CFOs</span>
                    <span class="persona-badge">üìä Finance Teams</span>
                    <span class="persona-badge">üè¢ CIOs</span>
                    <span class="persona-badge">‚öôÔ∏è Engineering Managers</span>
                    <span class="persona-badge">‚òÅÔ∏è Cloud Architects</span>
                    <span class="persona-badge">üîß DevOps Teams</span>
                </div>
            </div>

            <div class="value-section">
                <h3>üíº Business Value</h3>
                <p>Empower <strong>all stakeholders</strong>‚Äîfrom finance to engineering‚Äîwith self-service access to Azure intelligence without burdening your IT team.</p>
                <ul class="feature-list">
                    <li>Self-service cost analytics</li>
                    <li>Real-time spending insights</li>
                    <li>AI-powered recommendations</li>
                    <li>No Azure expertise required</li>
                </ul>
            </div>

            <div class="value-section">
                <h3>üöÄ Key Capabilities</h3>
                <ul class="feature-list">
                    <li><strong>üí∞ Cost Analytics:</strong> Real-time spending, trends, forecasts</li>
                    <li><strong>üîç Resource Discovery:</strong> Multi-subscription infrastructure inventory</li>
                    <li><strong>üìà AI Optimization:</strong> ROI-based savings recommendations</li>
                    <li><strong>üõ°Ô∏è Security Compliance:</strong> Policy violations & risk detection</li>
                    <li><strong>‚ö° Performance Insights:</strong> Resource utilization & efficiency</li>
                    <li><strong>üîê Enterprise Security:</strong> Managed Identity & RBAC</li>
                </ul>
            </div>

            <div class="value-section">
                <h3>üí∞ FinOps Benefits</h3>
                <ul class="feature-list">
                    <li>Reduce cloud costs by 15-40%</li>
                    <li>95% faster cost reporting</li>
                    <li>Free up IT resources</li>
                    <li>Data-driven decisions</li>
                    <li>Proactive cost governance</li>
                </ul>
            </div>

            <div class="value-section">
                <h3>üîí Enterprise Security</h3>
                <p>Built on Azure Managed Identity with role-based access control. Your data never leaves your Azure tenant.</p>
            </div>
        </aside>

        <!-- Center Chat Section -->
        <main class="chat-section">
            <header class="header">
                <h1>‚ö° Azure CloudOps Intelligence Agent</h1>
                <p>Your AI Assistant for Azure Cost Analytics ‚Ä¢ Infrastructure Discovery ‚Ä¢ Resource Optimization ‚Ä¢ Security Compliance ‚Ä¢ Performance Insights</p>
            </header>

            <div class="chat-container" id="chatContainer">
                <div class="welcome-message">
                    <h2>üëã Welcome to Azure CloudOps Intelligence</h2>
                    <p>Your AI-powered assistant for <strong>Cost Management</strong> ‚Ä¢ <strong>Infrastructure Operations</strong> ‚Ä¢ <strong>Resource Discovery</strong> ‚Ä¢ <strong>Optimization Insights</strong></p>
                    <p style="color: #0078d4; font-weight: 600; font-size: 15px; margin-top: 20px;">üí¨ Ask anything in natural language or click a sample prompt ‚Üí</p>
                </div>
            </div>

            <div class="input-container">
                <div class="input-wrapper">
                    <input 
                        type="text" 
                        id="userInput" 
                        placeholder="Ask about your Azure costs, resources, or optimization strategies..."
                        autocomplete="off"
                    />
                    <button id="sendBtn">Send</button>
                </div>
            </div>
        </main>

        <!-- Right Sidebar - Sample Prompts -->
        <aside class="sidebar-right">
            <div style="text-align: right; color: #555; font-size: 10px; margin-bottom: 15px; padding-right: 5px;">
                Developed by Zahir Hussain Shah<br>Version 1.0
            </div>
            
            <!-- Comprehensive Analysis Showcase -->
            <div style="background: linear-gradient(135deg, #0078d4 0%, #00a0e3 50%, #00d4ff 100%); padding: 20px; border-radius: 12px; margin-bottom: 25px; color: white; box-shadow: 0 4px 15px rgba(0,120,212,0.3);">
                <h3 style="margin: 0 0 12px 0; font-size: 16px; color: white;">üéØ Executive Showcase Prompt</h3>
                <p style="font-size: 12px; line-height: 1.6; margin-bottom: 12px; opacity: 0.95;">Try this comprehensive analysis that demonstrates all capabilities:</p>
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; font-size: 11px; line-height: 1.5; border-left: 3px solid white;">
                    <strong>Provide a comprehensive Azure environment analysis:</strong><br><br>
                    1) Show my total costs for this month with breakdown by top 3 services<br>
                    2) List all my virtual machines with their sizes and locations<br>
                    3) Identify any storage accounts with private endpoints for security review<br>
                    4) Give me 3 specific cost optimization recommendations with estimated ROI<br>
                    5) Analyze resource distribution across resource groups<br>
                    6) Provide strategic insights on how we can improve our Azure governance, cost efficiency, and security posture.
                </div>
                <button onclick="document.getElementById('userInput').value='Provide a comprehensive Azure environment analysis: 1) Show my total costs for this month with breakdown by top 3 services, 2) List all my virtual machines with their sizes and locations, 3) Identify any storage accounts with private endpoints for security review, 4) Give me 3 specific cost optimization recommendations with estimated ROI, 5) Analyze resource distribution across resource groups, and 6) Provide strategic insights on how we can improve our Azure governance, cost efficiency, and security posture. Present this as an executive briefing with actionable recommendations.'; document.getElementById('userInput').focus();" style="margin-top: 12px; background: white; color: #0078d4; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px; width: 100%; transition: all 0.3s;">üìã Copy to Chat</button>
            </div>

            <h3>üí° Sample Prompts</h3>

            <div class="prompt-category">
                <h4>ÔøΩ Cost Analysis & FinOps</h4>
                <div class="sample-prompt" data-prompt="What is my total Azure cost for this month?">
                    What is my total Azure cost for this month?
                </div>
                <div class="sample-prompt" data-prompt="Show me costs grouped by service">
                    Show me costs grouped by service
                </div>
                <div class="sample-prompt" data-prompt="What are my costs by resource group?">
                    What are my costs by resource group?
                </div>
                <div class="sample-prompt" data-prompt="Which resources are costing me the most?">
                    Which resources are costing me the most?
                </div>
            </div>

            <div class="prompt-category">
                <h4>ÔøΩ AI-Powered Optimization</h4>
                <div class="sample-prompt" data-prompt="Give me 3 specific cost optimization recommendations with ROI">
                    Give me 3 specific cost optimization recommendations with ROI
                </div>
                <div class="sample-prompt" data-prompt="Analyze my spending patterns and suggest savings opportunities">
                    Analyze my spending patterns and suggest savings opportunities
                </div>
                <div class="sample-prompt" data-prompt="What can I do to reduce my compute costs?">
                    What can I do to reduce my compute costs?
                </div>
            </div>

            <div class="prompt-category">
                <h4>üîç Infrastructure & Resource Discovery</h4>
                <div class="sample-prompt" data-prompt="List all my virtual machines">
                    List all my virtual machines
                </div>
                <div class="sample-prompt" data-prompt="Show me all storage accounts">
                    Show me all storage accounts
                </div>
                <div class="sample-prompt" data-prompt="Find storage accounts with private endpoints">
                    Find storage accounts with private endpoints
                </div>
                <div class="sample-prompt" data-prompt="What databases do I have running?">
                    What databases do I have running?
                </div>
            </div>

            <div class="prompt-category">
                <h4>ÔøΩÔ∏è Security & Compliance</h4>
                <div class="sample-prompt" data-prompt="Find storage accounts with public access enabled">
                    Find storage accounts with public access enabled
                </div>
                <div class="sample-prompt" data-prompt="Show me resources without proper tagging">
                    Show me resources without proper tagging
                </div>
                <div class="sample-prompt" data-prompt="List all key vaults and their access policies">
                    List all key vaults and their access policies
                </div>
            </div>

            <div class="prompt-category">
                <h4>ÔøΩ Strategic Insights & Analytics</h4>
                <div class="sample-prompt" data-prompt="Create a detailed cost trend analysis and forecast for next quarter">
                    Create a detailed cost trend analysis and forecast for next quarter
                </div>
                <div class="sample-prompt" data-prompt="What are the top 5 cost drivers in my environment and how can I reduce them?">
                    What are the top 5 cost drivers in my environment and how can I reduce them?
                </div>
                <div class="sample-prompt" data-prompt="Generate an executive summary of our Azure spending with ROI recommendations">
                    Generate an executive summary of our Azure spending with ROI recommendations
                </div>
            </div>

            <div class="prompt-category">
                <h4>üíº Finance & Executive Leadership</h4>
                <div class="sample-prompt" data-prompt="Cross-check our Azure invoice against actual resource costs by department">
                    Cross-check our Azure invoice against actual resource costs by department
                </div>
                <div class="sample-prompt" data-prompt="Identify any orphaned or unused resources that are still generating costs">
                    Identify any orphaned or unused resources that are still generating costs
                </div>
                <div class="sample-prompt" data-prompt="List all high-risk resources exposed to the internet or without proper security controls">
                    List all high-risk resources exposed to the internet or without proper security controls
                </div>
                <div class="sample-prompt" data-prompt="Show me which business units or resource groups have the highest cost variance this month">
                    Show me which business units or resource groups have the highest cost variance this month
                </div>
                <div class="sample-prompt" data-prompt="Analyze our Azure spending by region and recommend consolidation opportunities">
                    Analyze our Azure spending by region and recommend consolidation opportunities
                </div>
            </div>

            <div class="stats-box">
                <h4>‚ö° Powered by AI Intelligence</h4>
                <div class="stat-number">GPT-4o</div>
                <div class="stat-label">Azure OpenAI Latest Model</div>
                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.3);">
                    <div style="font-size: 24px; font-weight: 700;">28%</div>
                    <div style="font-size: 11px; opacity: 0.8;">Average Cost Savings</div>
                </div>
            </div>
        </aside>
    </div>

    <script>
        const chatContainer = document.getElementById('chatContainer');
        const userInput = document.getElementById('userInput');
        const sendBtn = document.getElementById('sendBtn');
        let conversationHistory = [];

        // Handle sample prompt clicks
        document.querySelectorAll('.sample-prompt').forEach(prompt => {
            prompt.addEventListener('click', function() {
                const promptText = this.getAttribute('data-prompt');
                userInput.value = promptText;
                sendMessage();
            });
        });

        // Send message on Enter key
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Send message on button click
        sendBtn.addEventListener('click', sendMessage);

        async function sendMessage() {
            const message = userInput.value.trim();
            if (!message) return;

            // Remove welcome message if exists
            const welcomeMsg = document.querySelector('.welcome-message');
            if (welcomeMsg) {
                welcomeMsg.remove();
            }

            // Add user message to chat
            addMessage(message, 'user');
            userInput.value = '';
            
            // Disable input while processing
            userInput.disabled = true;
            sendBtn.disabled = true;
            sendBtn.textContent = 'Thinking...';

            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: message,
                        conversation_history: conversationHistory
                    })
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const data = await response.json();
                
                // Add assistant message to chat
                addMessage(data.response, 'assistant');
                
                // Update conversation history
                conversationHistory = data.conversation_history || [];
                
            } catch (error) {
                console.error('Error:', error);
                addMessage('Sorry, I encountered an error. Please try again.', 'assistant');
            } finally {
                // Re-enable input
                userInput.disabled = false;
                sendBtn.disabled = false;
                sendBtn.textContent = 'Send';
                userInput.focus();
            }
        }

        function addMessage(text, role) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            // Convert markdown-style formatting to HTML
            let formattedText = text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n/g, '<br>');
            
            // Check if there's a table in the response
            if (formattedText.includes('|')) {
                formattedText = convertMarkdownTableToHtml(formattedText);
            }
            
            contentDiv.innerHTML = formattedText;
            messageDiv.appendChild(contentDiv);
            chatContainer.appendChild(messageDiv);
            
            // Scroll to bottom
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function convertMarkdownTableToHtml(text) {
            const lines = text.split('<br>');
            let inTable = false;
            let tableHtml = '';
            let result = '';
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                if (line.startsWith('|') && line.endsWith('|')) {
                    if (!inTable) {
                        inTable = true;
                        tableHtml = '<div class="table-wrapper"><table>';
                    }
                    
                    // Skip separator lines
                    if (line.includes('---')) {
                        continue;
                    }
                    
                    const cells = line.split('|').filter(cell => cell.trim());
                    const isHeader = i === 0 || (result === '' && tableHtml === '<div class="table-wrapper"><table>');
                    const tag = isHeader ? 'th' : 'td';
                    
                    tableHtml += '<tr>';
                    cells.forEach(cell => {
                        tableHtml += `<${tag}>${cell.trim()}</${tag}>`;
                    });
                    tableHtml += '</tr>';
                } else {
                    if (inTable) {
                        tableHtml += '</table></div>';
                        result += tableHtml + '<br>';
                        tableHtml = '';
                        inTable = false;
                    }
                    result += line + '<br>';
                }
            }
            
            if (inTable) {
                tableHtml += '</table></div>';
                result += tableHtml;
            }
            
            return result;
        }

        // Auto-focus input on load
        window.addEventListener('load', () => {
            userInput.focus();
        });
    </script>
</body>
</html>