<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure CloudOps Intelligence Agent</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 23 23'%3E%3Cpath fill='%23f25022' d='M0 0h11v11H0z'/%3E%3Cpath fill='%237fba00' d='M12 0h11v11H12z'/%3E%3Cpath fill='%2300a4ef' d='M0 12h11v11H0z'/%3E%3Cpath fill='%23ffb900' d='M12 12h11v11H12z'/%3E%3C/svg%3E">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Modern Light Theme - Figma Style */
            --primary: #0078D4;
            --primary-dark: #106EBE;
            --primary-light: #E6F2FB;
            --secondary: #5C2D91;
            --accent: #00B7C3;
            --success: #107C10;
            --success-light: #DFF6DD;
            --warning: #FF8C00;
            --warning-light: #FFF4CE;
            --danger: #D13438;
            --danger-light: #FDE7E9;
            
            /* Backgrounds */
            --background: #F5F7FA;
            --surface: #FFFFFF;
            --surface-secondary: #FAFBFC;
            --surface-hover: #F0F4F8;
            
            /* Text */
            --text-primary: #1A1A2E;
            --text-secondary: #5C6B7A;
            --text-muted: #8E99A4;
            --text-inverse: #FFFFFF;
            
            /* Borders */
            --border: #E1E5EB;
            --border-light: #F0F2F5;
            
            /* Shadows - Figma Style */
            --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.04);
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.10);
            --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.12);
            --shadow-primary: 0 4px 14px rgba(0, 120, 212, 0.25);
            
            /* Gradients */
            --gradient-primary: linear-gradient(135deg, #0078D4 0%, #106EBE 100%);
            --gradient-accent: linear-gradient(135deg, #00B7C3 0%, #0078D4 100%);
            --gradient-hero: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            
            /* Border Radius - Modern */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 9999px;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--background);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Header - Modern Clean Style */
        .header {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 0 16px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary);
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .brand:hover {
            transform: translateX(2px);
        }

        .logo {
            width: 80px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: flex-start;
        }

        .logo img {
            width: 100%;
            height: auto;
        }

        .subscription-selector {
            display: flex;
            align-items: center;
            margin-right: 24px;
        }

        .subscription-selector select {
            background: var(--surface-secondary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 12px;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.15s ease;
            min-width: 160px;
        }

        .subscription-selector select:hover {
            border-color: var(--primary);
            background: var(--surface);
        }

        .subscription-selector select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .brand-text h1 {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1px;
        }

        .brand-text p {
            font-size: 9px;
            color: var(--text-muted);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.06em;
        }

        .header-stats {
            display: flex;
            gap: 4px;
            align-items: center;
        }

        .header-stat {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            background: transparent;
            border: none;
            border-radius: 6px;
            box-shadow: none;
            transition: background 0.15s ease;
            min-width: auto;
            border-right: 1px solid var(--border-light);
        }

        .header-stat:last-child {
            border-right: none;
        }

        .header-stat > div:first-child {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header-stat:hover {
            background: var(--surface-hover);
            box-shadow: none;
            transform: none;
        }

        .header-stat-icon {
            font-size: 16px;
        }

        .header-stat-value {
            font-size: 13px;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1.2;
            min-height: auto;
        }

        .header-stat-label {
            font-size: 9px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.04em;
            line-height: 1;
            margin-top: 1px;
        }

        .header-stat.success .header-stat-value {
            color: var(--success);
        }

        .header-stat.warning .header-stat-value {
            color: var(--warning);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 4px 8px;
            background: transparent;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.15s ease;
            box-shadow: none;
        }

        .user-profile:hover {
            background: var(--surface-hover);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 13px;
            color: #FFFFFF;
            box-shadow: none;
            flex-shrink: 0;
        }

        .user-info {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.3;
        }

        .user-email {
            font-size: 10px;
            color: var(--text-muted);
            line-height: 1.3;
        }

        .logout-btn {
            padding: 5px 12px;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .logout-btn:hover {
            background: #FEF2F2;
            color: var(--danger);
            border-color: #FECACA;
        }

        /* Main Content */
        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* Sidebar - Modern Card Style */
        .sidebar {
            width: 240px;
            background: var(--surface);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            box-shadow: var(--shadow-sm);
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        .sidebar-section {
            padding: 8px 8px;
            border-bottom: 1px solid var(--border-light);
        }

        .section-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.08em;
            margin-bottom: 6px;
            padding: 4px 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* Insight Cards - Clean Style */
        .insight-card {
            background: var(--surface);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 4px;
            position: relative;
            overflow: hidden;
            transition: all 0.15s ease;
            box-shadow: none;
        }

        .insight-card:hover {
            background: #FAFCFF;
            box-shadow: none;
            transform: none;
        }

        .insight-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
        }

        .insight-card.success::before {
            background: var(--success);
        }

        .insight-card.warning::before {
            background: var(--warning);
        }

        .insight-card.danger::before {
            background: var(--danger);
        }

        .insight-card.success {
            background: linear-gradient(135deg, var(--success-light) 0%, var(--surface) 100%);
        }

        .insight-card.warning {
            background: linear-gradient(135deg, var(--warning-light) 0%, var(--surface) 100%);
        }

        .insight-card.danger {
            background: linear-gradient(135deg, var(--danger-light) 0%, var(--surface) 100%);
        }

        .insight-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .insight-icon {
            font-size: 24px;
        }

        .insight-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .insight-value {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .insight-card.success .insight-value {
            color: var(--success);
        }

        .insight-card.warning .insight-value {
            color: var(--warning);
        }

        .insight-card.danger .insight-value {
            color: var(--danger);
        }

        .insight-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Loading animation for dynamic data */
        .loading-dots::after {
            content: '';
            animation: loadingDots 1.5s steps(4, end) infinite;
        }
        
        @keyframes loadingDots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }

        .insight-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .insight-card.success-dynamic {
            border-color: var(--success);
        }
        
        .insight-card.success-dynamic::before {
            background: var(--success);
        }
        
        .insight-card.warning-dynamic {
            border-color: var(--warning);
        }
        
        .insight-card.warning-dynamic::before {
            background: var(--warning);
        }
        
        .insight-card.danger-dynamic {
            border-color: var(--danger);
        }
        
        .insight-card.danger-dynamic::before {
            background: var(--danger);
        }

        .insight-footer {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border-light);
            font-size: 11px;
            color: var(--text-muted);
        }

        /* Category Section - Azure Portal Style */
        .category-section {
            margin-bottom: 1px;
        }

        .category-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 7px 12px;
            background: transparent;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.15s ease;
            margin-bottom: 0;
        }

        .category-header:hover {
            background: #E8F4FD;
        }

        .category-header.active {
            background: #E8F4FD;
            border-left: 3px solid var(--primary);
            padding-left: 9px;
        }

        .category-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .category-icon {
            width: 20px;
            height: 20px;
            background: transparent;
            border-radius: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            padding: 0;
            flex-shrink: 0;
        }

        .category-icon img {
            width: 20px;
            height: 20px;
            object-fit: contain;
        }

        .category-header.active .category-icon {
            background: transparent;
        }

        .category-header.active .category-icon img {
            filter: none;
        }

        .category-name {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .category-header.active .category-name {
            color: var(--primary);
            font-weight: 600;
        }

        .category-toggle {
            font-size: 16px;
            transition: transform 0.2s;
            color: var(--text-muted);
        }

        .category-header.active .category-toggle {
            transform: rotate(180deg);
            color: var(--primary);
        }

        .category-prompts {
            display: none;
            padding: 2px 0 4px 0;
        }

        .category-prompts.active {
            display: block;
        }

        .prompt-item {
            padding: 5px 12px 5px 42px;
            margin: 0;
            background: transparent;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.15s ease;
            font-size: 12px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 8px;
            line-height: 1.4;
        }

        .prompt-item:hover {
            background: #E8F4FD;
            color: var(--primary-dark);
            transform: none;
        }

        .prompt-icon {
            font-size: 16px;
        }

        /* Chat Area - Modern Light Style */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            background: var(--background);
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px 20px;
            background: var(--background);
            position: relative;
        }

        .chat-messages::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 120, 212, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 183, 195, 0.03) 0%, transparent 50%);
            pointer-events: none;
        }

        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* Welcome State - Modern Card Design */
        .welcome-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            height: 100%;
            text-align: center;
            padding: 24px 20px 12px;
            position: relative;
            z-index: 1;
            overflow-y: auto;
        }

        .welcome-icon {
            width: 36px;
            height: 36px;
            background: var(--gradient-primary);
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 6px;
            box-shadow: var(--shadow-primary);
            animation: float 3s ease-in-out infinite;
            padding: 14px 16px;
        }

        .welcome-icon svg {
            width: 100%;
            height: 100%;
            display: block;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        @keyframes slideInRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        .welcome-state h2 {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 3px;
            color: var(--text-primary);
        }

        .welcome-state p {
            font-size: 11px;
            color: var(--text-secondary);
            margin-bottom: 16px;
            max-width: 700px;
            line-height: 1.5;
        }

        .welcome-categories {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            max-width: 1400px;
            width: 100%;
        }

        .welcome-category-card {
            background: #FFFFFF;
            border: 1px solid #EDF0F4;
            border-radius: 8px;
            padding: 12px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            gap: 0;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
        }

        .welcome-category-card::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary);
            transform: scaleX(0);
            transition: transform 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: left;
        }

        .welcome-category-card:hover {
            border-color: #C8DDF0;
            transform: translateY(-1px);
            box-shadow: 0 3px 12px rgba(0, 120, 212, 0.1);
            background: #FAFCFF;
        }

        .welcome-category-card:hover .welcome-category-title {
            color: var(--primary);
        }

        .welcome-category-card:hover::before {
            transform: scaleX(1);
        }

        .welcome-category-card:hover .welcome-category-icon {
            transform: scale(1.05);
        }

        .welcome-category-icon {
            font-size: 18px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            flex-shrink: 0;
            background: #F0F6FC;
            border-radius: 6px;
            padding: 4px;
            transition: transform 0.2s ease;
        }

        .welcome-category-icon img {
            width: 18px;
            height: 18px;
            object-fit: contain;
        }

        .welcome-category-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
            transition: color 0.15s ease;
            line-height: 1.3;
        }

        .welcome-category-desc {
            font-size: 10px;
            color: var(--text-muted);
            line-height: 1.35;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .welcome-category-count {
            display: none;
        }

        /* Messages - Modern Card Style */
        .message {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-avatar {
            width: 30px;
            height: 30px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: var(--gradient-primary);
            box-shadow: var(--shadow-primary);
            color: var(--text-inverse);
        }

        .message.assistant .message-avatar {
            background: var(--surface);
            border: 2px solid var(--border);
            color: var(--primary);
        }

        .message-content {
            flex: 1;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 10px 12px;
            color: var(--text-primary);
            line-height: 1.7;
            max-width: 85%;
            box-shadow: var(--shadow-sm);
        }

        .message.user .message-content {
            background: var(--gradient-primary);
            border: none;
            box-shadow: var(--shadow-primary);
            color: var(--text-inverse);
        }

        /* Table Styling - Modern Clean Design */
        .message-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
            background: var(--surface);
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .message-content thead {
            background: var(--primary);
        }

        .message-content th {
            padding: 8px 10px;
            text-align: left;
            font-weight: 600;
            color: var(--text-inverse);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: none;
        }

        .message-content td {
            padding: 14px 16px;
            border-bottom: 1px solid var(--border-light);
            color: var(--text-primary);
            font-size: 14px;
        }

        .message-content tbody tr {
            transition: all 0.2s ease;
        }

        .message-content tbody tr:hover {
            background: var(--surface-hover);
        }

        .message-content tbody tr:last-child td {
            border-bottom: none;
        }

        .message-content .table-wrapper {
            overflow-x: auto;
            max-width: 100%;
            margin: 16px 0;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            -webkit-overflow-scrolling: touch;
        }

        /* Scrollbar styling for tables */
        .message-content .table-wrapper::-webkit-scrollbar {
            height: 10px;
        }

        .message-content .table-wrapper::-webkit-scrollbar-track {
            background: var(--surface);
            border-radius: 5px;
        }

        .message-content .table-wrapper::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 5px;
        }

        .message-content .table-wrapper::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }

        /* Ensure tables are wide enough to scroll */
        .message-content table {
            min-width: 800px;
            width: 100%;
        }

        .message-content strong {
            color: var(--primary);
            font-weight: 600;
        }

        .message-content .cost-highlight {
            color: var(--warning);
            font-weight: 700;
        }

        .message-content .savings-highlight {
            color: var(--success);
            font-weight: 700;
        }

        .message-content .danger-highlight {
            color: var(--danger);
            font-weight: 700;
        }

        /* CSV Export Button */
        .export-csv-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin: 8px 0;
            padding: 8px 16px;
            background: var(--gradient-primary);
            border: none;
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .export-csv-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .export-csv-btn svg {
            width: 14px;
            height: 14px;
        }

        .full-export-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .full-export-btn:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
        }

        .table-actions {
            display: flex;
            justify-content: flex-end;
            padding: 8px 0;
            gap: 10px;
            flex-wrap: wrap;
        }

        .row-count-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            background: var(--surface-hover);
            border-radius: 12px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        /* About Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(4px);
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 16px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            padding: 14px 16px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
            transition: color 0.3s;
        }

        .modal-close:hover {
            color: var(--danger);
        }

        .modal-body {
            padding: 14px 16px;
        }

        .modal-body h3 {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
            margin-top: 16px;
            margin-bottom: 8px;
        }

        .modal-body p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 6px;
        }

        .modal-body ul {
            list-style: none;
            padding: 0;
        }

        .modal-body li {
            color: var(--text-secondary);
            padding: 8px 0;
            padding-left: 24px;
            position: relative;
        }

        .modal-body li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: var(--success);
        }

        .developer-info {
            background: linear-gradient(135deg, #0078D4 0%, #106EBE 50%, #0058A0 100%);
            border: none;
            border-radius: var(--radius-lg);
            padding: 24px 28px;
            margin-top: 16px;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 120, 212, 0.25);
        }

        .developer-info .label {
            font-size: 11px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.7);
            text-transform: uppercase;
            letter-spacing: 0.15em;
            margin-bottom: 8px;
            position: relative;
        }

        .developer-info .name {
            font-size: 24px;
            font-weight: 700;
            color: #ffffff;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            margin-bottom: 4px;
            position: relative;
        }

        .developer-info .role {
            font-size: 13px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.85);
            text-transform: uppercase;
            letter-spacing: 0.08em;
            position: relative;
        }

        .developer-info .contact-links {
            margin-top: 16px;
            display: flex;
            justify-content: center;
            gap: 24px;
            position: relative;
        }

        .developer-info .contact-links a {
            color: rgba(255, 255, 255, 0.9) !important;
            text-decoration: none;
            font-size: 13px;
            font-weight: 500;
        }

        /* Input Area - Modern Clean Style */
        .input-area {
            background: var(--surface);
            border-top: 1px solid var(--border);
            padding: 10px 16px;
            box-shadow: 0 -4px 16px rgba(0, 0, 0, 0.04);
        }

        .input-wrapper {
            display: flex;
            gap: 8px;
            max-width: 1600px;
            margin: 0 auto;
        }

        #userInput {
            flex: 1;
            background: var(--surface-secondary);
            border: 2px solid var(--border);
            border-radius: var(--radius-md);
            padding: 10px 14px;
            color: var(--text-primary);
            font-size: 15px;
            font-family: inherit;
            resize: none;
            min-height: 70px;
            max-height: 200px;
            transition: all 0.2s ease;
            line-height: 1.6;
        }

        #userInput:focus {
            outline: none;
            border-color: var(--primary);
            background: var(--surface);
            box-shadow: 0 0 0 4px var(--primary-light);
        }

        #userInput::placeholder {
            color: var(--text-muted);
        }

        #sendBtn {
            padding: 10px 20px;
            background: var(--gradient-primary);
            border: none;
            border-radius: var(--radius-md);
            color: var(--text-inverse);
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: var(--shadow-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #sendBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 120, 212, 0.35);
        }

        #sendBtn:active {
            transform: translateY(0);
        }

        #sendBtn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .header-stats {
                display: none;
            }

            .welcome-categories {
                grid-template-columns: repeat(4, 1fr);
                gap: 8px;
            }
        }

        @media (max-width: 900px) {
            .welcome-categories {
                grid-template-columns: repeat(3, 1fr);
                gap: 8px;
            }
        }

        @media (max-width: 1024px) {
            .sidebar {
                width: 220px;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .header {
                padding: 0 20px;
            }

            .chat-messages {
                padding: 20px;
            }

            .input-area {
                padding: 16px 20px;
            }
        }

        /* Diagram export dropdown */
        .export-menu.show {
            display: block !important;
        }
    </style>
</head>
<body>
    <!-- About Modal -->
    <div id="aboutModal" class="modal-overlay" onclick="closeAboutModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>About Azure CloudOps Intelligence Agent</h2>
                <button class="modal-close" onclick="closeAboutModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="developer-info">
                    <div class="label">Solution Accelerator Developed by</div>
                    <div class="name">Zahir Hussain Shah</div>
                    <div class="role">Senior Cloud Solution Architect</div>
                    <div class="contact-links">
                        <a href="mailto:zahir@zahir.cloud">✉️ zahir@zahir.cloud</a>
                        <a href="https://www.zahir.cloud" target="_blank">🌐 www.zahir.cloud</a>
                    </div>
                </div>

                <p style="margin-top: 20px;">
                    This is a <strong>Solution Accelerator</strong> designed to showcase the agentic capabilities of Azure OpenAI 
                    while integrating with Azure Resource Graph API, Azure Cost Management API, and other key Azure components 
                    to provide comprehensive insights about Azure infrastructure management, operations, and optimization.
                </p>

                <h3>Key Features</h3>
                <ul>
                    <li>Resource Management - Inventory, filtering, and search across all Azure resources</li>
                    <li>Cost Optimization - Cost analysis, trends, comparisons, and savings recommendations</li>
                    <li>Security & Compliance - Defender for Cloud, Azure Policy, public access audit</li>
                    <li>Monitoring & Alerts - Active alerts, monitoring gaps, VM Insights status</li>
                    <li>Tags Management - Tag inventory, compliance, and smart search</li>
                    <li>Azure Policy & Governance - Compliance status, exemptions, non-compliant resources</li>
                    <li>Update Management - Pending updates for VMs and Arc machines</li>
                    <li>Azure Arc Management - Hybrid infrastructure visibility</li>
                    <li>Service-specific Insights - App Services, AKS, SQL, PostgreSQL, MySQL, Cosmos DB, APIM, Storage Accounts</li>
                    <li>AI-powered Automation - Intelligent recommendations and automation opportunities</li>
                </ul>

                <h3>Technology Stack</h3>
                <ul>
                    <li>Azure OpenAI Service with GPT-4 for natural language processing</li>
                    <li>Azure Resource Graph API for cross-subscription resource queries</li>
                    <li>Azure Cost Management API for cost analytics</li>
                    <li>Azure Policy Insights for compliance data</li>
                    <li>FastAPI backend with Python</li>
                    <li>Modern responsive web interface</li>
                </ul>

                <h3>Enterprise Ready</h3>
                <p>
                    Designed for enterprise deployment with support for Azure AD authentication, 
                    multi-subscription management, and secure data handling. All data is retrieved 
                    directly from your Azure environment - no sample or imaginary data.
                </p>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="brand" onclick="goHome()">
            <div class="logo">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 609 130" style="width: 80px;
            height: 18px;">
                    <path fill="#f25022" d="M0 0h61.3v61.3H0z"/>
                    <path fill="#7fba00" d="M67.7 0H129v61.3H67.7z"/>
                    <path fill="#00a4ef" d="M0 67.7h61.3V129H0z"/>
                    <path fill="#ffb900" d="M67.7 67.7H129V129H67.7z"/>
                    <text x="145" y="95" font-family="Segoe UI, Arial, sans-serif" font-size="72" font-weight="600" fill="#5E5E5E">Microsoft</text>
                </svg>
            </div>
            <div class="brand-text">
                <h1>Azure CloudOps Intelligence Agent</h1>
                <p>Ask your Azure estate. Get instant cost, security & optimization insights</p>
            </div>
        </div>
        
        <div class="subscription-selector">
            <label for="subscriptionSelect" style="font-size: 11px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-right: 8px;">Subscription:</label>
            <select id="subscriptionSelect" onchange="changeSubscription()">
                <option value="all">All Subscriptions</option>
                <option value="loading" selected>Loading subscriptions...</option>
            </select>
        </div>

        <div class="header-stats">
            <div class="header-stat success">
                <div>
                    <div class="header-stat-value" id="healthScore">--</div>
                    <div class="header-stat-label">Health</div>
                </div>
                <div class="header-stat-icon">💚</div>
            </div>
            <div class="header-stat warning">
                <div>
                    <div class="header-stat-value" id="monthlyCost">--</div>
                    <div class="header-stat-label">Cost</div>
                </div>
                <div class="header-stat-icon">💰</div>
            </div>
            <div class="header-stat" style="cursor:pointer" onclick="sendMessage('Show all resources with public access exposure - public IPs and PaaS services with public network access enabled')" title="Click to see public access details">
                <div>
                    <div class="header-stat-value" id="publicAccessCount">--</div>
                    <div class="header-stat-label">Public Exposure</div>
                </div>
                <div class="header-stat-icon">🌐</div>
            </div>
        </div>

        <div class="header-actions">
            <div class="user-profile" id="userProfile" style="display: none;">
                <div class="user-avatar" id="userAvatar">U</div>
                <div class="user-info">
                    <span class="user-name" id="userName">Loading...</span>
                    <span class="user-email" id="userEmail"></span>
                </div>
            </div>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Live Insights Section -->
            <div class="sidebar-section">
                <h3 class="section-title">
                    <span>📊</span> Live Insights
                </h3>
                
                <div class="insight-card" id="securityCard" onclick="quickPrompt('Show Microsoft Defender for Cloud security recommendations for my subscription. Include severity counts and top issues.')" style="cursor: pointer;">
                    <div class="insight-header">
                        <div class="insight-icon"><img src="/Icons/security/10241-icon-service-Microsoft-Defender-for-Cloud.svg" alt="Security" style="width: 16px; height: 16px;" onerror="this.style.display='none'"></div>
                        <div class="insight-title">Security Score</div>
                    </div>
                    <div class="insight-value" id="sidebarSecurityScore" style="font-size: 14px; font-weight: 700;">
                        --
                    </div>
                    <div class="insight-subtitle" id="sidebarSecuritySubtitle">Click to review security</div>
                    <div class="insight-footer" style="color: var(--primary); font-size: 11px;">
                        Click for full assessment →
                    </div>
                </div>

                <div class="insight-card" id="savingsCard" onclick="quickPrompt('Find all cost savings opportunities in my subscription. Show ACTUAL resource names with potential savings amounts.')" style="cursor: pointer;">
                    <div class="insight-header">
                        <div class="insight-icon"><img src="/Icons/general/10019-icon-service-Cost-Management.svg" alt="Savings" style="width: 16px; height: 16px;" onerror="this.style.display='none'"></div>
                        <div class="insight-title">Potential Savings</div>
                    </div>
                    <div class="insight-value" id="sidebarSavings" style="font-size: 14px; font-weight: 700;">
                        --
                    </div>
                    <div class="insight-subtitle" id="sidebarSavingsSubtitle">Click to check savings</div>
                    <div class="insight-footer" style="color: var(--primary); font-size: 11px;">
                        Click for detailed breakdown →
                    </div>
                </div>

                <div class="insight-card" id="resourcesCard" onclick="quickPrompt('List ALL resources in my current subscription grouped by type with counts.')" style="cursor: pointer;">
                    <div class="insight-header">
                        <div class="insight-icon"><img src="/Icons/general/10001-icon-service-All-Resources.svg" alt="Resources" style="width: 16px; height: 16px;" onerror="this.style.display='none'"></div>
                        <div class="insight-title">Total Resources</div>
                    </div>
                    <div class="insight-value" id="sidebarResources" style="font-size: 14px; font-weight: 700;">
                        --
                    </div>
                    <div class="insight-subtitle" id="sidebarResourcesSubtitle">Click to view resources</div>
                    <div class="insight-footer" style="color: var(--primary); font-size: 11px;">
                        Click for full inventory →
                    </div>
                </div>
            </div>

            <!-- Categories Section -->
            <div class="sidebar-section">
                <h3 class="section-title">
                    <span>🎯</span> Quick Actions
                </h3>

                <!-- Entra ID (Azure AD) Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('entraid')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/identity/10235-icon-service-Identity-Governance.svg" alt="Entra ID"></div>
                            <div class="category-name">Entra ID (Azure AD)</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-entraid">
                        <div class="prompt-item" onclick="quickPrompt('Show Entra ID tenant overview. Include: Total Users, Guest Users, Groups, App Registrations, Enterprise Applications, Devices, Conditional Access Policies, License Summary.')">
                            <span class="prompt-icon">📊</span>
                            <span>Entra ID overview</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show users who have not signed in for 30+ days. Include: User Name, Email, User Principal Name, Last Sign-in Date, Days Since Sign-in, Account Status, User Type, Department.')">
                            <span class="prompt-icon">⏰</span>
                            <span>Users inactive 30+ days</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show orphaned guest accounts that haven\\'t signed in for 90+ days. Include: Guest Name, Email, Invited By, Invitation Date, Last Sign-in, Days Inactive, Access Level, Cleanup Recommendation.')">
                            <span class="prompt-icon">👻</span>
                            <span>Orphaned guest accounts</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show users with privileged directory roles (Global Admin, Security Admin, etc.). Include: User Name, Email, Role Assignments, Role Type (Built-in/Custom), PIM Eligible, MFA Status, Last Sign-in.')">
                            <span class="prompt-icon">👑</span>
                            <span>Privileged role users</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show all Global Administrators in Entra ID. Include: User Name, Email, Account Type (Member/Guest), MFA Enabled, Last Sign-in, PIM Status, Risk Level.')">
                            <span class="prompt-icon">🔑</span>
                            <span>Global administrators</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show all devices registered in Entra ID. Include: Device Name, Device Type (Windows/iOS/Android/macOS), OS Version, Compliance State, Trust Type (Azure AD Joined/Hybrid/Registered), Last Activity.')">
                            <span class="prompt-icon">💻</span>
                            <span>Device inventory</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show stale devices not active in 90+ days. Include: Device Name, Device Type, OS, Last Activity Date, Days Inactive, Compliance State, Owner, Cleanup Recommendation.')">
                            <span class="prompt-icon">📵</span>
                            <span>Stale devices (90+ days)</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show all app registrations in Entra ID. Include: App Name, Application ID, Publisher, Verified, Created Date, Credential Expiry, API Permissions, Sign-in Audience.')">
                            <span class="prompt-icon">📱</span>
                            <span>App registrations</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show enterprise applications (service principals). Include: App Name, Publisher, Application ID, Sign-in Enabled, User Assignment Required, Last Sign-in, Users/Groups Assigned.')">
                            <span class="prompt-icon">🏢</span>
                            <span>Enterprise applications</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show all groups in Entra ID. Include: Group Name, Group Type (Security/M365/Distribution), Membership Type (Assigned/Dynamic), Member Count, Owner, Created Date, Description.')">
                            <span class="prompt-icon">👥</span>
                            <span>Groups inventory</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show empty groups with no members. Include: Group Name, Group Type, Created Date, Owner, Description, Cleanup Recommendation.')">
                            <span class="prompt-icon">📭</span>
                            <span>Empty groups</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show all Conditional Access policies. Include: Policy Name, State (Enabled/Disabled/Report-only), Target Users/Groups, Cloud Apps, Conditions, Grant Controls (MFA/Block/etc), Session Controls.')">
                            <span class="prompt-icon">🛡️</span>
                            <span>Conditional Access policies</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show disabled Conditional Access policies. Include: Policy Name, Created Date, Modified Date, Target Scope, Original Purpose, Disable Reason, Security Impact.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>Disabled CA policies</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Conditional Access policies that do NOT require MFA. Include: Policy Name, State, Target Users, Cloud Apps, Grant Controls, Risk Level, MFA Recommendation.')">
                            <span class="prompt-icon">🚨</span>
                            <span>CA policies without MFA</span>
                        </div>
                    </div>
                </div>

                <!-- Access Control (IAM) Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('iam')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/identity/10340-icon-service-Entra-Identity-Roles-and-Administrators.svg" alt="IAM"></div>
                            <div class="category-name">Access Control (IAM)</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-iam">
                        <div class="prompt-item" onclick="quickPrompt('List ALL Active (Permanent) role assignments at Management Group level. These are always-on privileged access assignments that pose security risk. Include: Principal Name, Principal Type (User/Group/ServicePrincipal), Role Name, Role Type (BuiltIn/Custom), Scope (Management Group Name), Assignment Type (Active/Eligible), Created Date, Created By. Focus on privileged roles: Owner, Contributor, User Access Administrator. Flag any concerning patterns.')">
                            <span class="prompt-icon">🏢</span>
                            <span>Active roles at Management Group</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('List ALL Active (Permanent) role assignments at Subscription level. Show assignments that are always active (not PIM eligible). Include: Principal Name, Principal Type (User/Group/ServicePrincipal), Role Name, Scope (Subscription Name), Assignment Type, Created Date, Risk Level. Highlight Owner, Contributor, and User Access Administrator roles. Sort by risk level.')">
                            <span class="prompt-icon">📋</span>
                            <span>Active roles at Subscription</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('List ALL Active (Permanent) role assignments at Resource Group level. Show permanent privileged access that bypasses PIM. Include: Principal Name, Principal Type, Role Name, Resource Group, Subscription, Assignment Type, Created Date. Flag privileged roles (Owner, Contributor, User Access Administrator) as security concerns.')">
                            <span class="prompt-icon">📁</span>
                            <span>Active roles at Resource Group</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('List ALL Privileged Administrator roles assigned to GUEST users across all scopes. This is a critical security audit. Include: Guest User Email, Guest Domain, Role Name, Scope Level (Management Group/Subscription/Resource Group), Scope Name, Assignment Type (Active/Eligible), Invitation Date, Last Sign-in Date, Risk Level. Flag roles: Global Administrator, Owner, Contributor, User Access Administrator, Security Admin.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>Privileged roles on Guest users</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show comprehensive RBAC role assignment summary across all scopes. Include: Total Assignments by Scope (Management Group/Subscription/Resource Group), Breakdown by Principal Type (Users/Groups/Service Principals), Breakdown by Role Type (Owner/Contributor/Reader/Custom), Active vs Eligible (PIM) assignments, Guest user role counts, Security risk summary.')">
                            <span class="prompt-icon">📊</span>
                            <span>RBAC summary dashboard</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('List Service Principals and Managed Identities with Owner or Contributor roles. Include: Service Principal Name, Application ID, Type (App Registration/Managed Identity), Role Name, Scope, Created Date, Last Activity, Associated Resources. These can be security risks if compromised.')">
                            <span class="prompt-icon">🤖</span>
                            <span>Service Principal privileged roles</span>
                        </div>
                    </div>
                </div>

                <!-- Landing Zone Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('landingzone')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/new icons/029636048-icon-service-Landing-Zone.svg" alt="Landing Zone"></div>
                            <div class="category-name">Landing Zone (CAF)</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-landingzone">
                        <!-- Landing Zone Overview -->
                        <div class="prompt-item" onclick="quickPrompt('Perform comprehensive Azure Landing Zone assessment based on Microsoft Cloud Adoption Framework (CAF). Analyze: Management Group hierarchy, Subscription organization, Policy assignments at each level, RBAC structure, Network topology (Hub-Spoke/vWAN), Identity integration, Governance maturity. Provide LZ readiness score with gaps and recommendations.')">
                            <span class="prompt-icon"><img src="/Icons/new icons/029636048-icon-service-Landing-Zone.svg" style="width:16px;height:16px"></span>
                            <span>Landing Zone assessment (CAF)</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show complete Management Group hierarchy and structure. Include: Root Management Group, Child Management Groups at each level, Subscriptions under each MG, Policy Assignments inherited, RBAC roles inherited, Total resources per MG branch. Visualize hierarchy depth and breadth.')">
                            <span class="prompt-icon"><img src="/Icons/general/10011-icon-service-Management-Groups.svg" style="width:16px;height:16px"></span>
                            <span>Management Group hierarchy</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Subscription organization and categorization. Include: Subscription Name, Management Group path, Environment type (Platform/Application), Purpose (Connectivity/Identity/Management/Workload), Total Resources, Cost (Last Month), Policy Compliance %, Owner.')">
                            <span class="prompt-icon"><img src="/Icons/general/10002-icon-service-Subscriptions.svg" style="width:16px;height:16px"></span>
                            <span>Subscription organization review</span>
                        </div>
                        <!-- Platform Landing Zone -->
                        <div class="prompt-item" onclick="quickPrompt('Analyze PLATFORM Landing Zone components based on CAF. Review: Connectivity subscription (Hub VNet, Azure Firewall, VPN/ExpressRoute, DNS), Identity subscription (Domain Controllers, Azure AD Connect), Management subscription (Log Analytics, Automation, Backup). Show: Deployed resources, Configuration status, Best practice gaps, Recommendations.')">
                            <span class="prompt-icon">🏛️</span>
                            <span>Platform Landing Zone review</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Review CONNECTIVITY subscription (Hub). Analyze: Hub VNet configuration, Azure Firewall rules and policies, VPN Gateway connections, ExpressRoute circuits, Azure Bastion, Public IPs, DDoS Protection, DNS configuration, Peering to spoke VNets. Identify gaps vs CAF recommendations.')">
                            <span class="prompt-icon">🌐</span>
                            <span>Connectivity (Hub) subscription review</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Review IDENTITY subscription. Analyze: Domain Controller VMs, Azure AD Connect servers, Hybrid identity configuration, Private DNS zones for AD, Network connectivity to on-premises, Backup configuration, High availability setup. Score against CAF best practices.')">
                            <span class="prompt-icon">🔐</span>
                            <span>Identity subscription review</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Review MANAGEMENT subscription. Analyze: Log Analytics workspaces, Azure Automation accounts, Update Management configuration, Azure Monitor setup, Backup vaults, Azure Policy definitions, Blueprints. Assess centralized management capability.')">
                            <span class="prompt-icon">📊</span>
                            <span>Management subscription review</span>
                        </div>
                        <!-- Application Landing Zone -->
                        <div class="prompt-item" onclick="quickPrompt('Analyze APPLICATION Landing Zone (Spoke) subscriptions. For each spoke subscription show: Spoke Name, Purpose/Workload, VNet and peering to Hub, NSGs configured, Route tables (UDRs), Policy compliance, Cost, Resource count, Owner, Security posture.')">
                            <span class="prompt-icon">📱</span>
                            <span>Application Landing Zones review</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Review specific Spoke subscription for Landing Zone compliance. Ask which subscription, then analyze: VNet configuration, Hub connectivity, NSG rules, Route table configuration, Policy compliance, Private endpoints usage, Backup protection, Tagging compliance, Cost governance.')">
                            <span class="prompt-icon">🔍</span>
                            <span>Single Spoke subscription review</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Compare Application Landing Zones (spokes) against each other. Show: Consistency in VNet sizing, Common policy deviations, Security posture variations, Cost patterns, Tagging compliance differences, Best-in-class spoke identification, Standardization recommendations.')">
                            <span class="prompt-icon">⚖️</span>
                            <span>Spoke consistency comparison</span>
                        </div>
                        <!-- Policy & Governance -->
                        <div class="prompt-item" onclick="quickPrompt('Analyze Landing Zone policy structure based on CAF. Show: Policies at Root MG (should be minimal), Policies at Platform MG, Policies at Landing Zones MG, Policies at individual subscriptions. Identify: Policy inheritance, Overlapping policies, Missing required policies, Policy effectiveness.')">
                            <span class="prompt-icon"><img src="/Icons/management + governance/10316-icon-service-Policy.svg" style="width:16px;height:16px"></span>
                            <span>Landing Zone policy structure</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show required CAF policies NOT deployed. Compare deployed policies against CAF recommended policies for: Allowed locations, Allowed VM SKUs, Required tags, Network security (NSG on subnets), Encryption requirements, Backup requirements, Monitoring requirements. List missing policies with priority.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>Missing CAF recommended policies</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Analyze RBAC structure for Landing Zone. Show: RBAC assignments at Management Group level, Subscription level, Built-in vs Custom roles, Privileged role holders, Service Principal access, Break-glass account configuration, PIM usage. Identify least privilege violations.')">
                            <span class="prompt-icon">👥</span>
                            <span>Landing Zone RBAC structure</span>
                        </div>
                        <!-- Network Topology -->
                        <div class="prompt-item" onclick="quickPrompt('Analyze Landing Zone network topology. Determine: Topology type (Hub-Spoke traditional, Hub-Spoke with Azure Firewall, Virtual WAN), Hub VNet(s), Spoke VNets, Peering configuration, Transit connectivity, On-premises connectivity, DNS architecture. Compare to CAF recommended topologies.')">
                            <span class="prompt-icon">🔀</span>
                            <span>Landing Zone network topology</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Validate Hub-Spoke network design. Check: Hub VNet address space, Spoke VNet address spaces, No overlapping CIDRs, Peering configuration (allow gateway transit), Route tables for traffic flow through firewall, DNS configuration, ExpressRoute/VPN gateway, Network segmentation.')">
                            <span class="prompt-icon">✅</span>
                            <span>Hub-Spoke design validation</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show network segmentation and security boundaries. Analyze: Subscription as security boundary, VNet as network boundary, Subnet as micro-segment, NSG placement, Azure Firewall rules, Application security groups (ASGs), Service endpoints, Private endpoints. Score segmentation maturity.')">
                            <span class="prompt-icon">🛡️</span>
                            <span>Network segmentation review</span>
                        </div>
                        <!-- Compliance & Security -->
                        <div class="prompt-item" onclick="quickPrompt('Perform Landing Zone security baseline assessment. Check CAF security best practices: MFA enforcement, Conditional Access, Privileged Identity Management, Security Center/Defender configuration, Network security, Data encryption, Key management, Logging and monitoring, Incident response readiness.')">
                            <span class="prompt-icon">🔒</span>
                            <span>Security baseline assessment</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Assess Landing Zone compliance readiness. Check: Regulatory compliance policies (HIPAA/PCI/SOC2/ISO27001), Data residency controls, Encryption requirements, Access controls, Audit logging, Backup and DR, Policy enforcement. Identify compliance gaps.')">
                            <span class="prompt-icon">📜</span>
                            <span>Compliance readiness assessment</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Review Defender for Cloud coverage across Landing Zone. Show: Defender plans enabled (Servers/SQL/Storage/AppService/Containers/KeyVault), Coverage by subscription, Security score per subscription, Unprotected resources, Cost of full coverage, Priority recommendations.')">
                            <span class="prompt-icon">🛡️</span>
                            <span>Defender for Cloud coverage</span>
                        </div>
                        <!-- Operations & Monitoring -->
                        <div class="prompt-item" onclick="quickPrompt('Review Landing Zone monitoring and logging configuration. Check: Centralized Log Analytics workspace, Activity log collection, Diagnostic settings on all resources, Azure Monitor alerts, Action groups, Workbooks/Dashboards, Application Insights, VM monitoring agents. Identify monitoring gaps.')">
                            <span class="prompt-icon">📈</span>
                            <span>Monitoring & logging review</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Review Landing Zone backup and disaster recovery. Analyze: Backup policies per subscription/workload, Recovery Services vaults, Backup compliance, DR strategy (Azure Site Recovery), Cross-region replication, RPO/RTO defined, DR testing schedule. Identify protection gaps.')">
                            <span class="prompt-icon">💾</span>
                            <span>Backup & DR review</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Review Landing Zone cost governance. Analyze: Cost Management setup, Budgets per subscription/MG, Cost alerts, Tag-based cost allocation, Reserved Instances usage, Savings Plans, Orphaned resources, Right-sizing opportunities, Showback/chargeback readiness.')">
                            <span class="prompt-icon">💰</span>
                            <span>Cost governance review</span>
                        </div>
                        <!-- Landing Zone Maturity -->
                        <div class="prompt-item" onclick="quickPrompt('Calculate Landing Zone maturity score. Assess each CAF pillar: 1) Identity (0-100), 2) Network (0-100), 3) Management (0-100), 4) Governance (0-100), 5) Security (0-100), 6) Platform automation (0-100). Provide overall maturity level (Initial/Developing/Defined/Managed/Optimized) with improvement roadmap.')">
                            <span class="prompt-icon">📊</span>
                            <span>Landing Zone maturity score</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Generate Landing Zone improvement roadmap. Based on current assessment, provide: Quick wins (< 1 week), Short-term improvements (1-4 weeks), Medium-term enhancements (1-3 months), Long-term transformation (3-6 months). Prioritize by: Security impact, Cost savings, Operational efficiency.')">
                            <span class="prompt-icon">🗺️</span>
                            <span>Landing Zone improvement roadmap</span>
                        </div>
                    </div>
                </div>

                <!-- Well-Architected Framework (WAF) Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('waf')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/management + governance/00003-icon-service-Advisor.svg" alt="WAF"></div>
                            <div class="category-name">Well-Architected Framework</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-waf">
                        <div class="prompt-item" onclick="quickPrompt('Perform a comprehensive Azure Well-Architected Framework (WAF) assessment. Analyze resources against all 5 pillars: Reliability, Security, Cost Optimization, Operational Excellence, and Performance Efficiency. For each pillar provide: 1) Current state, 2) Identified gaps, 3) Risk level, 4) Top 3 recommendations.')">
                            <span class="prompt-icon"><img src="/Icons/management + governance/00003-icon-service-Advisor.svg" alt="WAF" style="width:18px;height:18px;"></span>
                            <span>Full WAF Assessment</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Perform a WAF RELIABILITY pillar assessment. Focus on: VMs without Availability Zones/Sets, Single points of failure, Load balancer health probes, Backup coverage, Recovery Services Vault configuration, Disaster recovery geo-replication.')">
                            <span class="prompt-icon"><img src="/Icons/general/10004-icon-service-Service-Health.svg" alt="Reliability" style="width:18px;height:18px;"></span>
                            <span>Reliability Assessment</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Perform a WAF SECURITY pillar assessment. Focus on: Storage accounts with public access, Key Vaults security, NSGs with permissive rules, Resources without Private Endpoints, Privileged RBAC assignments, Defender for Cloud recommendations.')">
                            <span class="prompt-icon"><img src="/Icons/security/10241-icon-service-Microsoft-Defender-for-Cloud.svg" alt="Security" style="width:18px;height:18px;"></span>
                            <span>Security Assessment</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Perform a WAF COST OPTIMIZATION pillar assessment. Focus on: Resources without cost tags, Deallocated VMs, Orphaned disks, Unattached Public IPs, Reserved Instance opportunities, Over-provisioned VM sizes.')">
                            <span class="prompt-icon"><img src="/Icons/general/10019-icon-service-Cost-Management.svg" alt="Cost" style="width:18px;height:18px;"></span>
                            <span>Cost Optimization Assessment</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Perform a WAF OPERATIONAL EXCELLENCE pillar assessment. Focus on: Naming convention compliance, Tagging standards, Policy compliance, Resources without diagnostic settings, VMs without Azure Monitor agent, Update Management compliance.')">
                            <span class="prompt-icon"><img src="/Icons/management + governance/00001-icon-service-Monitor.svg" alt="OpEx" style="width:18px;height:18px;"></span>
                            <span>Operational Excellence Assessment</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Perform a WAF PERFORMANCE EFFICIENCY pillar assessment. Focus on: VM SKU appropriateness, App Service auto-scaling, SQL sizing analysis, Disk type optimization, Storage performance tiers, CDN coverage.')">
                            <span class="prompt-icon"><img src="/Icons/devops/02423-icon-service-Load-Testing.svg" alt="Perf" style="width:18px;height:18px;"></span>
                            <span>Performance Efficiency Assessment</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Perform a targeted WAF review for a specific resource group. Ask me which resource group to analyze, then assess all resources against the 5 WAF pillars.')">
                            <span class="prompt-icon">📁</span>
                            <span>WAF Review by Resource Group</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Perform a WAF review for resources filtered by tag. Ask me which tag to filter by, then analyze those resources against all 5 WAF pillars.')">
                            <span class="prompt-icon">🏷️</span>
                            <span>WAF Review by Tag</span>
                        </div>
                    </div>
                </div>

                <!-- Networking Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('networking')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/networking/10061-icon-service-Virtual-Networks.svg" alt="Networking"></div>
                            <div class="category-name">Networking</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-networking">
                        <!-- Virtual Networks -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Virtual Networks (VNets) in my subscription with comprehensive details. Include: VNet Name, Resource Group, Location, Address Space, Subnet Count, Peering Count, DNS Servers (Custom/Azure Default), DDoS Protection, Tags. Show network topology overview.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10061-icon-service-Virtual-Networks.svg" style="width:16px;height:16px"></span>
                            <span>All Virtual Networks inventory</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show ALL Subnets across all VNets with details. Include: Subnet Name, VNet Name, Address Prefix, Available IPs, Used IPs, NSG Associated, Route Table, Service Endpoints, Private Endpoint Policies, Delegations. Identify subnets running low on IP addresses.')">
                            <span class="prompt-icon"><img src="/Icons/networking/02742-icon-service-Subnet.svg" style="width:16px;height:16px"></span>
                            <span>All Subnets with IP utilization</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show VNet Peering status across all VNets. Include: Source VNet, Target VNet, Peering Name, Peering State, Peering Sync Status, Allow Gateway Transit, Use Remote Gateway, Allow Forwarded Traffic, Cross-Subscription Peering. Identify any broken or disconnected peerings.')">
                            <span class="prompt-icon">🔗</span>
                            <span>VNet Peering status</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Analyze VNet address space conflicts and overlaps. Show: VNet pairs with overlapping address spaces, Impact on potential peering, RFC1918 compliance, Address space efficiency, Recommendations for re-addressing if needed.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>VNet address space conflicts</span>
                        </div>
                        <!-- Network Security Groups -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Network Security Groups (NSGs) with security analysis. Include: NSG Name, Resource Group, Location, Associated Subnets, Associated NICs, Total Rules, Allow Rules, Deny Rules, Any/Any Rules (RISK), Open Internet Ports, Security Score.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10067-icon-service-Network-Security-Groups.svg" style="width:16px;height:16px"></span>
                            <span>All NSGs with security analysis</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show NSGs with DANGEROUS rules allowing unrestricted access (0.0.0.0/0 or Any source). Include: NSG Name, Rule Name, Priority, Direction, Source (Any/Internet), Destination Port, Protocol, Risk Level, Associated Resources, Remediation Recommendation.')">
                            <span class="prompt-icon">🚨</span>
                            <span>NSGs with risky Any/Any rules</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show NSGs with sensitive ports exposed to internet (RDP 3389, SSH 22, SQL 1433, SMB 445, HTTP 80/443 without WAF). Include: NSG Name, Port, Protocol, Source Range, Risk Level, Best Practice Recommendation, Affected Resources.')">
                            <span class="prompt-icon">🔓</span>
                            <span>NSGs with exposed sensitive ports</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show orphaned NSGs not associated with any subnet or NIC. Include: NSG Name, Resource Group, Location, Rule Count, Created Date, Last Modified, Cost Impact, Cleanup Recommendation.')">
                            <span class="prompt-icon">📭</span>
                            <span>Orphaned NSGs</span>
                        </div>
                        <!-- Azure Firewall -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Azure Firewalls in my subscription. Include: Firewall Name, Resource Group, Location, SKU (Standard/Premium), Threat Intel Mode, DNS Proxy Status, Availability Zones, Public IPs, Associated VNet, Firewall Policy, SNAT Ranges.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10084-icon-service-Firewalls.svg" style="width:16px;height:16px"></span>
                            <span>All Azure Firewalls</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure Firewall rule analysis. Include: Firewall Name, Application Rules Count, Network Rules Count, NAT Rules Count, Rules allowing Any destination, Rules with broad source ranges, Threat Intel blocked requests (last 7 days), Optimization recommendations.')">
                            <span class="prompt-icon">🛡️</span>
                            <span>Azure Firewall rule analysis</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure Firewall throughput and health. Include: Firewall Name, Health State, Throughput (Gbps), SNAT Port Utilization, Firewall Latency, Application Rules Hit, Network Rules Hit, Threat Intel Hits, Recommendations for scaling.')">
                            <span class="prompt-icon">📊</span>
                            <span>Azure Firewall health & throughput</span>
                        </div>
                        <!-- Application Gateway -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Application Gateways in my subscription. Include: App Gateway Name, Resource Group, Location, SKU/Tier (Standard_v2/WAF_v2), Capacity (Instances/Autoscale), Frontend IPs (Public/Private), Backend Pools Count, HTTP Settings, Listeners, Health Probe Status.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10076-icon-service-Application-Gateways.svg" style="width:16px;height:16px"></span>
                            <span>All Application Gateways</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Application Gateway backend health. Include: App Gateway Name, Backend Pool Name, Backend Server, Health Status (Healthy/Unhealthy/Unknown), Probe Status, HTTP Settings, Last Probe Time, Unhealthy Reason, Remediation Steps.')">
                            <span class="prompt-icon">💚</span>
                            <span>App Gateway backend health</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Application Gateways WITHOUT WAF enabled. Include: App Gateway Name, Resource Group, Current SKU, WAF Status, Protected Applications, Risk Level, Recommendation to enable WAF, Estimated Cost Impact.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>App Gateways without WAF</span>
                        </div>
                        <!-- Web Application Firewall -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Web Application Firewall (WAF) policies. Include: WAF Policy Name, Resource Group, SKU, Mode (Detection/Prevention), Managed Rules, Custom Rules Count, Associated Resources (App Gateway/Front Door/CDN), Rule Groups Enabled.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10362-icon-service-Web-Application-Firewall-Policies(WAF).svg" style="width:16px;height:16px"></span>
                            <span>All WAF Policies</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show WAF policies in DETECTION mode (not blocking). Include: WAF Policy Name, Current Mode, Associated Resources, Last 7 Days Detections, Top Triggered Rules, Risk Assessment, Recommendation to switch to Prevention mode.')">
                            <span class="prompt-icon">🔍</span>
                            <span>WAF policies in Detection mode</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show WAF blocked requests analysis. Include: WAF Policy Name, Total Blocked Requests (24h/7d), Top 10 Blocked Rules, Top Source IPs, Top Blocked URLs, Anomaly Score Distribution, False Positive Candidates, Tuning Recommendations.')">
                            <span class="prompt-icon">🛡️</span>
                            <span>WAF blocked requests analysis</span>
                        </div>
                        <!-- Load Balancers -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Load Balancers in my subscription. Include: LB Name, Resource Group, Location, SKU (Basic/Standard), Type (Public/Internal), Frontend IP, Backend Pool Size, Health Probe Status, Load Balancing Rules Count, Outbound Rules.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10062-icon-service-Load-Balancers.svg" style="width:16px;height:16px"></span>
                            <span>All Load Balancers</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Load Balancers using BASIC SKU (deprecated features, no SLA). Include: LB Name, Resource Group, Backend Pool Members, Current Configuration, Migration Path to Standard SKU, Impact Assessment.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>Basic SKU Load Balancers</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Load Balancer backend pool health. Include: LB Name, Backend Pool Name, Total Instances, Healthy Instances, Unhealthy Instances, Health Probe Status, Probe Protocol/Port, Recommendations.')">
                            <span class="prompt-icon">💚</span>
                            <span>Load Balancer backend health</span>
                        </div>
                        <!-- Virtual WAN -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Virtual WANs and Hubs in my subscription. Include: vWAN Name, Resource Group, vWAN Type (Basic/Standard), Hub Count, Total Connections, ExpressRoute Gateways, VPN Gateways, Routing Status, Security Partner.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10353-icon-service-Virtual-WANs.svg" style="width:16px;height:16px"></span>
                            <span>All Virtual WANs</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Virtual WAN Hub details. Include: Hub Name, vWAN, Location, Hub Status, VNet Connections, VPN Site Connections, ExpressRoute Connections, Routing Tables, Effective Routes, Security Configuration.')">
                            <span class="prompt-icon"><img src="/Icons/networking/00860-icon-service-Virtual-WAN-Hub.svg" style="width:16px;height:16px"></span>
                            <span>Virtual WAN Hub details</span>
                        </div>
                        <!-- Public IPs -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Public IP Addresses in my subscription. Include: Public IP Name, Resource Group, IP Address, SKU (Basic/Standard), Assignment (Static/Dynamic), Associated Resource, Zone Redundancy, DDoS Protection, Idle Timeout.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10069-icon-service-Public-IP-Addresses.svg" style="width:16px;height:16px"></span>
                            <span>All Public IP Addresses</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show UNASSOCIATED (orphaned) Public IP Addresses. Include: Public IP Name, Resource Group, IP Address, SKU, Created Date, Monthly Cost, Recommendation (Delete or Associate).')">
                            <span class="prompt-icon">📭</span>
                            <span>Orphaned Public IPs</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Public IPs using BASIC SKU (no zone redundancy, limited features). Include: Public IP Name, Associated Resource, Current Usage, Migration Path to Standard SKU, Impact Assessment.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>Basic SKU Public IPs</span>
                        </div>
                        <!-- VPN & ExpressRoute -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL VPN Gateways in my subscription. Include: VPN Gateway Name, Resource Group, Location, SKU, Gateway Type, VPN Type (Route/Policy), Active-Active, BGP Enabled, Connections Count, Tunnel Status.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10063-icon-service-Virtual-Network-Gateways.svg" style="width:16px;height:16px"></span>
                            <span>All VPN Gateways</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show VPN Gateway connection status. Include: Gateway Name, Connection Name, Connection Type (S2S/P2S/VNet2VNet), Status (Connected/Disconnected), BGP Status, IKE Version, Shared Key Rotation Date, Tunnel Health.')">
                            <span class="prompt-icon">🔗</span>
                            <span>VPN connection status</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('List ALL ExpressRoute Circuits. Include: Circuit Name, Resource Group, Service Provider, Peering Location, Bandwidth, SKU Tier/Family, Circuit State, Provider State, Peerings (Private/Microsoft), Connected VNets.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10079-icon-service-ExpressRoute-Circuits.svg" style="width:16px;height:16px"></span>
                            <span>All ExpressRoute Circuits</span>
                        </div>
                        <!-- Route Tables & Network Watcher -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Route Tables (UDRs) with route analysis. Include: Route Table Name, Resource Group, Associated Subnets, Total Routes, System Routes, Custom Routes, Next Hop Types, BGP Route Propagation, Potential routing conflicts.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10082-icon-service-Route-Tables.svg" style="width:16px;height:16px"></span>
                            <span>All Route Tables (UDRs)</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show orphaned Route Tables not associated with any subnet. Include: Route Table Name, Resource Group, Route Count, Created Date, Recommendations.')">
                            <span class="prompt-icon">📭</span>
                            <span>Orphaned Route Tables</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Network Watcher status by region. Include: Region, Network Watcher Status (Enabled/Disabled), NSG Flow Logs Enabled, Connection Monitor, Traffic Analytics Status, Packet Capture capability, Recommendations.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10066-icon-service-Network-Watcher.svg" style="width:16px;height:16px"></span>
                            <span>Network Watcher status</span>
                        </div>
                        <!-- DDoS & Traffic Manager -->
                        <div class="prompt-item" onclick="quickPrompt('Show DDoS Protection status. Include: DDoS Protection Plans, Protected VNets, Protected Public IPs, Attack Metrics (last 30 days), Unprotected Resources, Cost Analysis, Protection Recommendations.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10072-icon-service-DDoS-Protection-Plans.svg" style="width:16px;height:16px"></span>
                            <span>DDoS Protection status</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('List ALL Traffic Manager profiles. Include: Profile Name, Resource Group, Routing Method, DNS Name, Monitoring Protocol, Endpoint Count, Endpoint Status, TTL, Traffic Analytics.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10065-icon-service-Traffic-Manager-Profiles.svg" style="width:16px;height:16px"></span>
                            <span>All Traffic Manager profiles</span>
                        </div>
                        <!-- Front Door -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Azure Front Door profiles. Include: Front Door Name, Resource Group, SKU (Standard/Premium), Endpoints, Origin Groups, Routing Rules, WAF Policy, Caching Enabled, Custom Domains, Health Status.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10073-icon-service-Front-Door-and-CDN-Profiles.svg" style="width:16px;height:16px"></span>
                            <span>All Azure Front Door profiles</span>
                        </div>
                        <!-- Network Security Best Practices -->
                        <div class="prompt-item" onclick="quickPrompt('Perform comprehensive network security assessment. Analyze: NSG rules for risky configurations, Public IP exposure, Missing WAF protection, Unencrypted traffic, Network segmentation gaps, DDoS protection gaps, Firewall rule gaps. Provide security score and prioritized recommendations.')">
                            <span class="prompt-icon">🔒</span>
                            <span>Network security assessment</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show network cost optimization opportunities. Include: Unused Public IPs, Oversized Gateways, Underutilized Load Balancers, Unnecessary NAT Gateways, Basic to Standard SKU migrations, Bandwidth optimization, Total potential monthly savings.')">
                            <span class="prompt-icon">💰</span>
                            <span>Network cost optimization</span>
                        </div>
                    </div>
                </div>

                <!-- Azure Private Link Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('privatelink')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/networking/00427-icon-service-Private-Link.svg" alt="Private Link"></div>
                            <div class="category-name">Azure Private Link</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-privatelink">
                        <!-- Private Endpoints Inventory -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Private Endpoints in my subscription with comprehensive details. Include: Private Endpoint Name, Resource Group, Location, Target Resource Type, Target Resource Name, Private IP Address, Subnet, VNet, Connection Status (Approved/Pending/Rejected), Custom DNS Config.')">
                            <span class="prompt-icon"><img src="/Icons/networking/00427-icon-service-Private-Link.svg" style="width:16px;height:16px"></span>
                            <span>All Private Endpoints inventory</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Private Endpoints grouped by target service type. Include: Service Type (Storage/SQL/KeyVault/etc), Count of Private Endpoints, Target Resources, Subnets Used, Connection States, Custom DNS Zones Associated.')">
                            <span class="prompt-icon">📊</span>
                            <span>Private Endpoints by service type</span>
                        </div>
                        <!-- Private Endpoint Connection Issues -->
                        <div class="prompt-item" onclick="quickPrompt('Show Private Endpoints with connection issues. Include: Private Endpoint Name, Target Resource, Connection State (Pending/Rejected/Disconnected), Manual Approval Required, Rejection Reason, Owner, Action Required, SLA Impact.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>Private Endpoints connection issues</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Private Endpoints pending approval. Include: Private Endpoint Name, Requesting Subscription, Target Resource, Target Subscription, Request Time, Approver Required, Business Justification, Approval Action URL.')">
                            <span class="prompt-icon">🕐</span>
                            <span>Private Endpoints pending approval</span>
                        </div>
                        <!-- PaaS Services Without Private Endpoints -->
                        <div class="prompt-item" onclick="quickPrompt('Show ALL PaaS resources that SUPPORT Private Endpoints but do NOT have them configured. Include: Resource Name, Resource Type, Resource Group, Location, Current Network Access (Public), Private Endpoint Supported, Risk Level, Implementation Priority, Private Endpoint Recommendation.')">
                            <span class="prompt-icon">🔓</span>
                            <span>PaaS without Private Endpoints</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Storage Accounts without Private Endpoints. Include: Storage Account Name, Resource Group, Public Network Access, Firewall Rules, Services (Blob/File/Queue/Table), Risk Assessment, Private Endpoint Recommendation per service.')">
                            <span class="prompt-icon">💾</span>
                            <span>Storage without Private Endpoints</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show SQL Databases/Servers without Private Endpoints. Include: SQL Server Name, Databases, Resource Group, Public Network Access, Firewall Rules, Connection Policy, Risk Level, Private Endpoint Recommendation.')">
                            <span class="prompt-icon">🗄️</span>
                            <span>SQL without Private Endpoints</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Key Vaults without Private Endpoints. Include: Key Vault Name, Resource Group, Public Network Access status, Firewall Rules, Secrets Count, Keys Count, Risk Level, Private Endpoint Recommendation.')">
                            <span class="prompt-icon">🔐</span>
                            <span>Key Vaults without Private Endpoints</span>
                        </div>
                        <!-- Private Link Services -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Private Link Services (for exposing your own services). Include: Private Link Service Name, Resource Group, Location, Load Balancer, Frontend IP, NAT IP Configurations, Auto-Approval Subscriptions, Visibility, Connected Private Endpoints.')">
                            <span class="prompt-icon"><img src="/Icons/networking/02209-icon-service-Private-Link-Services.svg" style="width:16px;height:16px"></span>
                            <span>All Private Link Services</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Private Link Service connection requests. Include: Service Name, Requesting Private Endpoint, Requesting Subscription, Connection State, Request Message, Approval Status, Auto-Approved, Timestamp.')">
                            <span class="prompt-icon">📬</span>
                            <span>Private Link Service connections</span>
                        </div>
                        <!-- Network Integration -->
                        <div class="prompt-item" onclick="quickPrompt('Show Private Endpoint network integration status. Include: Private Endpoint Name, VNet, Subnet, Private IP, DNS Resolution Status, Custom DNS Configured, Private DNS Zone Linked, Network Connectivity Test Result.')">
                            <span class="prompt-icon">🌐</span>
                            <span>Private Endpoint network integration</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show VNets with high Private Endpoint density. Include: VNet Name, Subnet Name, Subnet Size, Total IPs, Used by Private Endpoints, Available IPs, Utilization %, Subnet Expansion Recommendation.')">
                            <span class="prompt-icon">📈</span>
                            <span>VNet Private Endpoint density</span>
                        </div>
                        <!-- Security & Compliance -->
                        <div class="prompt-item" onclick="quickPrompt('Perform Private Link security assessment. Analyze: Resources with public access that should use Private Endpoints, Missing Private DNS zone configurations, Cross-subscription Private Endpoint risks, Private Endpoint policy vulnerabilities. Provide security score and recommendations.')">
                            <span class="prompt-icon">🛡️</span>
                            <span>Private Link security assessment</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Private Endpoint DNS configuration audit. Include: Private Endpoint Name, Target Service, Expected DNS Zone, Actual DNS Zone, DNS Resolution Test, A Record Exists, FQDN Resolution, Configuration Issues, Fix Required.')">
                            <span class="prompt-icon">🔧</span>
                            <span>Private Endpoint DNS audit</span>
                        </div>
                    </div>
                </div>

                <!-- Private DNS Zones Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('privatedns')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/networking/10064-icon-service-DNS-Zones.svg" alt="Private DNS"></div>
                            <div class="category-name">Private DNS Zones</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-privatedns">
                        <!-- DNS Zone Inventory -->
                        <div class="prompt-item" onclick="quickPrompt('List ALL Private DNS Zones in my subscription. Include: Zone Name, Resource Group, Record Sets Count, VNet Links Count, Auto-Registration Enabled VNets, SOA Record, Tags. Group by DNS zone type (Azure services vs custom).')">
                            <span class="prompt-icon"><img src="/Icons/networking/10064-icon-service-DNS-Zones.svg" style="width:16px;height:16px"></span>
                            <span>All Private DNS Zones inventory</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Private DNS Zones for Azure services (privatelink.* zones). Include: Zone Name, Associated Service Type, Record Count, VNet Links, Private Endpoints Using Zone, Auto-Registration Status.')">
                            <span class="prompt-icon">🔗</span>
                            <span>Azure Private Link DNS Zones</span>
                        </div>
                        <!-- DNS Zone Issues -->
                        <div class="prompt-item" onclick="quickPrompt('CRITICAL: Find DUPLICATE Private DNS Zones for the same Azure service across subscriptions. Scan ALL subscriptions and show: Zone Name (e.g., privatelink.blob.core.windows.net), Subscription 1: Zone details + VNet Links, Subscription 2: Zone details + VNet Links, Conflicting Configurations, Resolution Priority, Recommended Action (Consolidate/Delete).')">
                            <span class="prompt-icon">🚨</span>
                            <span>Duplicate DNS Zones across subscriptions</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show MISSING required Private DNS Zones for Azure services. Compare: Private Endpoints deployed vs Required Private DNS Zones. Show: Missing Zone Name, Service Type, Affected Private Endpoints, Impact (DNS Resolution will fail), Creation Priority, Zone Configuration Template.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>Missing required DNS Zones</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Private DNS Zones with MISSING VNet Links. Include: Zone Name, Purpose, Record Count, Expected VNets (where Private Endpoints exist), Linked VNets, Missing VNet Links, Impact of Missing Links, Recommendation.')">
                            <span class="prompt-icon">🔗</span>
                            <span>DNS Zones with missing VNet links</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Private DNS Zones NOT linked to any VNet (orphaned). Include: Zone Name, Resource Group, Record Count, Created Date, Last Modified, Purpose Unknown, Cleanup Recommendation.')">
                            <span class="prompt-icon">📭</span>
                            <span>Orphaned Private DNS Zones</span>
                        </div>
                        <!-- DNS Record Analysis -->
                        <div class="prompt-item" onclick="quickPrompt('Show stale DNS records in Private DNS Zones (records pointing to deleted resources). Include: Zone Name, Record Name, Record Type, Record Value (IP), Target Resource Status (Deleted/Not Found), Record Age, Cleanup Recommendation.')">
                            <span class="prompt-icon">🗑️</span>
                            <span>Stale DNS records</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Private DNS Zones record distribution. Include: Zone Name, Total Records, A Records, AAAA Records, CNAME Records, PTR Records, SOA Records, Other Records, Largest Zones by Record Count.')">
                            <span class="prompt-icon">📊</span>
                            <span>DNS record distribution</span>
                        </div>
                        <!-- VNet Link Analysis -->
                        <div class="prompt-item" onclick="quickPrompt('Show VNet Link status across all Private DNS Zones. Include: Zone Name, VNet Link Name, VNet Name, Link Status (Completed/InProgress/Failed), Auto-Registration Enabled, Registration VNets, Provisioning State Issues.')">
                            <span class="prompt-icon">🌐</span>
                            <span>VNet Link status analysis</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show VNets with Auto-Registration enabled across multiple DNS Zones. Include: VNet Name, DNS Zones with Auto-Registration, Potential Conflicts, Record Overlap Risk, Best Practice Assessment.')">
                            <span class="prompt-icon">📋</span>
                            <span>VNets with auto-registration</span>
                        </div>
                        <!-- DNS Resolution Issues -->
                        <div class="prompt-item" onclick="quickPrompt('Analyze Private DNS resolution chain. For each Private Endpoint show: Service FQDN, Expected DNS Zone, Zone Exists, VNet Linked, A Record Exists, IP Address, Resolution Test Status, Issues Found, Fix Required.')">
                            <span class="prompt-icon">🔍</span>
                            <span>DNS resolution chain analysis</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show common Private DNS Zone issues and misconfigurations. Check: Missing zones for Private Endpoints, Multiple zones for same service, Missing VNet links, Auto-registration conflicts, Stale records, Cross-subscription zone sprawl. Provide remediation steps.')">
                            <span class="prompt-icon">🛠️</span>
                            <span>Common DNS Zone issues</span>
                        </div>
                        <!-- Best Practices -->
                        <div class="prompt-item" onclick="quickPrompt('Show Private DNS Zone best practices compliance. Check: Centralized zone management, Hub VNet zone hosting, Spoke VNet linking, Auto-registration usage, Zone naming conventions, Record TTL settings, Zone redundancy, Documentation. Score and recommend.')">
                            <span class="prompt-icon">✅</span>
                            <span>DNS Zone best practices</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Generate Private DNS Zone architecture recommendation. Based on current deployment: Hub-Spoke topology detection, Recommended zone placement, VNet linking strategy, Auto-registration guidance, Cross-subscription considerations, Terraform/Bicep template for optimal setup.')">
                            <span class="prompt-icon">🏗️</span>
                            <span>DNS Zone architecture recommendation</span>
                        </div>
                    </div>
                </div>

                                <!-- Virtual Machines Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('virtualmachines')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/compute/10021-icon-service-Virtual-Machine.svg" alt="Virtual Machines"></div>
                            <div class="category-name">Virtual Machines</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-virtualmachines">
                        <div class="prompt-item" onclick="quickPrompt('List ALL Virtual Machines in my subscription. Include: VM Name, Resource Group, Location, VM Size, OS Type, Power State, Private IP, Public IP, Availability Zone, Availability Set, Tags.')">
                            <span class="prompt-icon">💻</span>
                            <span>All VMs inventory</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find VMs STOPPED for 30+ days. Include: VM Name, Resource Group, VM Size, Days Stopped, Monthly Cost When Running.')">
                            <span class="prompt-icon">💤</span>
                            <span>VMs stopped 30+ days</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find VMs WITHOUT Azure Backup enabled. Include: VM Name, Resource Group, OS Type, Backup Status, Risk Level.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>VMs without backup</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find stopped VMs with PREMIUM SSD disks still incurring costs. Include: VM Name, Days Stopped, Premium Disk Details, Monthly Wasted Cost.')">
                            <span class="prompt-icon">💰</span>
                            <span>Stopped VMs with Premium disks</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find VMs using Standard HDD disks. Include: VM Name, Disk Name, Disk Type, Size, Performance Impact, Upgrade Recommendation.')">
                            <span class="prompt-icon">💿</span>
                            <span>VMs with HDD disks</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find VMs WITHOUT Azure Monitor Agent installed. Include: VM Name, OS Type, Agent Status, Monitoring Gap.')">
                            <span class="prompt-icon">📊</span>
                            <span>VMs without Azure Monitor Agent</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find VMs WITHOUT Guest Agent or with unhealthy agent. Include: VM Name, Guest Agent Status, Last Heartbeat, Remediation.')">
                            <span class="prompt-icon">🤖</span>
                            <span>VMs without Guest Agent</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find VMs with NO REDUNDANCY - not in Availability Zone and not in Availability Set. Include: VM Name, Location, SLA Impact, Recommendation.')">
                            <span class="prompt-icon">🎯</span>
                            <span>VMs without redundancy</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show VMs in Availability Sets. Include: Availability Set Name, Fault Domains, Update Domains, VM Count, VM Names.')">
                            <span class="prompt-icon">📦</span>
                            <span>VMs in Availability Sets</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show VMs by Availability Zone. Include: Zone Number, VM Count, VM Names, Cross-Zone Distribution.')">
                            <span class="prompt-icon">🌐</span>
                            <span>VMs by Availability Zone</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find VMs with PUBLIC IP directly attached. Include: VM Name, Public IP, Associated NSG, Open Ports, Security Risk.')">
                            <span class="prompt-icon">🌍</span>
                            <span>VMs with public IPs</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find VMs WITHOUT NSG protection. Include: VM Name, NIC, Subnet, NSG Status, Risk Level.')">
                            <span class="prompt-icon">🔓</span>
                            <span>VMs without NSG</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find VMs with pending CRITICAL patches. Include: VM Name, OS Type, Critical Patches, Security Patches, Last Patch Date.')">
                            <span class="prompt-icon">🔧</span>
                            <span>VMs with pending patches</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find OVERSIZED VMs with low CPU/Memory usage. Include: VM Name, Current Size, Avg CPU, Avg Memory, Recommended Size, Savings.')">
                            <span class="prompt-icon">📉</span>
                            <span>Oversized VMs (right-sizing)</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find VMs with HIGH CPU over 80 percent. Include: VM Name, Size, vCPUs, Avg CPU, Peak CPU, Recommendation.')">
                            <span class="prompt-icon">🔥</span>
                            <span>VMs with high CPU</span>
                        </div>
                    </div>
                </div>
                <!-- Resource Management Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('resources')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/general/10001-icon-service-All-Resources.svg" alt="Resources"></div>
                            <div class="category-name">Resource Management</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-resources">
                        <div class="prompt-item" onclick="quickPrompt('List ALL resources in my current subscription with comprehensive details. Show table with columns: Resource Name, Resource Type, Resource Group, Subscription, Location, SKU/Size, Status, Tags. Include all resource properties available. Do not show any imaginary or placeholder values - only actual data from Azure.')">
                            <span class="prompt-icon">📋</span>
                            <span>All resources (full inventory)</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('I want to filter Azure resources. Present these filtering options with numbered choices: 1) Filter by Resource Group (ask which), 2) Filter by Resource Type (ask which type), 3) Filter by Location/Region (ask which), 4) Filter by Tag (ask tag name and value), 5) Filter by Subscription (if multiple). Wait for my selection, then show results in a table with: Resource Name, Type, Resource Group, Location, SKU, Status, Tags.')">
                            <span class="prompt-icon">🔍</span>
                            <span>Filter resources by criteria</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show me a summary of resources grouped by type. Include: Resource Type, Count, Primary Locations, Common Tags. Help me understand my resource distribution.')">
                            <span class="prompt-icon">📊</span>
                            <span>Resource inventory summary</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Search for resources by name. Ask me what name or partial name to search for, then show matching resources with: Resource Name, Type, Resource Group, Location, Subscription, Status.')">
                            <span class="prompt-icon">🔎</span>
                            <span>Search resources by name</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show ALL Virtual Machines in my subscription with details: VM Name, Resource Group, Location, VM Size, OS Type, Power State, Private IP, Public IP (if any), Tags. Only show actual Azure data.')">
                            <span class="prompt-icon">💻</span>
                            <span>List all Virtual Machines</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show ALL Storage Accounts in my subscription with: Name, Resource Group, Location, SKU, Access Tier, Public Access status, Private Endpoint status, Replication Type, Tags.')">
                            <span class="prompt-icon">💾</span>
                            <span>List all Storage Accounts</span>
                        </div>
                    </div>
                </div>

                <!-- Cost Optimization Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('cost')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/general/10019-icon-service-Cost-Management.svg" alt="Cost"></div>
                            <div class="category-name">Cost Optimization</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-cost">
                        <div class="prompt-item" onclick="quickPrompt('Show my current month Azure costs breakdown. Include: Total Cost, Cost by Service, Cost by Resource Group, Top 10 most expensive resources with ACTUAL resource names and costs from Azure Cost Management. Do not show any placeholder or estimated values.')">
                            <span class="prompt-icon">📊</span>
                            <span>Current month costs overview</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Compare my Azure costs: Show this week vs last week, and this month vs last month comparison. Include: Period, Total Cost, Change (%), Top changing services, Resources with biggest cost increase. Use actual data from Azure Cost Management.')">
                            <span class="prompt-icon">📈</span>
                            <span>Compare costs (week/month)</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show my Azure cost trends for the last 3 months. Include monthly totals, cost by service category, and identify any unusual spending patterns or anomalies.')">
                            <span class="prompt-icon">📆</span>
                            <span>Cost trends (last 3 months)</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('I want to analyze costs by category. Present options: 1) By Subscription, 2) By Resource Group, 3) By Tag (CostCenter/Department/Environment), 4) By Service type, 5) By Location. Wait for my selection then show detailed breakdown with ACTUAL costs.')">
                            <span class="prompt-icon">🏷️</span>
                            <span>Costs by category/tag</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find all cost savings opportunities in my subscription. Show ACTUAL resource names with: Resource Name, Type, Current Monthly Cost, Issue (deallocated VM/orphaned disk/unattached IP/oversized), Recommended Action, Potential Monthly Savings. Calculate total potential savings.')">
                            <span class="prompt-icon">💡</span>
                            <span>Cost savings opportunities</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure Advisor cost recommendations for my subscription. Include: Recommendation, Affected Resource, Impact Level, Estimated Monthly Savings, Implementation Steps. Only show actual recommendations from Azure Advisor.')">
                            <span class="prompt-icon">🎯</span>
                            <span>Azure Advisor cost recommendations</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('I want cost advisories at a specific level. Ask me: 1) Subscription level, 2) Resource Group level (ask which RG), 3) Resource level (ask which resource). Then show cost analysis and optimization recommendations for that scope.')">
                            <span class="prompt-icon">🔍</span>
                            <span>Cost advisories by scope</span>
                        </div>
                    </div>
                </div>

                <!-- Security & Compliance Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('security')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/security/10241-icon-service-Microsoft-Defender-for-Cloud.svg" alt="Security"></div>
                            <div class="category-name">Security & Compliance</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-security">
                        <div class="prompt-item" onclick="quickPrompt('Show Microsoft Defender for Cloud security recommendations for my subscription. Include: Recommendation, Severity (Critical/High/Medium/Low), Affected Resources Count, Category (Compute/Network/Data/Identity), Remediation Steps. Only show actual recommendations from Defender for Cloud.')">
                            <span class="prompt-icon">🛡️</span>
                            <span>Defender for Cloud recommendations</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure Policy compliance status. I want to choose the scope: 1) Subscription level, 2) Resource Group level (ask which), 3) Resource level (ask which). Then show: Resource Name, Resource Type, Location, Resource Group, Compliance Status, Policy Name, Assignment Name, Last Evaluation Date. Only show actual policy compliance data.')">
                            <span class="prompt-icon">📜</span>
                            <span>Policy compliance by scope</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show all resources with PUBLIC ACCESS enabled. Include: Resource Name, Resource Type, Resource Group, Location, Public Access Type, Risk Level, Recommendation. Focus on Storage Accounts, SQL Servers, Key Vaults, Web Apps, and any PaaS service with public endpoint.')">
                            <span class="prompt-icon">🌐</span>
                            <span>Resources with public access</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show PaaS resources that are ELIGIBLE for Private Endpoints but do NOT have Private Endpoints configured. Include: Resource Name, Resource Type, Resource Group, Location, Current Network Access, Risk Level, Private Endpoint Recommendation.')">
                            <span class="prompt-icon">🔐</span>
                            <span>PaaS without Private Endpoints</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Review Network Security Groups (NSGs) security. Show: NSG Name, Associated Resources, Total Rules, Risky Rules (Any/Any or 0.0.0.0/0), Open Sensitive Ports (RDP 3389, SSH 22, SQL 1433), Risk Level, Recommendations.')">
                            <span class="prompt-icon">🌐</span>
                            <span>NSG security review</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show VMs without backup configured in Azure Backup. Include: VM Name, Resource Group, Location, Backup Status, Risk Level, Recommendation. Help me identify VMs that need backup protection.')">
                            <span class="prompt-icon">💾</span>
                            <span>VMs without backup</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show security compliance summary. Categorize findings by: 1) Defender for Cloud issues, 2) Azure Policy non-compliance, 3) Network security issues, 4) Data protection gaps. Include count and severity for each category.')">
                            <span class="prompt-icon">📊</span>
                            <span>Security compliance summary</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show security score breakdown by security control. Include: Control Name, Current Score, Max Score, Percentage, Healthy Resource Count, Unhealthy Resource Count.')">
                            <span class="prompt-icon">🎯</span>
                            <span>Security score breakdown</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show active security alerts from Microsoft Defender for Cloud. Include: Alert Name, Severity, Status, Affected Resource, Description.')">
                            <span class="prompt-icon">🚨</span>
                            <span>Active security alerts</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show regulatory compliance assessment status. Include compliance with standards like PCI DSS, ISO 27001, SOC 2, HIPAA.')">
                            <span class="prompt-icon">📋</span>
                            <span>Regulatory compliance status</span>
                        </div>
                    </div>
                </div>

                <!-- Azure Policy Compliance Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('policy')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/management + governance/10316-icon-service-Policy.svg" alt="Policy"></div>
                            <div class="category-name">Azure Policy & Governance</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-policy">
                        <div class="prompt-item" onclick="quickPrompt('Show Azure Policy compliance dashboard. Include: Policy Assignment Name, Definition Name, Compliance State, Compliant Resources, Non-Compliant Resources, Compliance %, Scope, Enforcement Mode. Only show actual data from Azure Policy.')">
                            <span class="prompt-icon">📊</span>
                            <span>Policy compliance dashboard</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show non-compliant resources with policy details. Include: Resource Name, Resource Type, Location, Resource Group, Subscription, Compliance Status, Policy Name, Assignment Name, Last Evaluation Date, Remediation Available. Only show actual Azure data.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>Non-compliant resources</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show all policies that are NOT compliant (have non-compliant resources). Include: Policy Name, Non-Compliant Count, Severity, Category, Enforcement Mode, Remediation Type, Priority to Fix.')">
                            <span class="prompt-icon">❌</span>
                            <span>Policies not compliant</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show actual Azure Policy exemptions. Include: Exemption Name, Scope/Level of Exemption, Creation Date, Created By (if available), Expiration Date, Exemption Category, Policy Being Exempted, Justification/Description. Only show real exemptions from Azure, no placeholder data.')">
                            <span class="prompt-icon">🚫</span>
                            <span>Policy exemptions audit</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show policy compliance by scope. Ask me: 1) Subscription level, 2) Resource Group level (ask which), 3) Management Group level. Then show policies affecting that scope with compliance status.')">
                            <span class="prompt-icon">🔍</span>
                            <span>Policy compliance by scope</span>
                        </div>
                    </div>
                </div>

                <!-- Monitoring & Alerts Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('monitoring')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/management + governance/00001-icon-service-Monitor.svg" alt="Monitoring"></div>
                            <div class="category-name">Monitoring & Alerts</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-monitoring">
                        <div class="prompt-item" onclick="quickPrompt('Show ALL active alerts in my subscription. I want to filter by: 1) Subscription level, 2) Resource Group level (ask which), 3) Resource level (ask which). Show: Alert Name, Severity, Resource, Triggered Time, Status, Description. Group by severity (Critical first).')">
                            <span class="prompt-icon">🔔</span>
                            <span>Active alerts (with filters)</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Virtual Machines NOT enabled for Azure Monitor (missing Azure Monitor Agent or Log Analytics extension). Include: VM Name, Resource Group, OS Type, Power State, Agent Status, Recommendation.')">
                            <span class="prompt-icon">💻</span>
                            <span>VMs without Azure Monitor</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure Arc machines NOT enabled for Azure Monitor. Include: Machine Name, Resource Group, OS Type, Agent Status, Azure Monitor Extension Status, Recommendation.')">
                            <span class="prompt-icon">🌐</span>
                            <span>Arc machines without Azure Monitor</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Virtual Machines NOT enabled for VM Insights. Include: VM Name, Resource Group, OS Type, Power State, VM Insights Status, Dependency Agent Status, Recommendation.')">
                            <span class="prompt-icon">📊</span>
                            <span>VMs without VM Insights</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure Arc machines NOT enabled for VM Insights. Include: Machine Name, Resource Group, OS Type, Status, VM Insights Status, Recommendation.')">
                            <span class="prompt-icon">📈</span>
                            <span>Arc machines without VM Insights</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Virtual Machines NOT enabled for Dependency Agent/extensions. Include: VM Name, Resource Group, OS Type, Dependency Agent Status, Map Feature Status, Recommendation.')">
                            <span class="prompt-icon">🔗</span>
                            <span>VMs without Dependency Agent</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure Arc machines NOT enabled for Dependency monitoring. Include: Machine Name, Resource Group, Status, Dependency Extension Status, Recommendation.')">
                            <span class="prompt-icon">🔗</span>
                            <span>Arc without Dependency Agent</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Virtual Machines NOT enabled for Change Tracking. Include: VM Name, Resource Group, OS Type, Change Tracking Status, Automation Account Association, Recommendation.')">
                            <span class="prompt-icon">📝</span>
                            <span>VMs without Change Tracking</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure Arc machines NOT enabled for Change Tracking. Include: Machine Name, Resource Group, OS Type, Status, Change Tracking Status, Recommendation.')">
                            <span class="prompt-icon">📝</span>
                            <span>Arc without Change Tracking</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Virtual Machine Scale Sets NOT enabled for monitoring. Include: VMSS Name, Resource Group, Instance Count, Monitoring Status, Diagnostics Status, Recommendation.')">
                            <span class="prompt-icon">⚖️</span>
                            <span>VMSS without monitoring</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show AKS clusters NOT enabled for monitoring (Container Insights). Include: AKS Name, Resource Group, Node Count, Monitoring Status, Log Analytics Workspace, Recommendation.')">
                            <span class="prompt-icon">☸️</span>
                            <span>AKS without monitoring</span>
                        </div>
                    </div>
                </div>

                <!-- Azure Backup Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('backup')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/storage/00017-icon-service-Recovery-Services-Vaults.svg" alt="Backup"></div>
                            <div class="category-name">Azure Backup</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-backup">
                        <div class="prompt-item" onclick="quickPrompt('Show Virtual Machines ENABLED with Azure Backup. Include: VM Name, Resource Group, Location, Backup Vault, Policy Name, Last Backup Date, Backup Status, Recovery Points, Protection State.')">
                            <span class="prompt-icon">✅</span>
                            <span>VMs with backup enabled</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Virtual Machines NOT ENABLED with Azure Backup. Include: VM Name, Resource Group, Location, OS Type, Power State, Created Date, Risk Level, Backup Recommendation.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>VMs without backup</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure File Shares enabled for backup. Include: File Share Name, Storage Account, Resource Group, Backup Vault, Policy Name, Last Backup, Backup Status, Protected Size.')">
                            <span class="prompt-icon">📁</span>
                            <span>File Shares with backup</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure File Shares NOT enabled for backup. Include: File Share Name, Storage Account, Resource Group, Size, Protocol, Created Date, Risk Assessment, Backup Recommendation.')">
                            <span class="prompt-icon">📂</span>
                            <span>File Shares without backup</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Managed Disks enabled for backup using Backup Vault. Include: Disk Name, Resource Group, Disk Type, Size GB, Backup Vault, Policy, Last Backup Date, Backup Status.')">
                            <span class="prompt-icon">💿</span>
                            <span>Managed Disks with backup</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Managed Disks NOT enabled for Azure Backup. Include: Disk Name, Resource Group, Disk Type, Size GB, Attached VM, OS/Data Disk, Created Date, Backup Recommendation.')">
                            <span class="prompt-icon">💽</span>
                            <span>Managed Disks without backup</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Shared Disks (multi-attach enabled). Include: Disk Name, Resource Group, Disk Type, Size GB, Max Shares, Attached VMs, Location, Backup Considerations.')">
                            <span class="prompt-icon">🔗</span>
                            <span>Shared disks inventory</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Storage Account Blobs enabled for backup. Include: Storage Account, Resource Group, Backup Vault, Containers Protected, Policy Name, Last Backup, Retention Days.')">
                            <span class="prompt-icon">📦</span>
                            <span>Blob backup status</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure SQL Databases enabled for long-term backup retention. Include: Database Name, Server, Resource Group, Backup Type, Retention Policy, Last Backup, Recovery Point Oldest/Latest.')">
                            <span class="prompt-icon">🗄️</span>
                            <span>SQL databases backup status</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show SQL Managed Instances backup status. Include: Instance Name, Resource Group, Backup Type (Full/Diff/Log), Retention Days, Last Backup, Geo-Redundant Backup, Recovery Point Status.')">
                            <span class="prompt-icon">🏛️</span>
                            <span>SQL MI backup status</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show summary of all Backup Vaults and Recovery Services Vaults. Include: Vault Name, Vault Type, Resource Group, Location, Protected Items Count, Backup Policies, Storage Redundancy, Soft Delete Enabled.')">
                            <span class="prompt-icon">🏦</span>
                            <span>Backup vaults summary</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show failed backup jobs in the last 7 days. Include: Job ID, Protected Item, Vault, Job Type, Start Time, End Time, Error Code, Error Message, Retry Recommendation.')">
                            <span class="prompt-icon">❌</span>
                            <span>Failed backup jobs</span>
                        </div>
                    </div>
                </div>

                <!-- Update Management Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('updates')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/compute/00195-icon-service-Maintenance-Configuration.svg" alt="Updates"></div>
                            <div class="category-name">Update Management</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-updates">
                        <div class="prompt-item" onclick="quickPrompt('Show Azure VMs pending updates from Azure Update Manager. Include: VM Name, Resource Type, OS Type, Private IP, Resource Group, Subscription, Power State (Online/Offline), Pending Patches (Critical/Security/Other), Last Patch Installation Date. Get actual data from Update Manager.')">
                            <span class="prompt-icon">💻</span>
                            <span>VM pending updates</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure Arc machines pending updates from Azure Update Manager. Include: Machine Name, Resource Type, OS Type, IP Address, Resource Group, Subscription, Status (Online/Offline), Pending Patches (Critical/Security/Other), Last Patch Installation Date.')">
                            <span class="prompt-icon">🌐</span>
                            <span>Arc machine pending updates</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show update compliance summary for ALL machines (Azure VMs and Arc servers) from Update Manager. Include: Machine Type, Total Count, Fully Updated, Pending Critical, Pending Security, Pending Other, Reboot Required, Compliance %, Last Assessment Date. Calculate overall compliance score.')">
                            <span class="prompt-icon">📊</span>
                            <span>Update compliance summary</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show VMs requiring reboot after patch installation. Include: VM Name, Resource Type, OS Type, Resource Group, Reboot Reason, Pending Updates Requiring Reboot, Last Boot Time, Uptime Days, Priority Level.')">
                            <span class="prompt-icon">🔄</span>
                            <span>VMs pending reboot</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Arc servers requiring reboot. Include: Server Name, Resource Type, OS Type, Resource Group, Status, Reboot Reason, Last Boot Time, Priority Level.')">
                            <span class="prompt-icon">🔁</span>
                            <span>Arc servers pending reboot</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show machines with failed update installations. Include: Machine Name, Type, Resource Group, Failed Update Name, Failure Reason, Attempted Date, Retry Count, Recommended Action, Impact Level.')">
                            <span class="prompt-icon">❌</span>
                            <span>Failed update installations</span>
                        </div>
                    </div>
                </div>

                <!-- Tags Management Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('tags')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/general/10014-icon-service-Tag.svg" alt="Tags"></div>
                            <div class="category-name">Tags Management</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-tags">
                        <div class="prompt-item" onclick="quickPrompt('Show high-level tag inventory across my Azure environment. Include: Tag Name, Total Resources Using Tag, Unique Values Count, Most Common Values, Resource Types with Tag, Usage Percentage. Help me understand tag adoption across my subscription.')">
                            <span class="prompt-icon">📊</span>
                            <span>Tag inventory overview</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('I want to search resources by tag. Ask me to provide the tag name and optionally the value. Support different formats like: Environment=Production, tag:Environment Production, or just Environment:Production. Then show matching resources with: Resource Name, Type, Resource Group, Location, All Tags, Status.')">
                            <span class="prompt-icon">🔍</span>
                            <span>Search by tag (smart search)</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show resources MISSING required tags. Check for resources that SUPPORT tagging but do not have: Environment, CostCenter, Owner/ApplicationOwner tags. Include: Resource Name, Type, Resource Group, Location, Existing Tags, Missing Tags, Tagging Supported.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>Resources missing tags</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show tag compliance analysis. For each required tag (Environment, CostCenter, Owner), show: Tag Name, Compliant Resources, Non-Compliant Resources, Compliance %, Top Non-Compliant Resource Types. Calculate overall tag compliance score.')">
                            <span class="prompt-icon">✅</span>
                            <span>Tag compliance analysis</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show all unique tag values for a specific tag. Ask me which tag to analyze (e.g., Environment, CostCenter, Department), then show: Tag Value, Resource Count, Resource Types, Primary Locations.')">
                            <span class="prompt-icon">📋</span>
                            <span>Tag values breakdown</span>
                        </div>
                    </div>
                </div>

                <!-- Azure Arc / Hybrid Management Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('arc')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/management + governance/00756-icon-service-Azure-Arc.svg" alt="Azure Arc"></div>
                            <div class="category-name">Azure Arc Management</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-arc">
                        <div class="prompt-item" onclick="quickPrompt('Show me ALL Azure Arc-enabled machines in my current subscription. Provide table: Machine Name, Resource Group, Subscription, OS Type, OS Version, Agent Status, Agent Version, Defender Status, Monitoring Status, Pending Updates, Last Status Change, Location, Compliance Status. Sort by compliance status.')">
                            <span class="prompt-icon">💻</span>
                            <span>Arc-enabled machines</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show me ALL Azure Arc-enabled SQL Servers in my current subscription. Provide table: SQL Server Name, Resource Group, SQL Version, Edition, Location, Database Count, Status, Patch Level, License Type, Last Inventory Upload, Compliance Status. Sort by SQL Server name.')">
                            <span class="prompt-icon">🗄️</span>
                            <span>Arc-enabled SQL Servers</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show me ALL Azure Arc machines with agent not reporting or disconnected in my current subscription. Provide table: Machine Name, Resource Group, OS Type, Agent Status, Agent Version, Last Status Change, Days Since Last Report, Location, Issue Level, Recommended Action. Sort by days since last report descending.')">
                            <span class="prompt-icon">⚠️</span>
                            <span>Arc agents not reporting</span>
                        </div>
                    </div>
                </div>

                <!-- AI & Automation Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('automation')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/management + governance/00022-icon-service-Automation-Accounts.svg" alt="Automation"></div>
                            <div class="category-name">AI & Automation</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-automation">
                        <div class="prompt-item" onclick="quickPrompt('Analyze my current subscription for automation opportunities focusing on ALL areas (Deployment, Backup, Scaling, Patching, Monitoring). Provide table: Task/Process, Current Method, Frequency, Time Spent per Week, Automation Tool Recommendation (Azure Automation/Logic Apps/Functions), Implementation Steps, Time Savings, Cost Savings, ROI %.')">
                            <span class="prompt-icon">💡</span>
                            <span>Automation suggestions</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('I want to set up auto-scaling. Ask me: 1) Which resource (VM Scale Set/App Service/AKS)? 2) Resource group? 3) Scaling metric (CPU/Memory/Requests)? 4) Min/Max instances? Then configure auto-scaling rules.')">
                            <span class="prompt-icon">📈</span>
                            <span>Auto-scaling rules</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('I want to generate Infrastructure as Code. Ask me: 1) Template type (ARM/Bicep/Terraform)? 2) Which resources to include? 3) Export existing or create new? Then generate the template with best practices.')">
                            <span class="prompt-icon">📄</span>
                            <span>Generate IaC template</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Analyze ALL resources in my current subscription for the last 30 days using AI-driven optimization. Show table: Resource Name, Current SKU, Usage Pattern Analysis, AI-Recommended SKU, Performance Impact, Cost Impact $/month, Confidence %, Risk Level, Implementation Priority. Include total potential savings.')">
                            <span class="prompt-icon">🎯</span>
                            <span>AI optimization</span>
                        </div>
                    </div>
                </div>

                <!-- Azure Kubernetes Service Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('aks')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/compute/10023-icon-service-Kubernetes-Services.svg" alt="AKS"></div>
                            <div class="category-name">Azure Kubernetes (AKS)</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-aks">
                        <div class="prompt-item" onclick="quickPrompt('List ALL AKS clusters in my subscription. Include: Cluster Name, Resource Group, Location, Kubernetes Version, Node Pools, Total Nodes, Status, Network Plugin, Monitoring Status.')">
                            <span class="prompt-icon">📋</span>
                            <span>List all AKS clusters</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show AKS clusters with PUBLIC API server access. Include: Cluster Name, Resource Group, API Server Access Mode, Authorized IP Ranges status, Network Type, Risk Level, Security Recommendation.')">
                            <span class="prompt-icon">🔓</span>
                            <span>AKS with public access</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show AKS clusters with PRIVATE API server access. Include: Cluster Name, Resource Group, Private Cluster Status, Private DNS Zone, VNet Integration, Security Posture.')">
                            <span class="prompt-icon">🔐</span>
                            <span>AKS with private access</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show AKS clusters NOT enabled for Container Insights monitoring. Include: Cluster Name, Resource Group, Monitoring Status, Log Analytics Workspace, Prometheus Metrics status, Recommendation.')">
                            <span class="prompt-icon">📊</span>
                            <span>AKS without monitoring</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show AKS cluster resource utilization. Include: Cluster Name, CPU Utilization %, Memory Utilization %, Node Pool Status, Pod Count, Scaling Recommendations.')">
                            <span class="prompt-icon">⚡</span>
                            <span>AKS resource utilization</span>
                        </div>
                    </div>
                </div>

                <!-- Virtual Machine Scale Sets Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('vmss')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/compute/10034-icon-service-VM-Scale-Sets.svg" alt="VMSS"></div>
                            <div class="category-name">VM Scale Sets</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-vmss">
                        <div class="prompt-item" onclick="quickPrompt('List ALL Virtual Machine Scale Sets in my subscription. Include: VMSS Name, Resource Group, Location, SKU Size, Instance Count, Orchestration Mode, OS Type, Upgrade Policy, Status.')">
                            <span class="prompt-icon">📋</span>
                            <span>List all VMSS</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show VMSS scaling configuration. Include: VMSS Name, Min Instances, Max Instances, Current Instances, Autoscale Enabled, Scale Rules, Cooldown Period.')">
                            <span class="prompt-icon">📈</span>
                            <span>VMSS scaling configuration</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show VMSS with high CPU utilization. Include: VMSS Name, Resource Group, Instance Count, Average CPU %, Scaling Rule Status, Recommendation.')">
                            <span class="prompt-icon">⚡</span>
                            <span>VMSS high utilization</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show VMSS without diagnostics or monitoring enabled. Include: VMSS Name, Resource Group, Boot Diagnostics Status, Guest Metrics Status, Azure Monitor Agent Status, Recommendation.')">
                            <span class="prompt-icon">📊</span>
                            <span>VMSS without monitoring</span>
                        </div>
                    </div>
                </div>

                <!-- Azure App Services Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('appservices')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/compute/10035-icon-service-App-Services.svg" alt="App Services"></div>
                            <div class="category-name">Azure App Services</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-appservices">
                        <div class="prompt-item" onclick="quickPrompt('List ALL App Services in my subscription. Include: App Name, Resource Group, Location, App Service Plan, SKU/Tier, Status, Type (Web App/Function/Container), Default Hostname, HTTPS Only, TLS Version.')">
                            <span class="prompt-icon">📋</span>
                            <span>List all App Services</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show App Services NOT connected to Application Insights. Include: App Name, Resource Group, Plan, Status, App Insights Status, Recommendation for enabling monitoring.')">
                            <span class="prompt-icon">📊</span>
                            <span>App Services without App Insights</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show App Services with high CPU utilization. Include: App Name, Resource Group, Plan, Average CPU %, Peak CPU %, Duration, Impact on Performance, Scaling Recommendation.')">
                            <span class="prompt-icon">⚡</span>
                            <span>App Services high CPU</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show App Services with PUBLIC ACCESS enabled (no private endpoints or IP restrictions). Include: App Name, Resource Group, Plan, Public Access Status, Network Restrictions, Risk Level, Security Recommendation.')">
                            <span class="prompt-icon">🔓</span>
                            <span>App Services public access</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show App Services health and performance overview. Include: App Name, Status, HTTP Errors, Response Time, Requests/min, Plan Utilization %, Recommendations.')">
                            <span class="prompt-icon">💚</span>
                            <span>App Services health</span>
                        </div>
                    </div>
                </div>

                <!-- Azure SQL PaaS Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('sql')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/databases/10130-icon-service-SQL-Database.svg" alt="SQL"></div>
                            <div class="category-name">Azure SQL PaaS</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-sql">
                        <div class="prompt-item" onclick="quickPrompt('List ALL Azure SQL Databases in my subscription. Include: Database Name, Server Name, Resource Group, Location, SKU/Tier, DTU/vCores, Max Size, Status, Backup Retention.')">
                            <span class="prompt-icon">📋</span>
                            <span>List SQL Databases</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('List ALL Azure SQL Managed Instances in my subscription. Include: Instance Name, Resource Group, Location, SKU/Tier, vCores, Storage Size, Status, Subnet, Backup Configuration.')">
                            <span class="prompt-icon">📋</span>
                            <span>List SQL Managed Instances</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show SQL Databases with low storage utilization (potential cost savings). Include: Database Name, Server, Max Size GB, Used Size GB, Utilization %, Potential Right-sizing, Cost Savings Estimate.')">
                            <span class="prompt-icon">💾</span>
                            <span>SQL low disk utilization</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show SQL Managed Instances with low storage utilization. Include: Instance Name, Provisioned Storage GB, Used Storage GB, Utilization %, Cost Optimization Recommendation.')">
                            <span class="prompt-icon">💾</span>
                            <span>SQL MI low disk utilization</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show SQL Databases with high CPU utilization. Include: Database Name, Server, DTU/vCore Usage %, Peak CPU %, Duration, Performance Tier, Scaling Recommendation.')">
                            <span class="prompt-icon">⚡</span>
                            <span>SQL high CPU utilization</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show SQL Managed Instances with high CPU utilization. Include: Instance Name, vCore Usage %, Peak CPU %, Duration, Current Tier, Scaling Recommendation.')">
                            <span class="prompt-icon">⚡</span>
                            <span>SQL MI high CPU utilization</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Azure SQL Databases with PUBLIC network access enabled. Include: Database Name, Server, Public Network Access, Firewall Rules, Private Endpoint Status, Risk Level, Security Recommendation.')">
                            <span class="prompt-icon">🔓</span>
                            <span>SQL public access enabled</span>
                        </div>
                    </div>
                </div>

                <!-- PostgreSQL Servers Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('postgresql')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/databases/10131-icon-service-Azure-Database-PostgreSQL-Server.svg" alt="PostgreSQL"></div>
                            <div class="category-name">PostgreSQL Servers</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-postgresql">
                        <div class="prompt-item" onclick="quickPrompt('List ALL Azure Database for PostgreSQL (Flexible) servers in my subscription. Include: Server Name, Resource Group, Location, Version, SKU/Tier, vCores, Storage GB, HA Mode, Status.')">
                            <span class="prompt-icon">📋</span>
                            <span>List PostgreSQL servers</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show PostgreSQL servers with public network access. Include: Server Name, Resource Group, Public Access Status, Firewall Rules, Private Endpoint Status, SSL Mode, Risk Level.')">
                            <span class="prompt-icon">🔓</span>
                            <span>PostgreSQL public access</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show PostgreSQL servers performance metrics. Include: Server Name, CPU Utilization %, Memory Utilization %, Storage Utilization %, Connections, Recommendation.')">
                            <span class="prompt-icon">⚡</span>
                            <span>PostgreSQL performance</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show PostgreSQL servers without backup configured or with low backup retention. Include: Server Name, Backup Retention Days, Geo-Redundant Backup, Last Backup, Recommendation.')">
                            <span class="prompt-icon">💾</span>
                            <span>PostgreSQL backup status</span>
                        </div>
                    </div>
                </div>

                <!-- MySQL Servers Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('mysql')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/databases/10122-icon-service-Azure-Database-MySQL-Server.svg" alt="MySQL"></div>
                            <div class="category-name">MySQL Servers</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-mysql">
                        <div class="prompt-item" onclick="quickPrompt('List ALL Azure Database for MySQL servers in my subscription. Include: Server Name, Resource Group, Location, Version, SKU/Tier, vCores, Storage GB, Status.')">
                            <span class="prompt-icon">📋</span>
                            <span>List MySQL servers</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show MySQL servers with public network access. Include: Server Name, Resource Group, Public Access Status, Firewall Rules, Private Endpoint Status, SSL Mode, Risk Level.')">
                            <span class="prompt-icon">🔓</span>
                            <span>MySQL public access</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show MySQL servers performance and utilization. Include: Server Name, CPU Utilization %, Memory Utilization %, Storage Utilization %, Active Connections, Recommendation.')">
                            <span class="prompt-icon">⚡</span>
                            <span>MySQL performance</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show MySQL servers backup configuration. Include: Server Name, Backup Retention Days, Geo-Redundant Backup, Last Backup Time, Recommendation.')">
                            <span class="prompt-icon">💾</span>
                            <span>MySQL backup status</span>
                        </div>
                    </div>
                </div>

                <!-- Cosmos DB Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('cosmosdb')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/databases/10121-icon-service-Azure-Cosmos-DB.svg" alt="Cosmos DB"></div>
                            <div class="category-name">Cosmos DB</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-cosmosdb">
                        <div class="prompt-item" onclick="quickPrompt('List ALL Cosmos DB accounts in my subscription. Include: Account Name, Resource Group, Location, API Type (SQL/MongoDB/Cassandra/Gremlin/Table), Consistency Level, Replication Regions, Status.')">
                            <span class="prompt-icon">📋</span>
                            <span>List Cosmos DB accounts</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Cosmos DB accounts with public network access. Include: Account Name, Resource Group, Public Access Status, Firewall Rules, Private Endpoint Status, VNet Filter, Risk Level.')">
                            <span class="prompt-icon">🔓</span>
                            <span>Cosmos DB public access</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Cosmos DB RU/s utilization and cost optimization opportunities. Include: Account Name, Database, Container, Provisioned RU/s, Used RU/s, Utilization %, Autoscale Status, Cost Optimization Recommendation.')">
                            <span class="prompt-icon">💰</span>
                            <span>Cosmos DB RU optimization</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Cosmos DB replication and backup configuration. Include: Account Name, Write Regions, Read Regions, Automatic Failover, Backup Type, Retention Period.')">
                            <span class="prompt-icon">🔄</span>
                            <span>Cosmos DB replication</span>
                        </div>
                    </div>
                </div>

                <!-- Storage Accounts Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('storage')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/storage/10086-icon-service-Storage-Accounts.svg" alt="Storage"></div>
                            <div class="category-name">Storage Accounts</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-storage">
                        <div class="prompt-item" onclick="quickPrompt('List ALL Storage Accounts in my subscription. Include: Storage Account Name, Resource Group, Location, SKU/Tier, Kind (StorageV2/BlobStorage/etc), Status, Access Tier, Replication Type, Creation Date, Tags.')">
                            <span class="prompt-icon">📋</span>
                            <span>Storage account summary</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Storage Accounts with PUBLIC ACCESS enabled (blob anonymous access). Include: Account Name, Resource Group, Location, Public Access Setting, Blob Public Access, Network Rule Default Action, Risk Level, Security Recommendation.')">
                            <span class="prompt-icon">🔓</span>
                            <span>Storage public access enabled</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Storage Accounts with PRIVATE ENDPOINTS configured. Include: Account Name, Resource Group, Private Endpoint Name, Private IP, VNet, Subnet, Connection Status, Approval Status.')">
                            <span class="prompt-icon">🔐</span>
                            <span>Storage with private endpoints</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show EMPTY Storage Accounts with no blobs, files, tables, or queues. Include: Account Name, Resource Group, Location, Total Capacity, Container Count, File Share Count, Created Date, Recommendation.')">
                            <span class="prompt-icon">📭</span>
                            <span>Empty storage accounts</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Storage Accounts NOT USED in the last 3 months (no transactions or changes). Include: Account Name, Resource Group, Last Activity Date, Last Transaction Date, Usage Pattern, Monthly Cost, Recommendation.')">
                            <span class="prompt-icon">💤</span>
                            <span>Unused storage accounts</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Storage Account capacity utilization sorted by size. Include: Account Name, Resource Group, Total Capacity (GB/TB), Blob Capacity, File Capacity, Table Capacity, Queue Capacity, Access Tier Distribution, Cost Estimate.')">
                            <span class="prompt-icon">📊</span>
                            <span>Storage capacity wise</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('List ALL Azure File Shares across storage accounts. Include: File Share Name, Storage Account, Resource Group, Quota (GB), Used Capacity (GB), Protocol (SMB/NFS), Access Tier, Snapshot Count.')">
                            <span class="prompt-icon">📁</span>
                            <span>File Shares inventory</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show File Shares configured with Active Directory authentication. Include: File Share Name, Storage Account, AD Join Status, Domain Name, Authentication Type (AD DS/Azure AD DS/Kerberos), RBAC Enabled, Permission Configuration.')">
                            <span class="prompt-icon">🔑</span>
                            <span>File Shares with AD auth</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Storage Accounts with Lifecycle Management policies configured. Include: Account Name, Resource Group, Policy Count, Rules Summary (Tier Down/Delete after X days), Affected Containers, Estimated Savings.')">
                            <span class="prompt-icon">♻️</span>
                            <span>Lifecycle management policies</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show Storage Account cost optimization opportunities. Include: Account Name, Resource Group, Current Tier, Monthly Cost, Optimization Type (Tier Change/Lifecycle Policy/Delete Unused), Recommended Action, Estimated Monthly Savings.')">
                            <span class="prompt-icon">💰</span>
                            <span>Storage cost optimization</span>
                        </div>
                    </div>
                </div>

                <!-- API Management Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('apim')">
                        <div class="category-info">
                            <div class="category-icon">🔌</div>
                            <div class="category-name">API Management</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-apim">
                        <div class="prompt-item" onclick="quickPrompt('List ALL API Management instances in my subscription. Include: APIM Name, Resource Group, Location, SKU/Tier, Capacity Units, Gateway URL, Status, VNet Mode.')">
                            <span class="prompt-icon">📋</span>
                            <span>List APIM instances</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show APIM security configuration. Include: APIM Name, Authentication Methods, VNet Integration, Private Endpoint Status, Management Endpoint Access, Security Recommendations.')">
                            <span class="prompt-icon">🔐</span>
                            <span>APIM security config</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show APIM capacity utilization. Include: APIM Name, SKU, Current Capacity, CPU Utilization %, Memory Utilization %, Gateway Requests, Scaling Recommendation.')">
                            <span class="prompt-icon">📈</span>
                            <span>APIM capacity utilization</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show APIM API inventory. Include: APIM Name, Total APIs, Total Operations, Products, Subscriptions, Top APIs by Usage.')">
                            <span class="prompt-icon">📊</span>
                            <span>APIM API inventory</span>
                        </div>
                    </div>
                </div>

                
                <!-- Azure Inventory Category - Based on: https://github.com/scautomation/Azure-Inventory-Workbook -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('inventory')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/general/10001-icon-service-All-Resources.svg" alt="Inventory"></div>
                            <div class="category-name">Azure Inventory</div>
                        </div>
                        <div class="category-toggle">&#9660;</div>
                    </div>
                    <div class="category-prompts" id="category-inventory">
                        <!-- Summary -->
                        <div class="prompt-item" onclick="quickPrompt('Get a COMPLETE inventory summary of ALL Azure resources in my environment. Show counts by category: VMs, VMSS, ARC Machines, App Services, Containers (AKS/ACR/ACI), Data (SQL/CosmosDB/MySQL/PostgreSQL), Events (ServiceBus/EventHub), IoT, ML/AI, Storage/KeyVault/Backup, Virtual Desktop, Networking, NSGs, Monitoring, Security Scores, Governance/Policy. Give me a high-level overview of my entire Azure estate.')">
                            <span class="prompt-icon"><img src="/Icons/general/10001-icon-service-All-Resources.svg" alt="Summary" style="width:18px;height:18px;"></span>
                            <span>Full Inventory Summary</span>
                        </div>

                        <!-- Overview -->
                        <div class="prompt-item" onclick="quickPrompt('Get an overview of all Azure resources in my environment. Show total resource count, resource counts by type, resource counts by location/region, and subscription/resource group breakdown.')">
                            <span class="prompt-icon"><img src="/Icons/general/10349-icon-service-Resource-Explorer.svg" alt="Overview" style="width:18px;height:18px;"></span>
                            <span>Resource Overview</span>
                        </div>

                        <!-- Compute VMs -->
                        <div class="prompt-item" onclick="quickPrompt('Get a comprehensive inventory of all Virtual Machines. Include: VM name, size, power state, OS type, creation date, availability set, SQL extensions, resource group, location, subscription.')">
                            <span class="prompt-icon"><img src="/Icons/compute/10021-icon-service-Virtual-Machine.svg" alt="VMs" style="width:18px;height:18px;"></span>
                            <span>Virtual Machines</span>
                        </div>

                        <!-- Compute VMSS -->
                        <div class="prompt-item" onclick="quickPrompt('Get inventory of all VM Scale Sets. Include: VMSS name, size, capacity, OS type, upgrade mode, over-provision setting, resource group, location.')">
                            <span class="prompt-icon"><img src="/Icons/compute/10034-icon-service-VM-Scale-Sets.svg" alt="VMSS" style="width:18px;height:18px;"></span>
                            <span>VM Scale Sets</span>
                        </div>

                        <!-- VM Networking -->
                        <div class="prompt-item" onclick="quickPrompt('Get VM networking inventory. Show each VM with its NIC, private IP address, and public IP address. Include VM size and subscription.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10080-icon-service-Network-Interfaces.svg" alt="VM NICs" style="width:18px;height:18px;"></span>
                            <span>VM Networking (IPs)</span>
                        </div>

                        <!-- VM Disks -->
                        <div class="prompt-item" onclick="quickPrompt('Get VM disk/storage inventory. Show each VM with OS disk size, OS SKU, data disk count, total data disk size in GB, and creation date.')">
                            <span class="prompt-icon"><img src="/Icons/compute/10032-icon-service-Disks.svg" alt="Disks" style="width:18px;height:18px;"></span>
                            <span>VM Disks & Storage</span>
                        </div>

                        <!-- ARC Machines -->
                        <div class="prompt-item" onclick="quickPrompt('Get inventory of all Azure ARC hybrid machines. Include: machine name, OS, FQDN, status, serial number, last seen date, IP addresses.')">
                            <span class="prompt-icon"><img src="/Icons/compute/10021-icon-service-Virtual-Machine.svg" alt="ARC" style="width:18px;height:18px;"></span>
                            <span>ARC (Hybrid) Machines</span>
                        </div>

                        <!-- PaaS Automation -->
                        <div class="prompt-item" onclick="quickPrompt('Get inventory of all Automation resources. Include: Automation Accounts, Logic Apps, Runbooks, Custom APIs, Integration Accounts with their state and type.')">
                            <span class="prompt-icon"><img src="/Icons/management%20+%20governance/00022-icon-service-Automation-Accounts.svg" alt="Automation" style="width:18px;height:18px;"></span>
                            <span>Automation & Logic Apps</span>
                        </div>

                        <!-- PaaS Apps -->
                        <div class="prompt-item" onclick="quickPrompt('Get inventory of all Application resources. Include: App Services, Azure Functions, API Management, Front Door, App Gateways, App Config Stores with SKU and state.')">
                            <span class="prompt-icon"><img src="/Icons/compute/10035-icon-service-App-Services.svg" alt="Apps" style="width:18px;height:18px;"></span>
                            <span>App Services & Functions</span>
                        </div>

                        <!-- PaaS Containers -->
                        <div class="prompt-item" onclick="quickPrompt('Get inventory of all Container resources. Include: AKS clusters with Kubernetes version and node count, Container Registries with SKU, Container Instances with state.')">
                            <span class="prompt-icon"><img src="/Icons/compute/10023-icon-service-Kubernetes-Services.svg" alt="Containers" style="width:18px;height:18px;"></span>
                            <span>Containers (AKS/ACR/ACI)</span>
                        </div>

                        <!-- PaaS Data -->
                        <div class="prompt-item" onclick="quickPrompt('Get inventory of all Data Platform resources. Include: SQL Servers, SQL DBs, CosmosDB, MySQL, PostgreSQL, Synapse, ADX Clusters, Data Factory, Purview with SKU, tier, status, and endpoints.')">
                            <span class="prompt-icon"><img src="/Icons/databases/10130-icon-service-SQL-Database.svg" alt="Data" style="width:18px;height:18px;"></span>
                            <span>Data Platform (SQL/Cosmos/etc)</span>
                        </div>

                        <!-- PaaS Events -->
                        <div class="prompt-item" onclick="quickPrompt('Get inventory of all Event/Messaging resources. Include: Service Bus namespaces, Event Hub namespaces, Event Grid topics, Azure Relay with SKU, status, and endpoints.')">
                            <span class="prompt-icon"><img src="/Icons/analytics/10149-icon-service-Event-Hub-Clusters.svg" alt="Events" style="width:18px;height:18px;"></span>
                            <span>Events (ServiceBus/EventHub)</span>
                        </div>

                        <!-- PaaS IoT -->
                        <div class="prompt-item" onclick="quickPrompt('Get inventory of all IoT resources. Include: IoT Hubs, IoT Central Apps, IoT Security Solutions with SKU, tier, state, hostname, and Event Hub endpoints.')">
                            <span class="prompt-icon"><img src="/Icons/iot/10182-icon-service-IoT-Hub.svg" alt="IoT" style="width:18px;height:18px;"></span>
                            <span>IoT Resources</span>
                        </div>

                        <!-- PaaS ML/AI -->
                        <div class="prompt-item" onclick="quickPrompt('Get inventory of all ML/AI resources. Include: Machine Learning Workspaces, Cognitive Services/OpenAI with SKU, tier, endpoints, linked storage, and App Insights.')">
                            <span class="prompt-icon"><img src="/Icons/iot/00030-icon-service-Machine-Learning-Studio-(Classic)-Web-Services.svg" alt="ML/AI" style="width:18px;height:18px;"></span>
                            <span>ML/AI & Cognitive Services</span>
                        </div>

                        <!-- PaaS Storage -->
                        <div class="prompt-item" onclick="quickPrompt('Get inventory of all Storage & Backup resources. Include: Storage Accounts, Key Vaults, Recovery Services vaults, Azure File Sync with SKU and kind.')">
                            <span class="prompt-icon"><img src="/Icons/storage/10086-icon-service-Storage-Accounts.svg" alt="Storage" style="width:18px;height:18px;"></span>
                            <span>Storage & Key Vaults</span>
                        </div>

                        <!-- PaaS WVD/AVD -->
                        <div class="prompt-item" onclick="quickPrompt('Get inventory of all Azure Virtual Desktop resources. Include: Host Pools, Workspaces, Application Groups with type, location, and resource group.')">
                            <span class="prompt-icon"><img src="/Icons/compute/00328-icon-service-Host-Pools.svg" alt="AVD" style="width:18px;height:18px;"></span>
                            <span>Azure Virtual Desktop</span>
                        </div>

                        <!-- Networking -->
                        <div class="prompt-item" onclick="quickPrompt('Get overview of all Networking resources with counts by type. Include: VNets, Subnets, NSGs, Load Balancers, Application Gateways, Public IPs, Private Endpoints, CDN, etc.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10061-icon-service-Virtual-Networks.svg" alt="Network" style="width:18px;height:18px;"></span>
                            <span>Network Resources Overview</span>
                        </div>

                        <!-- NSGs -->
                        <div class="prompt-item" onclick="quickPrompt('Get NSG inventory including which NSGs are unassociated (not linked to any NIC or subnet). Show association status for each NSG.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10067-icon-service-Network-Security-Groups.svg" alt="NSG" style="width:18px;height:18px;"></span>
                            <span>NSGs & Association Status</span>
                        </div>

                        <!-- NSG Rules -->
                        <div class="prompt-item" onclick="quickPrompt('Get all NSG security rules across my environment. Show: NSG name, rule name, access (Allow/Deny), direction, protocol, priority, source/destination address prefix, port ranges.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10067-icon-service-Network-Security-Groups.svg" alt="NSG Rules" style="width:18px;height:18px;"></span>
                            <span>NSG Security Rules</span>
                        </div>

                        <!-- IP Inventory -->
                        <div class="prompt-item" onclick="quickPrompt('Get IP address inventory per subnet. Show each VNet and subnet with: total IPs available, IPs in use, available IPs remaining. Help me understand IP address utilization.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10069-icon-service-Public-IP-Addresses.svg" alt="IPs" style="width:18px;height:18px;"></span>
                            <span>IP Address Inventory</span>
                        </div>

                        <!-- Monitoring Alerts -->
                        <div class="prompt-item" onclick="quickPrompt('Get all active fired alerts from Azure Monitor. Show: alert name, status, state, severity, time fired, suppression status, resource group, subscription.')">
                            <span class="prompt-icon"><img src="/Icons/management%20+%20governance/00002-icon-service-Alerts.svg" alt="Alerts" style="width:18px;height:18px;"></span>
                            <span>Active Alerts (Fired)</span>
                        </div>

                        <!-- Monitoring Resources -->
                        <div class="prompt-item" onclick="quickPrompt('Get inventory of all Monitoring & Alerting resources. Include: Workbooks, Activity Log Alerts, Log Search Alerts, Action Groups, Metric Alerts, Smart Detection Rules, Portal Dashboards.')">
                            <span class="prompt-icon"><img src="/Icons/monitor/00001-icon-service-Monitor.svg" alt="Monitor" style="width:18px;height:18px;"></span>
                            <span>Monitoring Resources</span>
                        </div>

                        <!-- App Insights -->
                        <div class="prompt-item" onclick="quickPrompt('Get Application Insights inventory. Show each component with: retention period, ingestion mode, resource group, location, subscription.')">
                            <span class="prompt-icon"><img src="/Icons/monitor/00012-icon-service-Application-Insights.svg" alt="AppInsights" style="width:18px;height:18px;"></span>
                            <span>Application Insights</span>
                        </div>

                        <!-- Log Analytics -->
                        <div class="prompt-item" onclick="quickPrompt('Get Log Analytics workspace inventory. Show each workspace with: SKU, retention period in days, resource group, location, subscription.')">
                            <span class="prompt-icon"><img src="/Icons/monitor/00009-icon-service-Log-Analytics-Workspaces.svg" alt="LogAnalytics" style="width:18px;height:18px;"></span>
                            <span>Log Analytics Workspaces</span>
                        </div>

                        <!-- Security Scores -->
                        <div class="prompt-item" onclick="quickPrompt('Get Azure Security Center secure scores by subscription and security controls. Show subscription scores and list all security controls with healthy/unhealthy resources and current/max scores.')">
                            <span class="prompt-icon"><img src="/Icons/security/10245-icon-service-Key-Vaults.svg" alt="Security" style="width:18px;height:18px;"></span>
                            <span>Security Scores</span>
                        </div>

                        <!-- Governance Policy -->
                        <div class="prompt-item" onclick="quickPrompt('Get governance policy inventory. Show: total policy assignments, initiatives deployed, policies deployed, compliant vs non-compliant resources by subscription.')">
                            <span class="prompt-icon"><img src="/Icons/management%20+%20governance/10316-icon-service-Policy.svg" alt="Policy" style="width:18px;height:18px;"></span>
                            <span>Policy & Compliance</span>
                        </div>
                    </div>
                </div>

                <!-- Cloud Operations Health Category - Based on: https://github.com/Azure/cloud-rolesandops -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('opshealth')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/monitor/00001-icon-service-Monitor.svg" alt="Ops Health"></div>
                            <div class="category-name">Cloud Ops Health</div>
                        </div>
                        <div class="category-toggle">&#9660;</div>
                    </div>
                    <div class="category-prompts" id="category-opshealth">
                        <!-- Overall Management Score -->
                        <div class="prompt-item" onclick="quickPrompt('Run a full Cloud Operations Health Assessment across all 6 management pillars: Advisor, Backup, Monitor, Defender for Cloud, Update Management, and Azure Policy. Show me the overall management score and each pillar score with recommendations to improve.')">
                            <span class="prompt-icon"><img src="/Icons/monitor/00001-icon-service-Monitor.svg" alt="Overall" style="width:18px;height:18px;"></span>
                            <span>Overall Management Score</span>
                        </div>

                        <!-- Advisor Health -->
                        <div class="prompt-item" onclick="quickPrompt('What is my Azure Advisor Health Score? Show the percentage of resources without active advisor recommendations and highlight areas for improvement.')">
                            <span class="prompt-icon"><img src="/Icons/management%20+%20governance/00003-icon-service-Advisor.svg" alt="Advisor" style="width:18px;height:18px;"></span>
                            <span>Advisor Health Score</span>
                        </div>

                        <!-- Advisor Recommendations Breakdown -->
                        <div class="prompt-item" onclick="quickPrompt('Show me a breakdown of all Azure Advisor recommendations by category (Reliability, Security, Performance, Cost, Operational Excellence) and impact level.')">
                            <span class="prompt-icon"><img src="/Icons/management%20+%20governance/00003-icon-service-Advisor.svg" alt="Advisor" style="width:18px;height:18px;"></span>
                            <span>Advisor Recommendations</span>
                        </div>

                        <!-- Backup Protection -->
                        <div class="prompt-item" onclick="quickPrompt('What is my Backup Protection Score? Show how many virtual machines are protected by Azure Backup vs unprotected. List any VMs at risk.')">
                            <span class="prompt-icon"><img src="/Icons/management%20+%20governance/00017-icon-service-Recovery-Services-Vaults.svg" alt="Backup" style="width:18px;height:18px;"></span>
                            <span>Backup Protection Score</span>
                        </div>

                        <!-- Monitor & Alerts -->
                        <div class="prompt-item" onclick="quickPrompt('Assess my Azure Monitor and Alerts management score. Show alert response effectiveness: total alerts, fired, acknowledged, closed rates, and overall monitoring health.')">
                            <span class="prompt-icon"><img src="/Icons/management%20+%20governance/00002-icon-service-Alerts.svg" alt="Alerts" style="width:18px;height:18px;"></span>
                            <span>Monitor & Alerts Score</span>
                        </div>

                        <!-- Security Posture -->
                        <div class="prompt-item" onclick="quickPrompt('What is my Defender for Cloud security posture score? Show total security assessments, healthy vs unhealthy recommendations, and the overall security management score.')">
                            <span class="prompt-icon"><img src="/Icons/security/10241-icon-service-Microsoft-Defender-for-Cloud.svg" alt="Security" style="width:18px;height:18px;"></span>
                            <span>Security Posture Score</span>
                        </div>

                        <!-- Update Compliance -->
                        <div class="prompt-item" onclick="quickPrompt('Check my Update Management compliance score. Show how many systems have pending updates, which are healthy vs unhealthy, and the percentage compliant with update policies.')">
                            <span class="prompt-icon"><img src="/Icons/management%20+%20governance/00022-icon-service-Automation-Accounts.svg" alt="Updates" style="width:18px;height:18px;"></span>
                            <span>Update Compliance Score</span>
                        </div>

                        <!-- Policy Compliance -->
                        <div class="prompt-item" onclick="quickPrompt('What is my Azure Policy compliance score? Show compliant vs non-compliant resources, exempt resources, and the policy management score percentage.')">
                            <span class="prompt-icon"><img src="/Icons/management%20+%20governance/10316-icon-service-Policy.svg" alt="Policy" style="width:18px;height:18px;"></span>
                            <span>Policy Compliance Score</span>
                        </div>

                        <!-- Environment Overview -->
                        <div class="prompt-item" onclick="quickPrompt('Show me a full environment overview of my monitoring and operational resources: Log Analytics workspaces, Application Insights, alert rules, action groups, automation accounts, key vaults, and recovery vaults.')">
                            <span class="prompt-icon"><img src="/Icons/general/10001-icon-service-All-Resources.svg" alt="Environment" style="width:18px;height:18px;"></span>
                            <span>Environment Overview</span>
                        </div>

                        <!-- Tagging Governance -->
                        <div class="prompt-item" onclick="quickPrompt('Assess my resource tagging governance health. Show what percentage of resources have environment, owner, and cost center tags. Identify resources missing critical tags.')">
                            <span class="prompt-icon"><img src="/Icons/general/10014-icon-service-Tag.svg" alt="Tags" style="width:18px;height:18px;"></span>
                            <span>Tagging Governance</span>
                        </div>

                        <!-- Network Security -->
                        <div class="prompt-item" onclick="quickPrompt('Show my network security health posture: count of NSGs, Azure Firewalls, Application Gateways (WAF), Front Doors, Private Endpoints, and Private DNS Zones deployed.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10061-icon-service-Virtual-Networks.svg" alt="Network" style="width:18px;height:18px;"></span>
                            <span>Network Security Health</span>
                        </div>

                        <!-- Disaster Recovery -->
                        <div class="prompt-item" onclick="quickPrompt('Assess my disaster recovery readiness. Show Recovery Services Vaults, backup protected items, ASR replicated items, and overall DR coverage.')">
                            <span class="prompt-icon"><img src="/Icons/management%20+%20governance/00017-icon-service-Recovery-Services-Vaults.svg" alt="DR" style="width:18px;height:18px;"></span>
                            <span>Disaster Recovery Readiness</span>
                        </div>
                    </div>
                </div>

                <!-- Orphaned Resources Category - Based on: https://github.com/dolevshor/azure-orphan-resources -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('orphaned')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/general/10349-icon-service-Resource-Explorer.svg" alt="Orphaned"></div>
                            <div class="category-name">Orphaned Resources</div>
                        </div>
                        <div class="category-toggle">&#9660;</div>
                    </div>
                    <div class="category-prompts" id="category-orphaned">
                        <!-- Summary -->
                        <div class="prompt-item" onclick="quickPrompt('Get a COMPLETE summary of ALL orphaned resources in my environment. Show count by category: App Service Plans (no apps), Availability Sets (no VMs), Managed Disks (unattached), SQL Elastic Pools (no databases), Public IPs (unattached), Network Interfaces (not attached), NSGs (not attached), Route Tables (not attached), Load Balancers (no backends), Application Gateways (no targets), NAT Gateways (not attached), Private DNS Zones (no VNet links), Private Endpoints (disconnected), VNet Gateways (no connections), DDoS Protection (no VNets), Empty Resource Groups. Highlight resources with cost impact and calculate total potential monthly savings.')">
                            <span class="prompt-icon"><img src="/Icons/general/10001-icon-service-All-Resources.svg" alt="Summary" style="width:18px;height:18px;"></span>
                            <span>Full orphaned resources summary</span>
                        </div>

                        <!-- COMPUTE -->
                        <div class="prompt-item" onclick="quickPrompt('Find orphaned App Service Plans - plans without any hosted web apps or functions. These cost money even when empty. Include: Plan Name, Resource Group, Location, SKU/Tier, Number of Sites (should be 0), Tags. Recommend deletion or consolidation.')">
                            <span class="prompt-icon"><img src="/Icons/compute/10035-icon-service-App-Services.svg" alt="App Service" style="width:18px;height:18px;"></span>
                            <span>App Service Plans (no apps) &#x1F4B0;</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Availability Sets - sets not associated to any Virtual Machine or VMSS. Excludes Azure Site Recovery (ASR) sets. Include: Availability Set Name, Resource Group, Location, Fault Domains, Update Domains, VM Count (should be 0), Tags.')">
                            <span class="prompt-icon"><img src="/Icons/compute/10025-icon-service-Availability-Sets.svg" alt="Availability Set" style="width:18px;height:18px;"></span>
                            <span>Availability Sets (no VMs)</span>
                        </div>

                        <!-- STORAGE -->
                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Managed Disks in Unattached state. These disks cost money even when not attached to any VM. Excludes ASR replica disks and AKS PVC disks. Include: Disk Name, Resource Group, Location, Disk Type, Size GB, Disk State, Time Created, Tags. Sort by size descending.')">
                            <span class="prompt-icon"><img src="/Icons/compute/10032-icon-service-Disks.svg" alt="Disk" style="width:18px;height:18px;"></span>
                            <span>Managed Disks (unattached) &#x1F4B0;</span>
                        </div>

                        <!-- DATABASE -->
                        <div class="prompt-item" onclick="quickPrompt('Find orphaned SQL Elastic Pools without any databases. These pools cost money even when empty. Include: Pool Name, SQL Server Name, Resource Group, Location, Database Count (should be 0), Tags.')">
                            <span class="prompt-icon"><img src="/Icons/databases/10134-icon-service-SQL-Elastic-Pools.svg" alt="SQL Pool" style="width:18px;height:18px;"></span>
                            <span>SQL Elastic Pools (empty) &#x1F4B0;</span>
                        </div>

                        <!-- NETWORKING -->
                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Public IP addresses not attached to any resource. Static Public IPs cost money even when unattached. Include: IP Name, Resource Group, Location, SKU Type, Allocation Method, IP Address, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10069-icon-service-Public-IP-Addresses.svg" alt="Public IP" style="width:18px;height:18px;"></span>
                            <span>Public IPs (unattached) &#x1F4B0;</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Network Interfaces not attached to any VM or other resource. Include: NIC Name, Resource Group, Location, Private IP Address, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10080-icon-service-Network-Interfaces.svg" alt="NIC" style="width:18px;height:18px;"></span>
                            <span>Network Interfaces (not attached)</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Network Security Groups not attached to any NIC or subnet. Include: NSG Name, Resource Group, Location, Rule Count, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10067-icon-service-Network-Security-Groups.svg" alt="NSG" style="width:18px;height:18px;"></span>
                            <span>NSGs (not attached)</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Route Tables not attached to any subnet. Include: Route Table Name, Resource Group, Location, Route Count, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10082-icon-service-Route-Tables.svg" alt="Route Table" style="width:18px;height:18px;"></span>
                            <span>Route Tables (not attached)</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Load Balancers without backend pools or NAT rules. Load Balancers cost money even when not routing traffic. Include: LB Name, Resource Group, SKU Type, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10062-icon-service-Load-Balancers.svg" alt="Load Balancer" style="width:18px;height:18px;"></span>
                            <span>Load Balancers (no backends) &#x1F4B0;</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Application Gateways without backend targets. Application Gateways are expensive even when not routing traffic. Include: AppGw Name, Resource Group, SKU Tier, Capacity, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10076-icon-service-Application-Gateways.svg" alt="App Gateway" style="width:18px;height:18px;"></span>
                            <span>Application Gateways (no targets) &#x1F4B0;</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned NAT Gateways not attached to any subnet. NAT Gateways cost money even when not routing traffic. Include: NAT Gateway Name, Resource Group, SKU, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10310-icon-service-NAT.svg" alt="NAT Gateway" style="width:18px;height:18px;"></span>
                            <span>NAT Gateways (not attached) &#x1F4B0;</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Virtual Network Gateways without P2S configuration or VPN connections. VNet Gateways are expensive even when not routing traffic. Include: Gateway Name, Resource Group, Gateway Type, SKU, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10063-icon-service-Virtual-Network-Gateways.svg" alt="VNet Gateway" style="width:18px;height:18px;"></span>
                            <span>VNet Gateways (no connections) &#x1F4B0;</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Private DNS Zones without Virtual Network Links. Private DNS Zones cost money even when not linked to any VNet. Include: Zone Name, Resource Group, Record Set Count, VNet Links (should be 0), Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10064-icon-service-DNS-Zones.svg" alt="Private DNS" style="width:18px;height:18px;"></span>
                            <span>Private DNS Zones (no links) &#x1F4B0;</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Private Endpoints in Disconnected state. Private Endpoints cost money even when disconnected. Include: Endpoint Name, Resource Group, Target Service, Connection State, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/00427-icon-service-Private-Link.svg" alt="Private Endpoint" style="width:18px;height:18px;"></span>
                            <span>Private Endpoints (disconnected) &#x1F4B0;</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned DDoS Protection Plans without any protected Virtual Networks. DDoS Protection Plans are VERY expensive (~$2,944/month) even when not protecting any VNets. Include: Plan Name, Resource Group, Protected VNets (should be 0), Monthly Cost, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10072-icon-service-DDoS-Protection-Plans.svg" alt="DDoS" style="width:18px;height:18px;"></span>
                            <span>DDoS Protection Plans (unused) &#x1F4B0;&#x1F4B0;</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Virtual Networks without any subnets. Include: VNet Name, Resource Group, Address Space, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10061-icon-service-Virtual-Networks.svg" alt="VNet" style="width:18px;height:18px;"></span>
                            <span>Virtual Networks (no subnets)</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Subnets without connected devices or delegation. Include: Subnet Name, VNet Name, Resource Group, Address Prefix, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/02742-icon-service-Subnet.svg" alt="Subnet" style="width:18px;height:18px;"></span>
                            <span>Empty Subnets</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned IP Groups not attached to any Azure Firewall or Firewall Policy. Include: IP Group Name, Resource Group, IP Address Count, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/00701-icon-service-IP-Groups.svg" alt="IP Group" style="width:18px;height:18px;"></span>
                            <span>IP Groups (not used)</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Front Door WAF Policies without Security Policy Links. Include: Policy Name, Resource Group, SKU, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10362-icon-service-Web-Application-Firewall-Policies(WAF).svg" alt="WAF Policy" style="width:18px;height:18px;"></span>
                            <span>Front Door WAF Policies (unused)</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned Traffic Manager Profiles without any endpoints. Include: Profile Name, Resource Group, Routing Method, DNS Name, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/networking/10065-icon-service-Traffic-Manager-Profiles.svg" alt="Traffic Manager" style="width:18px;height:18px;"></span>
                            <span>Traffic Manager Profiles (no endpoints)</span>
                        </div>

                        <!-- OTHERS -->
                        <div class="prompt-item" onclick="quickPrompt('Find empty Resource Groups without any resources. Include: Resource Group Name, Location, Subscription, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/general/10007-icon-service-Resource-Groups.svg" alt="Resource Group" style="width:18px;height:18px;"></span>
                            <span>Empty Resource Groups</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find orphaned API Connections not used by any Logic App. Include: Connection Name, API Type, Resource Group, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/integration/02631-icon-service-Logic-Apps.svg" alt="API Connection" style="width:18px;height:18px;"></span>
                            <span>API Connections (unused)</span>
                        </div>

                        <div class="prompt-item" onclick="quickPrompt('Find expired App Service Certificates. Include: Certificate Name, Resource Group, Subject Name, Expiration Date, Issuer, Tags.')">
                            <span class="prompt-icon"><img src="/Icons/security/10245-icon-service-Key-Vaults.svg" alt="Certificate" style="width:18px;height:18px;"></span>
                            <span>Expired Certificates</span>
                        </div>
                    </div>
                </div>

                <!-- Architecture Diagrams Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('diagrams')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/general/10349-icon-service-Resource-Explorer.svg" alt="Diagrams"></div>
                            <div class="category-name">Architecture Diagrams</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-diagrams">
                        <!-- GOVERNANCE & ESTATE -->
                        <div class="prompt-item" style="font-weight:600; color:#0078d4; pointer-events:none; opacity:0.85; font-size:11px; padding:4px 14px 2px;">
                            <span>── Governance &amp; Estate ──</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Generate an environment overview diagram showing all my subscriptions, regions, and resource groups with resource counts - I want to see my full Azure estate')">
                            <span class="prompt-icon">🌐</span>
                            <span>My Azure estate overview</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Generate a subscription overview diagram showing all resource groups with resources grouped by category - I want to see how my subscription is organized')">
                            <span class="prompt-icon">📋</span>
                            <span>My subscription layout</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('List all my resource groups with resource counts, then let me pick one to generate a full architecture diagram showing all resources and their relationships')">
                            <span class="prompt-icon">📦</span>
                            <span>Diagram a Resource Group</span>
                        </div>

                        <!-- WORKLOAD DIAGRAMS -->
                        <div class="prompt-item" style="font-weight:600; color:#0078d4; pointer-events:none; opacity:0.85; font-size:11px; padding:8px 14px 2px;">
                            <span>── Workload Diagrams ──</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Discover my web application workloads - find all App Services, App Service Plans, Function Apps, and their connected resources like databases, storage, and Key Vaults. Show me the workloads so I can generate an architecture diagram.')">
                            <span class="prompt-icon">🌐</span>
                            <span>Web app workloads</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Discover my containerized workloads - find AKS clusters, Container Apps, Container Registries, and their connected resources. List them so I can select which to diagram.')">
                            <span class="prompt-icon">☸️</span>
                            <span>Container &amp; Kubernetes</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Discover my Virtual Machine workloads - find all VMs with their NICs, Disks, NSGs, and Virtual Networks. Group them by resource group so I can select a VM workload to diagram.')">
                            <span class="prompt-icon">🖥️</span>
                            <span>VM workloads</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Discover my database workloads - find all SQL Servers, SQL Databases, Cosmos DB accounts, PostgreSQL, MySQL, and Redis Cache instances with their connected resources. List them so I can diagram.')">
                            <span class="prompt-icon">🗄️</span>
                            <span>Database workloads</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Discover my API and integration workloads - find API Management instances, Logic Apps, Service Bus, Event Grid, Event Hubs, and their backend connections. List them so I can diagram the integration architecture.')">
                            <span class="prompt-icon">🔌</span>
                            <span>API &amp; Integration</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Discover my AI and Machine Learning workloads - find Azure OpenAI, Cognitive Services, Machine Learning workspaces, and their connected storage and Key Vaults. List them so I can diagram the AI architecture.')">
                            <span class="prompt-icon">🤖</span>
                            <span>AI &amp; ML workloads</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Discover my data platform workloads - find Data Factory, Databricks, Synapse, Event Hubs, Stream Analytics, and Storage accounts. List them so I can diagram the data pipeline architecture.')">
                            <span class="prompt-icon">📊</span>
                            <span>Data platform</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Discover my Azure Virtual Desktop (AVD) workloads - find host pools, session hosts, workspaces, application groups, and the underlying networking and storage. List them so I can generate the AVD architecture diagram.')">
                            <span class="prompt-icon">🖥️</span>
                            <span>AVD / Virtual Desktop</span>
                        </div>

                        <!-- NETWORKING & SECURITY -->
                        <div class="prompt-item" style="font-weight:600; color:#0078d4; pointer-events:none; opacity:0.85; font-size:11px; padding:8px 14px 2px;">
                            <span>── Networking &amp; Security ──</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Diagram my network topology - find all Virtual Networks, Subnets, NSGs, Route Tables, VPN Gateways, ExpressRoute, Firewalls, and Bastion hosts. Show the network architecture with peering and connectivity.')">
                            <span class="prompt-icon">🔗</span>
                            <span>Network topology</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Diagram my security architecture - find all Key Vaults, Managed Identities, NSGs, Firewalls, Private Endpoints, and their connections to protected resources. Show the security posture.')">
                            <span class="prompt-icon">🔒</span>
                            <span>Security architecture</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Diagram my monitoring setup - find all Application Insights, Log Analytics workspaces, and the resources they monitor. Show the observability architecture.')">
                            <span class="prompt-icon">📈</span>
                            <span>Monitoring &amp; observability</span>
                        </div>

                        <!-- SMART DISCOVERY -->
                        <div class="prompt-item" style="font-weight:600; color:#0078d4; pointer-events:none; opacity:0.85; font-size:11px; padding:8px 14px 2px;">
                            <span>── Smart Discovery ──</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Find resources that share the same tags and group them as a workload. Show me the unique tag combinations (like Environment, Application, Owner) so I can select a tag-based workload to diagram together.')">
                            <span class="prompt-icon">🏷️</span>
                            <span>Tag-based workloads</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('I want to build a custom multi-workload diagram. Help me step by step: 1) Show my resource groups, 2) Let me pick multiple RGs or resource types to combine, 3) Generate a single unified architecture diagram showing all selected workloads together with their cross-dependencies.')">
                            <span class="prompt-icon">🧩</span>
                            <span>Multi-workload builder</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Show me all my Azure resources grouped by resource group with counts, then let me select multiple resources across different resource groups to combine into a single cross-RG architecture diagram.')">
                            <span class="prompt-icon">🏗️</span>
                            <span>Cross-RG diagram</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('Discover all resources in my environment and automatically identify distinct workload clusters based on naming patterns, shared resource groups, and resource dependencies. Show me the detected workloads so I can pick one to diagram.')">
                            <span class="prompt-icon">🔍</span>
                            <span>Auto-detect workloads</span>
                        </div>
                    </div>
                </div>

                <!-- About Category -->
                <div class="category-section">
                    <div class="category-header" onclick="toggleCategory('about')">
                        <div class="category-info">
                            <div class="category-icon"><img src="/Icons/general/10005-icon-service-Information.svg" alt="About"></div>
                            <div class="category-name">About</div>
                        </div>
                        <div class="category-toggle"></div>
                    </div>
                    <div class="category-prompts" id="category-about">
                        <div class="prompt-item" onclick="showAboutModal()">
                            <span class="prompt-icon">👤</span>
                            <span>About this solution</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('What features does the Azure CloudOps Intelligence Agent provide?')">
                            <span class="prompt-icon">✨</span>
                            <span>Features list</span>
                        </div>
                        <div class="prompt-item" onclick="quickPrompt('How does this agent integrate with Azure services?')">
                            <span class="prompt-icon">🔗</span>
                            <span>Azure integration</span>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Chat Area -->
        <div class="chat-area">
            <div class="chat-messages" id="chatContainer">
                <div class="welcome-state">
                    <h2>Azure CloudOps Intelligence Agent</h2>
                    <p>Select a category to get started or use the chat to ask questions.</p>
                    
                    <div style="font-size: 10px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 10px; padding-left: 2px;">Quick Actions</div>
                    <div class="welcome-categories">
                        <div class="welcome-category-card" onclick="showCategory('entraid')">
                            <span class="welcome-category-icon"><img src="/Icons/identity/10235-icon-service-Identity-Governance.svg" alt="Entra ID"></span>
                            <div class="welcome-category-title">Entra ID (Azure AD)</div>
                            <div class="welcome-category-desc">Users, groups, apps, devices, conditional access</div>
                            <div class="welcome-category-count">14 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('iam')">
                            <span class="welcome-category-icon"><img src="/Icons/identity/10340-icon-service-Entra-Identity-Roles-and-Administrators.svg" alt="IAM"></span>
                            <div class="welcome-category-title">Access Control (IAM)</div>
                            <div class="welcome-category-desc">RBAC role assignments, privileged access audit</div>
                            <div class="welcome-category-count">6 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('landingzone')">
                            <span class="welcome-category-icon"><img src="/Icons/new icons/029636048-icon-service-Landing-Zone.svg" alt="Landing Zone"></span>
                            <div class="welcome-category-title">Landing Zone (CAF)</div>
                            <div class="welcome-category-desc">CAF assessment, Platform & Application LZ review</div>
                            <div class="welcome-category-count">22 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('waf')">
                            <span class="welcome-category-icon"><img src="/Icons/management + governance/00003-icon-service-Advisor.svg" alt="WAF"></span>
                            <div class="welcome-category-title">Well-Architected Framework</div>
                            <div class="welcome-category-desc">Reliability, Security, Cost, Operations, Performance</div>
                            <div class="welcome-category-count">8 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('networking')">
                            <span class="welcome-category-icon"><img src="/Icons/networking/10061-icon-service-Virtual-Networks.svg" alt="Networking"></span>
                            <div class="welcome-category-title">Networking</div>
                            <div class="welcome-category-desc">VNets, NSGs, Firewalls, Load Balancers, WAF, vWAN</div>
                            <div class="welcome-category-count">32 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('privatelink')">
                            <span class="welcome-category-icon"><img src="/Icons/networking/00427-icon-service-Private-Link.svg" alt="Private Link"></span>
                            <div class="welcome-category-title">Azure Private Link</div>
                            <div class="welcome-category-desc">Private endpoints, PaaS security, connections</div>
                            <div class="welcome-category-count">14 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('privatedns')">
                            <span class="welcome-category-icon"><img src="/Icons/networking/10064-icon-service-DNS-Zones.svg" alt="Private DNS"></span>
                            <div class="welcome-category-title">Private DNS Zones</div>
                            <div class="welcome-category-desc">DNS zones, VNet links, resolution issues</div>
                            <div class="welcome-category-count">14 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('virtualmachines')">
                            <span class="welcome-category-icon"><img src="/Icons/compute/10021-icon-service-Virtual-Machine.svg" alt="Virtual Machines"></span>
                            <div class="welcome-category-title">Virtual Machines</div>
                            <div class="welcome-category-desc">VM health, backup, monitoring, cost optimization</div>
                            <div class="welcome-category-count">15 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('resources')">
                            <span class="welcome-category-icon"><img src="/Icons/general/10001-icon-service-All-Resources.svg" alt="Resources"></span>
                            <div class="welcome-category-title">Resource Management</div>
                            <div class="welcome-category-desc">Inventory, search, and filter Azure resources</div>
                            <div class="welcome-category-count">6 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('cost')">
                            <span class="welcome-category-icon"><img src="/Icons/general/10019-icon-service-Cost-Management.svg" alt="Cost"></span>
                            <div class="welcome-category-title">Cost Optimization</div>
                            <div class="welcome-category-desc">Cost analysis, comparisons, and savings opportunities</div>
                            <div class="welcome-category-count">7 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('security')">
                            <span class="welcome-category-icon"><img src="/Icons/security/10241-icon-service-Microsoft-Defender-for-Cloud.svg" alt="Security"></span>
                            <div class="welcome-category-title">Security & Compliance</div>
                            <div class="welcome-category-desc">Defender, security score, alerts, compliance</div>
                            <div class="welcome-category-count">10 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('policy')">
                            <span class="welcome-category-icon"><img src="/Icons/management + governance/10316-icon-service-Policy.svg" alt="Policy"></span>
                            <div class="welcome-category-title">Azure Policy</div>
                            <div class="welcome-category-desc">Policy compliance and exemptions</div>
                            <div class="welcome-category-count">5 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('monitoring')">
                            <span class="welcome-category-icon"><img src="/Icons/management + governance/00001-icon-service-Monitor.svg" alt="Monitoring"></span>
                            <div class="welcome-category-title">Monitoring & Alerts</div>
                            <div class="welcome-category-desc">Alerts, monitoring gaps, VM Insights status</div>
                            <div class="welcome-category-count">11 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('backup')">
                            <span class="welcome-category-icon"><img src="/Icons/storage/00017-icon-service-Recovery-Services-Vaults.svg" alt="Backup"></span>
                            <div class="welcome-category-title">Azure Backup</div>
                            <div class="welcome-category-desc">VMs, disks, files, SQL backup protection status</div>
                            <div class="welcome-category-count">12 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('updates')">
                            <span class="welcome-category-icon"><img src="/Icons/compute/00195-icon-service-Maintenance-Configuration.svg" alt="Updates"></span>
                            <div class="welcome-category-title">Update Management</div>
                            <div class="welcome-category-desc">VM and Arc machine patches and compliance</div>
                            <div class="welcome-category-count">6 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('tags')">
                            <span class="welcome-category-icon"><img src="/Icons/general/10014-icon-service-Tag.svg" alt="Tags"></span>
                            <div class="welcome-category-title">Tags Management</div>
                            <div class="welcome-category-desc">Tag inventory and compliance</div>
                            <div class="welcome-category-count">5 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('arc')">
                            <span class="welcome-category-icon"><img src="/Icons/management + governance/00756-icon-service-Azure-Arc.svg" alt="Arc"></span>
                            <div class="welcome-category-title">Azure Arc</div>
                            <div class="welcome-category-desc">Hybrid infrastructure management</div>
                            <div class="welcome-category-count">3 Quick Actions</div>
                        </div>
                        
                        <div class="welcome-category-card" onclick="showCategory('aks')">
                            <span class="welcome-category-icon"><img src="/Icons/compute/10023-icon-service-Kubernetes-Services.svg" alt="AKS"></span>
                            <div class="welcome-category-title">Azure Kubernetes</div>
                            <div class="welcome-category-desc">AKS clusters, monitoring, security posture</div>
                            <div class="welcome-category-count">5 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('vmss')">
                            <span class="welcome-category-icon"><img src="/Icons/compute/10034-icon-service-VM-Scale-Sets.svg" alt="VMSS"></span>
                            <div class="welcome-category-title">VM Scale Sets</div>
                            <div class="welcome-category-desc">Scale set monitoring and configuration</div>
                            <div class="welcome-category-count">4 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('appservices')">
                            <span class="welcome-category-icon"><img src="/Icons/compute/10035-icon-service-App-Services.svg" alt="App Services"></span>
                            <div class="welcome-category-title">App Services</div>
                            <div class="welcome-category-desc">Web apps, monitoring, public access</div>
                            <div class="welcome-category-count">5 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('sql')">
                            <span class="welcome-category-icon"><img src="/Icons/databases/10130-icon-service-SQL-Database.svg" alt="SQL"></span>
                            <div class="welcome-category-title">Azure SQL PaaS</div>
                            <div class="welcome-category-desc">SQL Database, Managed Instance optimization</div>
                            <div class="welcome-category-count">7 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('postgresql')">
                            <span class="welcome-category-icon"><img src="/Icons/databases/10131-icon-service-Azure-Database-PostgreSQL-Server.svg" alt="PostgreSQL"></span>
                            <div class="welcome-category-title">PostgreSQL Servers</div>
                            <div class="welcome-category-desc">PostgreSQL flexible servers management</div>
                            <div class="welcome-category-count">4 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('mysql')">
                            <span class="welcome-category-icon"><img src="/Icons/databases/10122-icon-service-Azure-Database-MySQL-Server.svg" alt="MySQL"></span>
                            <div class="welcome-category-title">MySQL Servers</div>
                            <div class="welcome-category-desc">MySQL flexible servers management</div>
                            <div class="welcome-category-count">4 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('cosmosdb')">
                            <span class="welcome-category-icon"><img src="/Icons/databases/10121-icon-service-Azure-Cosmos-DB.svg" alt="Cosmos DB"></span>
                            <div class="welcome-category-title">Cosmos DB</div>
                            <div class="welcome-category-desc">NoSQL database optimization</div>
                            <div class="welcome-category-count">4 Quick Actions</div>
                        </div>
                        <div class="welcome-category-card" onclick="showCategory('storage')">
                            <span class="welcome-category-icon"><img src="/Icons/storage/10086-icon-service-Storage-Accounts.svg" alt="Storage"></span>
                            <div class="welcome-category-title">Storage Accounts</div>
                            <div class="welcome-category-desc">Capacity, security, file shares, cost optimization</div>
                            <div class="welcome-category-count">10 Quick Actions</div>
                        </div>

                        <div class="welcome-category-card" onclick="showCategory('inventory')">
                            <span class="welcome-category-icon"><img src="/Icons/general/10001-icon-service-All-Resources.svg" alt="Inventory"></span>
                            <div class="welcome-category-title">Azure Inventory</div>
                            <div class="welcome-category-desc">Complete resource inventory - Compute, PaaS, Networking, Monitoring, Governance</div>
                            <div class="welcome-category-count">26 Inventory Types</div>
                        </div>

                        <div class="welcome-category-card" onclick="showCategory('opshealth')">
                            <span class="welcome-category-icon"><img src="/Icons/monitor/00001-icon-service-Monitor.svg" alt="Ops Health"></span>
                            <div class="welcome-category-title">Cloud Ops Health</div>
                            <div class="welcome-category-desc">Management score across 6 pillars — Advisor, Backup, Monitor, Security, Updates, Policy</div>
                            <div class="welcome-category-count">12 Assessments</div>
                        </div>

                        <div class="welcome-category-card" onclick="showCategory('orphaned')">
                            <span class="welcome-category-icon"><img src="/Icons/general/10349-icon-service-Resource-Explorer.svg" alt="Orphaned"></span>
                            <div class="welcome-category-title">Orphaned Resources</div>
                            <div class="welcome-category-desc">Find unused resources costing money - disks, IPs, NICs, NSGs</div>
                            <div class="welcome-category-count">24 Resource Types</div>
                        </div>

                        <div class="welcome-category-card" onclick="showCategory('apim')">
                            <span class="welcome-category-icon"><img src="/Icons/integration/10042-icon-service-API-Management-Services.svg" alt="APIM"></span>
                            <div class="welcome-category-title">API Management</div>
                            <div class="welcome-category-desc">APIM instances, APIs, policies, diagnostics</div>
                            <div class="welcome-category-count">5 Quick Actions</div>
                        </div>

                        <div class="welcome-category-card" onclick="showCategory('automation')">
                            <span class="welcome-category-icon"><img src="/Icons/management + governance/00022-icon-service-Automation-Accounts.svg" alt="Automation"></span>
                            <div class="welcome-category-title">Automation</div>
                            <div class="welcome-category-desc">Runbooks, automation accounts, scheduled tasks</div>
                            <div class="welcome-category-count">4 Quick Actions</div>
                        </div>

                        <div class="welcome-category-card" onclick="showCategory('diagrams')">
                            <span class="welcome-category-icon"><img src="/Icons/general/10349-icon-service-Resource-Explorer.svg" alt="Diagrams"></span>
                            <div class="welcome-category-title">Architecture Diagrams</div>
                            <div class="welcome-category-desc">Generate Azure architecture diagrams, network topology, data flow visuals</div>
                            <div class="welcome-category-count">12 Quick Actions</div>
                        </div>

                        <div class="welcome-category-card" onclick="showCategory('about')">
                            <span class="welcome-category-icon"><img src="/Icons/general/10005-icon-service-Information.svg" alt="About"></span>
                            <div class="welcome-category-title">About</div>
                            <div class="welcome-category-desc">Agent capabilities, version info, and help</div>
                            <div class="welcome-category-count">Learn More</div>
                        </div>

                        </div>
                </div>
            </div>

            <div class="input-area">
                <div class="input-wrapper">
                    <textarea id="userInput" placeholder="Ask me anything about Azure infrastructure, costs, security, or optimization..." rows="1"></textarea>
                    <button id="sendBtn" onclick="sendMessage()">Send ✈️</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let conversationHistory = [];

        // About Modal Functions
        function showAboutModal() {
            document.getElementById('aboutModal').classList.add('active');
        }

        function closeAboutModal(event) {
            if (!event || event.target === document.getElementById('aboutModal')) {
                document.getElementById('aboutModal').classList.remove('active');
            }
        }

        // Load user profile
        function loadUserProfile() {
            console.log('🔍 Loading user profile...');
            
            let userInfo = sessionStorage.getItem('userInfo');
            if (!userInfo) {
                userInfo = localStorage.getItem('userInfo');
                if (userInfo) {
                    sessionStorage.setItem('userInfo', userInfo);
                }
            }
            
            if (userInfo) {
                try {
                    const user = JSON.parse(userInfo);
                    document.getElementById('userProfile').style.display = 'flex';
                    document.getElementById('userName').textContent = user.name || 'User';
                    document.getElementById('userEmail').textContent = user.email || '';
                    const initials = user.name ? user.name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase() : 'U';
                    document.getElementById('userAvatar').textContent = initials;
                } catch (error) {
                    console.error('Error parsing user info:', error);
                }
            } else {
                // Always redirect to login page if no user session
                console.log('No user session, redirecting to login...');
                window.location.replace('/login.html');
            }
        }

        function logout() {
            console.log('🚪 Logging out...');
            
            // Clear all authentication data
            sessionStorage.clear();
            localStorage.clear();
            
            // Clear widget cache if exists
            if (typeof widgetCache !== 'undefined') {
                widgetCache = {
                    security: { data: null, timestamp: 0, loading: false },
                    savings: { data: null, timestamp: 0, loading: false },
                    resources: { data: null, timestamp: 0, loading: false }
                };
                isLoadingWidgets = false;
            }
            
            // Redirect to login with cache buster
            window.location.replace('/login.html?t=' + Date.now());
        }

        // Go to home/reload page
        function goHome() {
            window.location.reload();
        }

        // Subscription Management
        function changeSubscription() {
            const select = document.getElementById('subscriptionSelect');
            const selectedOption = select.options[select.selectedIndex];
            const subscriptionName = selectedOption.text;
            
            // Clear widget cache so widgets re-fetch for the new context
            widgetCache = {
                security: { data: null, timestamp: 0, loading: false },
                savings: { data: null, timestamp: 0, loading: false },
                resources: { data: null, timestamp: 0, loading: false }
            };
            isLoadingWidgets = false;
            
            // Update insights based on subscription
            updateInsightsForSubscription(select.value);
            
            // Load sidebar live insights
            loadSidebarLiveInsights(select.value);
            
            // Show notification
            showNotification(`Switched to ${subscriptionName} context`);
            
            // Clear conversation history when switching context
            conversationHistory = [];
            
            // Inform user about context switch
            const chatContainer = document.getElementById('chatContainer');
            if (!document.querySelector('.welcome-state')) {
                const contextMessage = document.createElement('div');
                contextMessage.className = 'context-switch-message';
                contextMessage.innerHTML = `
                    <div style="background: var(--surface-light); border: 1px solid var(--primary); border-radius: 12px; padding: 16px; margin: 16px auto; max-width: 700px; text-align: center;">
                        <strong style="color: var(--primary);">📌 Subscription Context Changed</strong><br>
                        <span style="color: var(--text-secondary); font-size: 13px;">Now showing data for: ${subscriptionName}</span>
                    </div>
                `;
                chatContainer.appendChild(contextMessage);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
        }

        async function updateInsightsForSubscription(subscriptionId) {
            console.log(`Loading stats for subscription: ${subscriptionId}`);
            const isAllSubs = subscriptionId === 'all' || subscriptionId === 'loading';
            
            try {
                const accessToken = sessionStorage.getItem('accessToken');
                const headers = { 'Content-Type': 'application/json' };
                if (accessToken) {
                    headers['Authorization'] = `Bearer ${accessToken}`;
                }

                // Update health score - default healthy
                document.getElementById('healthScore').textContent = '95%';
                
                // Load public access exposure for header widget
                try {
                    const paResp = await fetch(`/api/public-access-exposure/${subscriptionId}`, { headers });
                    if (paResp.ok) {
                        const paData = await paResp.json();
                        if (paData.count !== null && paData.count !== undefined) {
                            const paEl = document.getElementById('publicAccessCount');
                            if (paEl) paEl.textContent = paData.count.toString();
                        }
                    }
                } catch (paErr) {
                    console.error('Public access header error:', paErr);
                }

                // Fetch monthly cost - works for both single and all subscriptions
                try {
                    const costPrompt = isAllSubs
                        ? 'What is my total Azure cost for the current month across ALL subscriptions? Just give me the total amount in USD, format as $X,XXX.XX'
                        : 'What is my total Azure cost for the current month? Just give me the total amount in USD, format as $X,XXX.XX';
                    
                    const costResponse = await fetch('/api/chat', {
                        method: 'POST',
                        headers: headers,
                        body: JSON.stringify({
                            message: costPrompt,
                            subscription_context: isAllSubs ? 'all' : subscriptionId,
                            all_subscriptions: isAllSubs
                        })
                    });
                    
                    if (costResponse.ok) {
                        const costData = await costResponse.json();
                        // Extract dollar amount from response
                        const costMatch = costData.response?.match(/\$[\d,]+\.?\d*/);
                        if (costMatch) {
                            document.getElementById('monthlyCost').textContent = costMatch[0];
                        } else {
                            // Try to extract just a number if no $ sign
                            const numMatch = costData.response?.match(/[\d,]+\.?\d*\s*(USD|dollars?)?/i);
                            if (numMatch) {
                                document.getElementById('monthlyCost').textContent = '$' + numMatch[0].replace(/\s*(USD|dollars?)/i, '');
                            }
                        }
                    }
                } catch (err) {
                    console.error('Error fetching cost:', err);
                    document.getElementById('monthlyCost').textContent = '$--';
                }
                
            } catch (error) {
                console.error('Error loading stats:', error);
                // Keep default values on error
            }
        }

        // Load sidebar live insights (Security Score, Savings, Resources) - with timeouts and graceful fallbacks
        // Widget cache and loading state
        let widgetCache = {
            security: { data: null, timestamp: 0, loading: false },
            savings: { data: null, timestamp: 0, loading: false },
            resources: { data: null, timestamp: 0, loading: false }
        };
        const CACHE_DURATION = 60000; // 60 seconds
        let isLoadingWidgets = false;

        // Load sidebar live insights - OPTIMIZED with cache and parallel loading
        async function loadSidebarLiveInsights(subscriptionId) {
            // Prevent multiple simultaneous calls
            if (isLoadingWidgets) {
                console.log('⏭️ Widget load already in progress, skipping...');
                return;
            }
            
            isLoadingWidgets = true;
            const startTime = performance.now();
            console.log('📊 [START] Loading sidebar widgets for:', subscriptionId);
            
            if (!subscriptionId || subscriptionId === 'loading' || subscriptionId === 'none') {
                subscriptionId = 'current';
            }
            
            // Get authentication token for API calls
            const accessToken = sessionStorage.getItem('accessToken');
            const headers = { 
                'Content-Type': 'application/json'
            };
            
            // Only add Authorization header if token exists and is valid
            if (accessToken && accessToken !== 'null' && accessToken !== 'undefined') {
                headers['Authorization'] = `Bearer ${accessToken}`;
                console.log('🔑 Token added to widget requests');
            } else {
                console.error('❌ NO VALID TOKEN - Widgets will fail!');
                console.error('Token value:', accessToken);
            }

            // Helper to update widget UI
            function updateWidget(widgetId, value, subtitleId, subtitleText, cardId, cardClass) {
                try {
                    const el = document.getElementById(widgetId);
                    const subEl = subtitleId ? document.getElementById(subtitleId) : null;
                    const card = cardId ? document.getElementById(cardId) : null;
                    
                    if (el) {
                        el.textContent = value;
                        console.log(`✅ ${widgetId} = ${value}`);
                    }
                    if (subEl && subtitleText) subEl.textContent = subtitleText;
                    if (card && cardClass) {
                        card.classList.remove('success-dynamic', 'warning-dynamic', 'danger-dynamic');
                        card.classList.add(cardClass);
                    }
                } catch (e) {
                    console.error(`❌ Failed to update ${widgetId}:`, e);
                }
            }

            // Check cache
            function isCacheValid(cacheKey) {
                return widgetCache[cacheKey].data && 
                       (Date.now() - widgetCache[cacheKey].timestamp) < CACHE_DURATION;
            }

            // Show loading state for all
            updateWidget('sidebarSecurityScore', '...', 'sidebarSecuritySubtitle', 'Loading', null, null);
            updateWidget('sidebarSavings', '...', 'sidebarSavingsSubtitle', 'Loading', null, null);
            updateWidget('sidebarResources', '...', 'sidebarResourcesSubtitle', 'Loading', null, null);

            // PARALLEL LOAD - All widgets load independently
            const promises = [];

            // Widget 1: Security Score (FAST - Direct API)
            promises.push((async () => {
                if (widgetCache.security.loading) return;
                
                try {
                    widgetCache.security.loading = true;
                    const t0 = performance.now();
                    
                    // Check cache
                    if (isCacheValid('security')) {
                        console.log('📦 Security: Using cache');
                        const cached = widgetCache.security.data;
                        updateWidget('sidebarSecurityScore', cached.value, 'sidebarSecuritySubtitle', cached.subtitle, 'securityCard', cached.cardClass);
                        return;
                    }
                    
                    let securitySubId = subscriptionId;
                    if (securitySubId === 'all' || securitySubId === 'current') {
                        const storedSubs = sessionStorage.getItem('azureSubscriptions');
                        if (storedSubs) {
                            const subs = JSON.parse(storedSubs);
                            securitySubId = subs[0]?.id || subs[0]?.subscriptionId || 'current';
                        }
                    }
                    
                    const response = await Promise.race([
                        fetch(`/api/security-score/${securitySubId}`, { method: 'GET', headers }),
                        new Promise((_, reject) => setTimeout(() => reject(new Error('Timeout')), 60000))
                    ]);
                    
                    // Graceful auth handling - don't redirect for widgets
                    if (response.status === 401) {
                        console.warn('🔒 Security widget: Auth failed');
                        updateWidget('sidebarSecurityScore', 'N/A', 'sidebarSecuritySubtitle', 'Login required', 'securityCard', 'warning-dynamic');
                        return;
                    }
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data.score !== null && data.score !== undefined) {
                            const score = Math.round(data.score * 10) / 10;
                            const cardClass = score >= 80 ? 'success-dynamic' : score >= 60 ? 'warning-dynamic' : 'danger-dynamic';
                            const subtitle = score >= 80 ? 'Strong posture' : score >= 60 ? 'Needs attention' : 'Critical issues';
                            
                            // Cache result
                            widgetCache.security.data = { value: score + '%', subtitle, cardClass };
                            widgetCache.security.timestamp = Date.now();
                            
                            updateWidget('sidebarSecurityScore', score + '%', 'sidebarSecuritySubtitle', subtitle, 'securityCard', cardClass);
                        } else {
                            updateWidget('sidebarSecurityScore', 'N/A', 'sidebarSecuritySubtitle', 'Enable Defender', 'securityCard', 'warning-dynamic');
                        }
                    } else {
                        updateWidget('sidebarSecurityScore', 'N/A', 'sidebarSecuritySubtitle', 'API error', 'securityCard', 'warning-dynamic');
                    }
                    
                    console.log(`⚡ Security loaded in ${Math.round(performance.now() - t0)}ms`);
                } catch (e) {
                    console.error('🛡️ Security error:', e.message);
                    updateWidget('sidebarSecurityScore', 'N/A', 'sidebarSecuritySubtitle', 'Error', 'securityCard', 'warning-dynamic');
                } finally {
                    widgetCache.security.loading = false;
                }
            })());

            // Widget 2: Savings (SLOW - Keep simple)
            promises.push((async () => {
                if (widgetCache.savings.loading) return;
                
                try {
                    widgetCache.savings.loading = true;
                    const t0 = performance.now();
                    
                    // Check cache
                    if (isCacheValid('savings')) {
                        console.log('📦 Savings: Using cache');
                        const cached = widgetCache.savings.data;
                        updateWidget('sidebarSavings', cached.value, 'sidebarSavingsSubtitle', cached.subtitle, 'savingsCard', cached.cardClass);
                        return;
                    }
                    
                    const response = await Promise.race([
                        fetch('/api/chat', {
                            method: 'POST',
                            headers,
                            body: JSON.stringify({
                                message: 'Azure Advisor total potential monthly savings? Reply only with dollar amount like $123 or $0.',
                                subscription_context: subscriptionId === 'all' || subscriptionId === 'current' ? null : subscriptionId,
                                conversation_history: []
                            })
                        }),
                        new Promise((_, reject) => setTimeout(() => reject(new Error('Timeout')), 60000))
                    ]);
                    
                    // Graceful auth handling - don't redirect for widgets
                    if (response.status === 401) {
                        console.warn('💰 Savings widget: Auth failed');
                        updateWidget('sidebarSavings', 'N/A', 'sidebarSavingsSubtitle', 'Login required', 'savingsCard', 'warning-dynamic');
                        return;
                    }
                    
                    if (response.ok) {
                        const data = await response.json();
                        const savingsMatch = data.response?.match(/\$[\d,]+\.?\d*/);
                        const zeroMatch = data.response?.match(/\$0|zero|none/i);
                        
                        let value, subtitle, cardClass;
                        if (savingsMatch) {
                            value = savingsMatch[0] + '/mo';
                            subtitle = 'Potential savings';
                            cardClass = 'warning-dynamic';
                        } else if (zeroMatch) {
                            value = '$0';
                            subtitle = 'No savings found';
                            cardClass = 'success-dynamic';
                        } else {
                            value = 'Check';
                            subtitle = 'Click to analyze';
                            cardClass = 'warning-dynamic';
                        }
                        
                        // Cache result
                        widgetCache.savings.data = { value, subtitle, cardClass };
                        widgetCache.savings.timestamp = Date.now();
                        
                        updateWidget('sidebarSavings', value, 'sidebarSavingsSubtitle', subtitle, 'savingsCard', cardClass);
                    }
                    
                    console.log(`⚡ Savings loaded in ${Math.round(performance.now() - t0)}ms`);
                } catch (e) {
                    console.error('💰 Savings error:', e.message);
                    updateWidget('sidebarSavings', 'N/A', 'sidebarSavingsSubtitle', 'Timeout', 'savingsCard', 'warning-dynamic');
                } finally {
                    widgetCache.savings.loading = false;
                }
            })());

            // Widget 3: Resources (FAST - Direct API, no OpenAI)
            promises.push((async () => {
                if (widgetCache.resources.loading) return;
                
                try {
                    widgetCache.resources.loading = true;
                    const t0 = performance.now();
                    
                    // Check cache
                    if (isCacheValid('resources')) {
                        console.log('\u{1F4E6} Resources: Using cache');
                        const cached = widgetCache.resources.data;
                        updateWidget('sidebarResources', cached.value, 'sidebarResourcesSubtitle', cached.subtitle, 'resourcesCard', cached.cardClass);
                        return;
                    }
                    
                    let resourceSubId = subscriptionId;
                    if (resourceSubId === 'all' || resourceSubId === 'current') {
                        const storedSubs = sessionStorage.getItem('azureSubscriptions');
                        if (storedSubs) {
                            const subs = JSON.parse(storedSubs);
                            resourceSubId = subs[0]?.id || subs[0]?.subscriptionId || 'current';
                        }
                    }
                    
                    const response = await Promise.race([
                        fetch(`/api/resource-count/${resourceSubId}`, { method: 'GET', headers }),
                        new Promise((_, reject) => setTimeout(() => reject(new Error('Timeout')), 60000))
                    ]);
                    
                    if (response.status === 401) {
                        console.warn('Resources widget: Auth failed');
                        updateWidget('sidebarResources', 'N/A', 'sidebarResourcesSubtitle', 'Login required', 'resourcesCard', 'warning-dynamic');
                        return;
                    }
                    
                    if (response.ok) {
                        const data = await response.json();
                        
                        let value, subtitle, cardClass;
                        if (data.count !== null && data.count !== undefined) {
                            value = data.count.toString();
                            subtitle = 'Total resources';
                            cardClass = 'success-dynamic';
                            // Header now shows publicAccessCount, not resourceCount
                            // (publicAccessCount loaded separately)
                        } else {
                            value = 'Check';
                            subtitle = 'Click to view';
                            cardClass = 'warning-dynamic';
                        }
                        
                        widgetCache.resources.data = { value, subtitle, cardClass };
                        widgetCache.resources.timestamp = Date.now();
                        
                        updateWidget('sidebarResources', value, 'sidebarResourcesSubtitle', subtitle, 'resourcesCard', cardClass);
                    }
                    
                    console.log(`Resources loaded in ${Math.round(performance.now() - t0)}ms`);
                } catch (e) {
                    console.error('Resources error:', e.message);
                    updateWidget('sidebarResources', 'N/A', 'sidebarResourcesSubtitle', 'Timeout', 'resourcesCard', 'warning-dynamic');
                } finally {
                    widgetCache.resources.loading = false;
                }
            })());

            
            // Widget 4: Public Access Exposure (Header widget)
            promises.push((async () => {
                try {
                    const t0 = performance.now();
                    
                    let paSubId = subscriptionId;
                    if (paSubId === 'all' || paSubId === 'current' || paSubId === 'loading') {
                        const storedSubs = sessionStorage.getItem('azureSubscriptions');
                        if (storedSubs) {
                            const subs = JSON.parse(storedSubs);
                            paSubId = subs[0]?.id || subs[0]?.subscriptionId || 'current';
                        } else {
                            paSubId = 'current';
                        }
                    }
                    
                    console.log('🌐 Public Access: fetching for', paSubId);
                    const response = await Promise.race([
                        fetch(`/api/public-access-exposure/${paSubId}`, { method: 'GET', headers }),
                        new Promise((_, reject) => setTimeout(() => reject(new Error('Timeout')), 30000))
                    ]);
                    
                    const data = await response.json();
                    console.log('🌐 Public Access response:', JSON.stringify(data));
                    const headerEl = document.getElementById('publicAccessCount');
                    if (headerEl && data.count !== null && data.count !== undefined) {
                        headerEl.textContent = data.count.toString();
                        // Color code based on exposure count
                        const parentStat = headerEl.closest('.header-stat');
                        if (parentStat) {
                            parentStat.classList.remove('success', 'warning');
                            if (data.count === 0) {
                                parentStat.classList.add('success');
                            } else if (data.count > 10) {
                                parentStat.classList.add('warning');
                            }
                        }
                    } else if (headerEl && isNaN(parseInt(headerEl.textContent))) {
                        headerEl.textContent = data.error ? 'Err' : '--';
                    }
                    
                    console.log(`🌐 Public Access loaded in ${Math.round(performance.now() - t0)}ms`);
                } catch (e) {
                    console.error('🌐 Public Access error:', e.message);
                    const headerEl = document.getElementById('publicAccessCount');
                    // Don't overwrite if updateInsightsForSubscription already set a valid number
                    if (headerEl && isNaN(parseInt(headerEl.textContent))) {
                        headerEl.textContent = 'N/A';
                    }
                }
            })());

            // Wait for all to complete (but they run in parallel)
            await Promise.allSettled(promises);
            
            const totalTime = Math.round(performance.now() - startTime);
            console.log(`📊 [DONE] All widgets loaded in ${totalTime}ms`);
            isLoadingWidgets = false;
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 90px;
                right: 20px;
                background: var(--primary);
                color: white;
                padding: 16px 24px;
                border-radius: 8px;
                box-shadow: var(--shadow-lg);
                z-index: 1000;
                animation: slideInRight 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Category Management
        function toggleCategory(categoryId) {
            const header = event.currentTarget;
            const prompts = document.getElementById(`category-${categoryId}`);
            
            header.classList.toggle('active');
            prompts.classList.toggle('active');
        }

        function showCategory(categoryId) {
            // Find the category section
            const categoryPrompts = document.querySelector(`#category-${categoryId}`);
            if (!categoryPrompts) return;
            
            const categoryHeader = categoryPrompts.previousElementSibling;
            const categorySection = categoryHeader.parentElement;
            
            // If category is not expanded, expand it
            if (!categoryHeader.classList.contains('active')) {
                categoryHeader.click();
            }
            
            // Scroll the sidebar to bring this category to the top
            const sidebar = document.querySelector('.sidebar');
            if (sidebar && categorySection) {
                const sidebarRect = sidebar.getBoundingClientRect();
                const sectionRect = categorySection.getBoundingClientRect();
                const scrollOffset = sectionRect.top - sidebarRect.top + sidebar.scrollTop - 20;
                
                sidebar.scrollTo({
                    top: scrollOffset,
                    behavior: 'smooth'
                });
            }
            
            // Also scroll the main page to ensure sidebar is visible
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
            
            // Remove welcome state
            const welcomeState = document.querySelector('.welcome-state');
            if (welcomeState) {
                welcomeState.remove();
            }
            
            // Highlight the category briefly
            categorySection.style.transition = 'background-color 0.3s ease';
            categorySection.style.backgroundColor = 'rgba(0, 120, 212, 0.1)';
            setTimeout(() => {
                categorySection.style.backgroundColor = '';
            }, 1500);
        }

        function quickPrompt(prompt) {
            const welcomeState = document.querySelector('.welcome-state');
            if (welcomeState) {
                welcomeState.remove();
            }
            
            document.getElementById('userInput').value = prompt;
            sendMessage();
        }

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            if (!message) return;

            const welcomeState = document.querySelector('.welcome-state');
            if (welcomeState) {
                welcomeState.remove();
            }

            addMessage(message, 'user');
            input.value = '';
            input.disabled = true;
            document.getElementById('sendBtn').disabled = true;
            document.getElementById('sendBtn').textContent = 'Thinking...';

            try {
                const userInfo = sessionStorage.getItem('userInfo');
                const user = userInfo ? JSON.parse(userInfo) : null;
                const accessToken = sessionStorage.getItem('accessToken');

                const headers = { 'Content-Type': 'application/json' };
                if (accessToken) {
                    headers['Authorization'] = `Bearer ${accessToken}`;
                }

                // Get current subscription context
                const subscriptionSelect = document.getElementById('subscriptionSelect');
                const selectedSubscription = subscriptionSelect.value;
                const subscriptionName = subscriptionSelect.options[subscriptionSelect.selectedIndex].text;
                
                // Check if user is asking for all subscriptions in their prompt
                const askingForAll = message.toLowerCase().includes('all subscription') || 
                                    message.toLowerCase().includes('across all') ||
                                    message.toLowerCase().includes('every subscription');
                
                // Determine if we're querying all subscriptions
                const isAllSubscriptions = selectedSubscription === 'all' || askingForAll;
                
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify({
                        message: message,
                        conversation_history: conversationHistory,
                        user_email: user?.email,
                        user_name: user?.name,
                        subscription_context: isAllSubscriptions ? 'all' : selectedSubscription,
                        subscription_name: isAllSubscriptions ? 'All Subscriptions' : subscriptionName,
                        all_subscriptions: isAllSubscriptions
                    })
                });

                const data = await response.json();
                addMessage(data.response, 'assistant');
                conversationHistory = data.conversation_history || [];

            } catch (error) {
                console.error('Error:', error);
                addMessage('Sorry, I encountered an error. Please try again.', 'assistant');
            } finally {
                input.disabled = false;
                document.getElementById('sendBtn').disabled = false;
                document.getElementById('sendBtn').textContent = 'Send ✈️';
                input.focus();
            }
        }

        function addMessage(text, role) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;

            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = role === 'user' ? document.getElementById('userAvatar').textContent : '🤖';

            const content = document.createElement('div');
            content.className = 'message-content';
            
            // Convert markdown to HTML with proper table rendering
            let formattedText = text;
            
            // Process [DIAGRAM:id:TITLE:title] tags - render architecture diagram images
            formattedText = formattedText.replace(/\[DIAGRAM:([a-zA-Z0-9-]+):TITLE:([^\]]+)\]/g, function(match, diagramId, diagramTitle) {
                return `<div class="diagram-container" style="margin: 16px 0; padding: 12px; background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 12px;">
                    <div style="overflow-x: auto; overflow-y: hidden; background: white; border-radius: 8px; padding: 8px; border: 1px solid #e8e8e8; max-height: 600px;">
                        <img src="/api/diagram/${diagramId}" alt="${diagramTitle}" style="display: block; max-width: none; min-width: 100%; height: auto; max-height: 580px; object-fit: contain; border-radius: 4px;" onerror="this.parentElement.innerHTML='<div style=\\'padding:40px;color:#888;\\'>Diagram image could not be loaded. Try regenerating.</div>'" />
                    </div>
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 8px; padding: 4px 0;">
                        <div style="display: flex; align-items: center; gap: 8px; min-width: 0; flex: 1;">
                            <span style="font-size: 16px; flex-shrink: 0;">🏗️</span>
                            <strong style="font-size: 13px; color: #1a1a2e; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${diagramTitle}</strong>
                        </div>
                        <div style="display: flex; gap: 6px; align-items: center; flex-shrink: 0; margin-left: 12px;">
                            <button onclick="window.open('/api/diagram/${diagramId}', '_blank')" style="padding: 5px 12px; background: #0078d4; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 600; display: flex; align-items: center; gap: 4px; white-space: nowrap;" onmouseover="this.style.background='#106ebe'" onmouseout="this.style.background='#0078d4'">
                                🔍 Full Size
                            </button>
                            <div style="position: relative; display: inline-block;" class="diagram-export-dropdown">
                                <button onclick="this.parentElement.querySelector('.export-menu').classList.toggle('show')" style="padding: 5px 12px; background: #107c10; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 600; display: flex; align-items: center; gap: 4px; white-space: nowrap;" onmouseover="this.style.background='#0b6a0b'" onmouseout="this.style.background='#107c10'">
                                    ⬇️ Export ▾
                                </button>
                                <div class="export-menu" style="display:none; position:absolute; bottom:100%; right:0; margin-bottom:4px; background:white; border:1px solid #e0e0e0; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.15); z-index:100; min-width:140px; overflow:hidden;">
                                    <div onclick="downloadDiagram('${diagramId}', '${diagramTitle.replace(/'/g, "\\'")}', 'png'); this.closest('.export-menu').classList.remove('show');" style="padding:8px 14px; cursor:pointer; font-size:12px; display:flex; align-items:center; gap:6px; color:#333;" onmouseover="this.style.background='#f0f0f0'" onmouseout="this.style.background='white'">
                                        🖼️ PNG (High Quality)
                                    </div>
                                    <div onclick="downloadDiagram('${diagramId}', '${diagramTitle.replace(/'/g, "\\'")}', 'jpeg'); this.closest('.export-menu').classList.remove('show');" style="padding:8px 14px; cursor:pointer; font-size:12px; display:flex; align-items:center; gap:6px; color:#333; border-top:1px solid #f0f0f0;" onmouseover="this.style.background='#f0f0f0'" onmouseout="this.style.background='white'">
                                        📷 JPEG (Compressed)
                                    </div>
                                    <div onclick="downloadDiagram('${diagramId}', '${diagramTitle.replace(/'/g, "\\'")}', 'svg'); this.closest('.export-menu').classList.remove('show');" style="padding:8px 14px; cursor:pointer; font-size:12px; display:flex; align-items:center; gap:6px; color:#333; border-top:1px solid #f0f0f0;" onmouseover="this.style.background='#f0f0f0'" onmouseout="this.style.background='white'">
                                        📐 SVG (Scalable)
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            });
            
            // Convert markdown tables to HTML tables
            formattedText = convertMarkdownTablesToHTML(formattedText);
            
            // Convert bold markdown
            formattedText = formattedText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            
            // Convert line breaks (only if not already in HTML table)
            if (!formattedText.includes('<table>')) {
                formattedText = formattedText.replace(/\n/g, '<br>');
            }
            
            content.innerHTML = formattedText;

            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function convertMarkdownTablesToHTML(text) {
            const lines = text.split('\n');
            let inTable = false;
            let tableHTML = '';
            let result = '';
            let headers = [];
            let tableData = []; // Store table data for CSV export
            let tableId = 'table_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            
            // Look for export tag in the text: [EXPORT:query_id:ROWS:total_rows]
            let exportInfo = null;
            const exportMatch = text.match(/\[EXPORT:([a-zA-Z0-9-]+):ROWS:(\d+)\]/);
            if (exportMatch) {
                exportInfo = {
                    queryId: exportMatch[1],
                    totalRows: parseInt(exportMatch[2])
                };
                console.log('Found export info:', exportInfo);
            }
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                // Skip the export tag line
                if (line.match(/\[EXPORT:[a-zA-Z0-9-]+:ROWS:\d+\]/)) {
                    continue;
                }
                
                // Check if line is a table row
                if (line.startsWith('|') && line.endsWith('|')) {
                    // Skip separator lines (containing ---)
                    if (line.includes('---')) {
                        continue;
                    }
                    
                    const cells = line.split('|').filter(cell => cell.trim()).map(cell => cell.trim());
                    
                    if (!inTable) {
                        // Start new table
                        inTable = true;
                        headers = cells;
                        tableData = [headers]; // Initialize with headers
                        tableHTML = '<div class="table-wrapper"><table data-table-id="' + tableId + '"><thead><tr>';
                        cells.forEach(cell => {
                            tableHTML += `<th>${cell}</th>`;
                        });
                        tableHTML += '</tr></thead><tbody>';
                    } else {
                        // Add data row
                        tableData.push(cells); // Store raw data for CSV
                        tableHTML += '<tr>';
                        cells.forEach((cell, index) => {
                            // Highlight certain values
                            let cellContent = cell;
                            
                            // Check for cost/savings values
                            if (cell.match(/\$[\d,]+/) || cell.includes('USD')) {
                                cellContent = `<span class="cost-highlight">${cell}</span>`;
                            }
                            // Check for percentages
                            else if (cell.match(/\d+(\.\d+)?%/)) {
                                const percentage = parseFloat(cell);
                                if (percentage < 0) {
                                    cellContent = `<span class="savings-highlight">${cell}</span>`;
                                } else if (percentage > 80) {
                                    cellContent = `<span class="danger-highlight">${cell}</span>`;
                                }
                            }
                            // Check for status words
                            else if (cell.toLowerCase().includes('critical') || cell.toLowerCase().includes('high') || cell.toLowerCase().includes('danger')) {
                                cellContent = `<span class="danger-highlight">${cell}</span>`;
                            }
                            else if (cell.toLowerCase().includes('success') || cell.toLowerCase().includes('healthy') || cell.toLowerCase().includes('operational') || cell.toLowerCase().includes('compliant')) {
                                cellContent = `<span class="savings-highlight">${cell}</span>`;
                            }
                            else if (cell.toLowerCase().includes('warning') || cell.toLowerCase().includes('medium')) {
                                cellContent = `<span class="cost-highlight">${cell}</span>`;
                            }
                            
                            tableHTML += `<td>${cellContent}</td>`;
                        });
                        tableHTML += '</tr>';
                    }
                } else {
                    // Not a table line
                    if (inTable) {
                        // Close the table and add export button(s)
                        const rowCount = tableData.length - 1; // Exclude header row
                        tableHTML += '</tbody></table>';
                        tableHTML += '<div class="table-actions">';
                        
                        // Show row count with total if more data available
                        if (exportInfo && exportInfo.totalRows > rowCount) {
                            tableHTML += `<span class="row-count-badge">Showing ${rowCount} of ${exportInfo.totalRows} rows</span>`;
                        } else {
                            tableHTML += `<span class="row-count-badge">${rowCount} row${rowCount !== 1 ? 's' : ''}</span>`;
                        }
                        
                        // Display export button for visible data
                        tableHTML += `<button class="export-csv-btn" onclick='exportTableToCSV(${JSON.stringify(tableData)}, "azure_export")'>`;
                        tableHTML += '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>';
                        tableHTML += 'Export Visible';
                        tableHTML += '</button>';
                        
                        // Add "Download Full Report" button if more data available
                        if (exportInfo && exportInfo.totalRows > rowCount) {
                            tableHTML += `<button class="export-csv-btn full-export-btn" onclick='downloadFullReport("${exportInfo.queryId}", ${exportInfo.totalRows}, "azure_full_export")'>`;
                            tableHTML += '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>';
                            tableHTML += `Download All (${exportInfo.totalRows})`;
                            tableHTML += '</button>';
                        }
                        
                        tableHTML += '</div></div>';
                        result += tableHTML + '\n';
                        tableHTML = '';
                        inTable = false;
                        headers = [];
                        tableData = [];
                        tableId = 'table_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    }
                    
                    // Add regular line
                    if (line) {
                        result += line + '\n';
                    }
                }
            }
            
            // Close table if still open
            if (inTable) {
                const rowCount = tableData.length - 1;
                tableHTML += '</tbody></table>';
                tableHTML += '<div class="table-actions">';
                
                // Show row count with total if more data available
                if (exportInfo && exportInfo.totalRows > rowCount) {
                    tableHTML += `<span class="row-count-badge">Showing ${rowCount} of ${exportInfo.totalRows} rows</span>`;
                } else {
                    tableHTML += `<span class="row-count-badge">${rowCount} row${rowCount !== 1 ? 's' : ''}</span>`;
                }
                
                tableHTML += `<button class="export-csv-btn" onclick='exportTableToCSV(${JSON.stringify(tableData)}, "azure_export")'>`;
                tableHTML += '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>';
                tableHTML += 'Export Visible';
                tableHTML += '</button>';
                
                // Add "Download Full Report" button if more data available
                if (exportInfo && exportInfo.totalRows > rowCount) {
                    tableHTML += `<button class="export-csv-btn full-export-btn" onclick='downloadFullReport("${exportInfo.queryId}", ${exportInfo.totalRows}, "azure_full_export")'>`;
                    tableHTML += '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>';
                    tableHTML += `Download All (${exportInfo.totalRows})`;
                    tableHTML += '</button>';
                }
                
                tableHTML += '</div></div>';
                result += tableHTML;
            }
            
            return result;
        }

        // CSV Export Function (for displayed table data)
        function exportTableToCSV(tableData, filename) {
            if (!tableData || tableData.length === 0) {
                showNotification('No data to export');
                return;
            }
            
            // Generate timestamp for filename
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, 19);
            const fullFilename = `${filename}_${timestamp}.csv`;
            
            // Convert to CSV format
            const csvContent = tableData.map(row => {
                return row.map(cell => {
                    // Escape quotes and wrap in quotes if contains comma, quote, or newline
                    const cellStr = String(cell || '');
                    if (cellStr.includes(',') || cellStr.includes('"') || cellStr.includes('\n')) {
                        return '"' + cellStr.replace(/"/g, '""') + '"';
                    }
                    return cellStr;
                }).join(',');
            }).join('\n');
            
            // Add BOM for Excel UTF-8 compatibility
            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
            
            // Create download link
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', fullFilename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showNotification(`Exported ${tableData.length - 1} rows to ${fullFilename}`);
        }

        // Full Report Export Function (calls backend API for ALL data)
        async function downloadFullReport(queryId, totalRows, queryType) {
            try {
                showNotification(`Downloading full report (${totalRows} rows)...`);
                
                const response = await fetch(`/api/export-csv/${queryId}`);
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || 'Export failed');
                }
                
                // Get the blob from response
                const blob = await response.blob();
                
                // Get filename from header or generate one
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = `${queryType}_full_export.csv`;
                if (contentDisposition) {
                    const match = contentDisposition.match(/filename="(.+)"/);
                    if (match) filename = match[1];
                }
                
                // Create download link
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                showNotification(`Downloaded full report: ${totalRows} rows`);
            } catch (error) {
                console.error('Export error:', error);
                showNotification(`Export failed: ${error.message}`, 'error');
            }
        }

        async function downloadDiagram(diagramId, title, format = 'png') {
            try {
                const formatLabels = { png: 'PNG', jpeg: 'JPEG', svg: 'SVG' };
                showNotification(`Downloading diagram as ${formatLabels[format] || format.toUpperCase()}...`);

                const response = await fetch(`/api/diagram-download/${diagramId}?format=${format}`);
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || 'Download failed');
                }

                const blob = await response.blob();
                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = `azure_diagram_${diagramId}.${format}`;
                if (contentDisposition) {
                    const match = contentDisposition.match(/filename="(.+)"/);
                    if (match) filename = match[1];
                }

                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                showNotification(`Downloaded diagram: ${title} (${formatLabels[format] || format.toUpperCase()})`);
            } catch (error) {
                console.error('Diagram download error:', error);
                showNotification(`Download failed: ${error.message}`, 'error');
            }
        }

        // Close export dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.diagram-export-dropdown')) {
                document.querySelectorAll('.export-menu.show').forEach(m => m.classList.remove('show'));
            }
        });

        // Event listeners
        document.getElementById('userInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Auto-resize textarea
        document.getElementById('userInput').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });

        // Helper function to add hierarchical options to select
        function addHierarchyOptions(parent, children, depth) {
            const indent = '  '.repeat(depth);
            children.forEach(child => {
                const option = document.createElement('option');
                if (child.type === 'managementGroup') {
                    option.value = `mg:${child.id}`;
                    option.textContent = `${indent}📁 ${child.name}`;
                    option.style.fontWeight = 'bold';
                } else {
                    option.value = child.id;
                    option.textContent = `${indent}🔑 ${child.name}`;
                }
                parent.appendChild(option);
                
                if (child.children && child.children.length > 0) {
                    addHierarchyOptions(parent, child.children, depth + 1);
                }
            });
        }

        // Load Azure Subscriptions with Management Group Hierarchy
        async function loadAzureSubscriptions() {
            try {
                const accessToken = sessionStorage.getItem('accessToken');
                const headers = { 'Content-Type': 'application/json' };
                if (accessToken) {
                    headers['Authorization'] = `Bearer ${accessToken}`;
                }

                const response = await fetch('/api/subscriptions-hierarchy', {
                    method: 'GET',
                    headers: headers
                });

                const select = document.getElementById('subscriptionSelect');
                
                if (response.ok) {
                    const data = await response.json();
                    const subscriptions = data.subscriptions || [];
                    const managementGroups = data.managementGroups || [];
                    
                    select.innerHTML = '<option value="all">All Subscriptions</option>';
                    
                    // Add Management Groups section if available
                    if (managementGroups && managementGroups.length > 0) {
                        const mgOptGroup = document.createElement('optgroup');
                        mgOptGroup.label = '📁 Management Groups';
                        
                        managementGroups.forEach(mg => {
                            const option = document.createElement('option');
                            option.value = `mg:${mg.id}`;
                            option.textContent = `📁 ${mg.name}`;
                            option.style.fontWeight = 'bold';
                            mgOptGroup.appendChild(option);
                            
                            if (mg.children && mg.children.length > 0) {
                                addHierarchyOptions(mgOptGroup, mg.children, 1);
                            }
                        });
                        
                        select.appendChild(mgOptGroup);
                    }
                    
                    // Add Subscriptions section
                    if (subscriptions && subscriptions.length > 0) {
                        const subOptGroup = document.createElement('optgroup');
                        subOptGroup.label = '🔑 Subscriptions';
                        
                        subscriptions.forEach((sub, index) => {
                            const option = document.createElement('option');
                            option.value = sub.id || sub.subscriptionId;
                            option.textContent = sub.displayName || sub.name;
                            if (managementGroups.length === 0 && index === 0) {
                                option.selected = true;
                            }
                            subOptGroup.appendChild(option);
                        });
                        
                        select.appendChild(subOptGroup);
                        sessionStorage.setItem('azureSubscriptions', JSON.stringify(subscriptions));
                        sessionStorage.setItem('azureManagementGroups', JSON.stringify(managementGroups));
                        
                        if (subscriptions.length > 0) {
                            const firstSubId = subscriptions[0].id || subscriptions[0].subscriptionId;
                            updateInsightsForSubscription(firstSubId);
                            loadSidebarLiveInsights(firstSubId);
                        }
                    } else if (managementGroups.length === 0) {
                        select.innerHTML = '<option value="none">No subscriptions available</option>';
                        loadSidebarLiveInsights('current');
                    }
                } else {
                    // Fallback to regular subscriptions endpoint
                    const fallbackResponse = await fetch('/api/subscriptions', { headers });
                    if (fallbackResponse.ok) {
                        const subscriptions = await fallbackResponse.json();
                        select.innerHTML = '<option value="all">All Subscriptions</option>';
                        subscriptions.forEach((sub, index) => {
                            const option = document.createElement('option');
                            option.value = sub.id || sub.subscriptionId;
                            option.textContent = sub.displayName || sub.name;
                            if (index === 0) option.selected = true;
                            select.appendChild(option);
                        });
                        if (subscriptions.length > 0) {
                            loadSidebarLiveInsights(subscriptions[0].id || subscriptions[0].subscriptionId);
                        }
                    } else {
                        select.innerHTML = '<option value="current">Current Subscription</option>';
                        loadSidebarLiveInsights('current');
                    }
                }
            } catch (error) {
                console.error('Error loading subscriptions:', error);
                const select = document.getElementById('subscriptionSelect');
                select.innerHTML = '<option value="current">Current Subscription</option>';
                loadSidebarLiveInsights('current');
            }
        }

        // Initialize
        // Check authentication on load
        function checkAuth() {
            const loginComplete = sessionStorage.getItem('loginComplete');
            const userInfo = sessionStorage.getItem('userInfo');
            
            if (!loginComplete || !userInfo) {
                console.log('❌ Not authenticated - redirecting to login');
                window.location.replace('/login.html');
                return false;
            }
            return true;
        }

        // Initialize
        window.addEventListener('load', () => {
            // Check authentication first
            if (!checkAuth()) return;
            
            loadUserProfile();
            loadAzureSubscriptions(); // This will call loadSidebarLiveInsights internally
            document.getElementById('userInput').focus();
        });
    </script>
</body>
</html>
